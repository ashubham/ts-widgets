{"version":3,"file":"chart.js","sources":["../../../app/.tmp/ts-out/src/modules/embrace/constants.js","../../../app/.tmp/ts-out/src/modules/sage-v2/sage-util/sage-util.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/client-state.js","../../../app/.tmp/ts-out/src/modules/document-model/document-model.js","../../../app/.tmp/ts-out/src/modules/viz-layout/answer/answer-metadata-util.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/visualization-model.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/corrupt-viz-model.js","../../../app/.tmp/ts-out/src/modules/document-model/answer-model/pinboard-answer-sheet-util.js","../../../app/.tmp/ts-out/src/modules/search-pages/base-answer.js","../../../app/.tmp/ts-out/src/modules/callosum/model/query-data.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/best-chart-axis-config-service.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/chart-axis-config-mapping-service.js","../../../app/.tmp/ts-out/src/base/blink-statistics-library.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/dx-table/dx-table-data-model.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/dx-table/dx-table-util.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/pivot/pivot-data-model.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/chart-data-processor-service.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/chart-persisted-store.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/default-chart-config-service.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/must-visualize-columns-axis-service.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/chart-model.js","../../../app/.tmp/ts-out/src/object-model/filter/attribute-filter-model.js","../../../app/.tmp/ts-out/src/services/utilities/bach-extensions.js","../../../app/.tmp/ts-out/src/object-model/filter/filter-model-util.js","../../../app/.tmp/ts-out/src/object-model/filter/date-filter-model.js","../../../app/.tmp/ts-out/src/object-model/filter/filter-condition.js","../../../app/.tmp/ts-out/src/object-model/filter/measure-filter-model.js","../../../app/.tmp/ts-out/src/bach-client/worksheet-extensions.js","../../../app/.tmp/ts-out/src/modules/worksheet/models/worksheet-column.js","../../../app/.tmp/ts-out/src/services/utilities/enum-translators.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/filter-types.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/filter-row.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/single-operator-filter-row.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/multi-operator-filter-row.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/filter-content.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/filter.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/filter-expression.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/filter-util.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/filter/filter-model-factory.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/rdata/viz-rdata-model.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/table-v2/simple-table-model.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/viz-cluster/viz-cluster-model.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/headline/headline-column-model.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/headline/headline-model.js","../../../app/.tmp/ts-out/src/modules/document-model/answer-model/answer-sheet-model.js","../../../app/.tmp/ts-out/src/modules/document-model/answer-model/answer-model.js","../../../app/.tmp/ts-out/src/base/angular-util.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/highcharts/highchart-axis-renderer.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/chart-ui-utils.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/highcharts/highcharts-label-processor-service.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/highcharts/blink-highchart.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/highcharts/blink-highchart-config.js","../../../app/.tmp/ts-out/src/modules/viz-layout/viz/chart/highcharts/highchart-chart-util.js","../../../app/.tmp/ts-out/src/embed/components/chart/chart-styles.js","../../../app/.tmp/ts-out/src/embed/components/chart/chart.js"],"sourcesContent":["/**\n * Copyright: ThoughtSpot Inc. 2016\n * Author: Rabi Shah (rabi.shah@thoughtspot.com)\n *\n * @fileoverview Constants specific to Embrace.\n *\n */\nimport { Provide } from '../../base/decorators';\nconst CONNECTOR_IMG_SRC_MAP = {\n    RDBMS_AZURE_SQL_DATAWAREHOUSE: '/resources/img/embrace/azure-sql-data-warehouse-ic@3x.png',\n    RDBMS_GCP_BIGQUERY: '/resources/img/embrace/gcp-big-query-ic@3x.png',\n    RDBMS_REDSHIFT: '/resources/img/embrace/aws-ic@3x.png',\n    RDBMS_SALESFORCE: '/resources/img/embrace/salesforce-ic@3x.png',\n    RDBMS_SNOWFLAKE: '/resources/img/embrace/snowflake-ic@3x.png',\n    RDBMS_SERVICE_NOW: '/resources/img/embrace/service-now-ic@3x.png',\n    RDBMS_SQLSERVER: '/resources/img/embrace/sql-server-ic@3x.png',\n    RDBMS_MARKETO: '/resources/img/embrace/marketo-ic@3x.png',\n    RDBMS_ORACLE: '/resources/img/embrace/oracle-ic@3x.png'\n};\nconst CONNECTOR_DISPLAY_NAME = {\n    RDBMS_AZURE_SQL_DATAWAREHOUSE: 'Azure Sql Data Warehouse',\n    RDBMS_GCP_BIGQUERY: 'GCP BigQuery',\n    RDBMS_REDSHIFT: 'Amazon Redshift',\n    RDBMS_SALESFORCE: 'Salesforce',\n    RDBMS_SNOWFLAKE: 'Snowflake',\n    RDBMS_SERVICE_NOW: 'Service Now',\n    RDBMS_SQLSERVER: 'SQL Server',\n    RDBMS_MARKETO: 'Marketo',\n    RDBMS_ORACLE: 'Oracle'\n};\nconst QUERYABLE_SOURCES = {\n    LOCAL: 'FALCON',\n    LIVE: 'LIVE',\n};\nconst EMBRACE_HISTORY = {\n    HISTORY_POLLING_TIME: 30 * 1000\n};\nconst EMBRACE_TABLE_LIST = {\n    POLLING_TIME: 10 * 1000\n};\nconst MAPPING = {\n    DATA_MAPPING_FILE_NAME: 'connection.yaml'\n};\nexport const embraceConstants = {\n    CONNECTOR_IMG_SRC_MAP,\n    CONNECTOR_DISPLAY_NAME,\n    QUERYABLE_SOURCES,\n    EMBRACE_HISTORY,\n    MAPPING,\n    EMBRACE_TABLE_LIST\n};\nProvide('embraceConstants')({\n    CONNECTOR_IMG_SRC_MAP,\n    CONNECTOR_DISPLAY_NAME,\n    QUERYABLE_SOURCES,\n    EMBRACE_HISTORY,\n    MAPPING,\n    EMBRACE_TABLE_LIST\n});\n//# sourceMappingURL=constants.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2013\n * Author: Stephane Kiss (stephane@thoughtspot.com),\n * Shikhar Agarwal (shikhar@thoughtspot.com)\n *\n * @fileoverview utility functions for sage business logic\n */\nimport * as Logger from '@thoughtspot/logger';\nimport _ from 'lodash';\nimport { ngRequire, Provide } from '../../../base/decorators';\nimport { flags } from '../../../base/flags';\nimport sage from '../../../base/proto/sage-namespace-translator';\nimport { getNewACTableRequest } from '../../auto-complete/auto-complete-object-util';\nlet util = ngRequire('util');\nlet JoinDisambiguationHelper = ngRequire('JoinDisambiguationHelper');\nlet fontMetricService = ngRequire('fontMetricService');\nlet sageDataScopeService = ngRequire('sageDataScopeService');\nlet _logger = Logger.create('sage-util');\nlet MAX_MORE_COMPLETIONS = 100;\n/**\n * @param {Array.<string>} words\n * @return {Array.<sage.RecognizedToken>}\n */\nfunction wordsToUnrecognizedTokens(words) {\n    return words.map((word) => {\n        return sage.RecognizedToken.createUnrecognizedToken(word);\n    });\n}\n/**\n * Trim out empty unrecognized tokens from the right. Modifies tokens array.\n *\n * @param {Array.<sage.RecognizedToken>} tokens\n */\nfunction removeTrailingUnrecognizedEmptyTokens(tokens) {\n    while (tokens.length > 0) {\n        let lastToken = tokens[tokens.length - 1];\n        if (lastToken.isUnrecognized() && !lastToken.getTokenText()) {\n            tokens.pop();\n        }\n        else {\n            break;\n        }\n    }\n    return tokens;\n}\n/**\n * Transform tokens by comparing the tokens with current input.\n * Suppose the tokens are [revenue, part name, container], all of them are recognized tokens.\n * Now imagine the user modified 'part name' to 'part ame'.\n * The resulting token array will look like\n * [revenue, _part_, _ame_, container] where _foo_ means an unrecognized token.\n *\n * @param {Array.<string>} untrimmedInputWords\n * @param {Array.<sage.RecognizedToken>} tokens\n * @return {Array.<sage.RecognizedToken>}\n */\nfunction getTokensFromWords(untrimmedInputWords, tokens) {\n    // Important: no trailing empty words or tokens\n    // The logic of this function will break if either the input\n    // word array has a trailing empty string, or\n    // the tokens array has a trailing empty unrecognized token. Keep track of whether the input had\n    // a trailing space, because then the final token list should\n    // contain an empty unrecognized token.\n    // Note(chab) we are going to ged rid of that in the new sage version\n    let inputWords = util.arrayTrimRight(untrimmedInputWords), wasTrimmed = (inputWords.length < untrimmedInputWords.length), _tokens = removeTrailingUnrecognizedEmptyTokens(tokens);\n    function getTokens(tokens) {\n        // if we have no tokens, all words are considered as unrecognized tokens\n        if (!tokens.length) {\n            return wordsToUnrecognizedTokens(inputWords);\n        }\n        // we want to create unrecognized tokens from the input, there can be 2 situations\n        // 1. User changed some tokens, so we need to find which tokens are now unrecognized\n        // 2. User Input is after all already present tokens\n        for (let i = 0; i < tokens.length; i++) {\n            let rt = tokens[i];\n            // switch to sge bar text\n            let rtTokensArr = parseSageBarText(rt.getTokenTextLowerCase(), null);\n            if (util.isPrefixArray(rtTokensArr, inputWords)) {\n                while (rtTokensArr.length) {\n                    rtTokensArr.shift();\n                    inputWords.shift();\n                }\n            }\n            else {\n                // first token mismatch. see if rest of the tokens\n                // are present in the rest of the array. if not, skip\n                // the next token and retry for the tokens after\n                // that. this way we can find which last set of tokens\n                // are still present in the input, aligned to the end.\n                let newUnrecognizedTokens;\n                for (let j = i; j < tokens.length; j++) {\n                    let lastFewTokens = tokens.slice(j), lastFewTokensAsWordsArray = tokensToWords(lastFewTokens);\n                    if (util.isPostfixArray(lastFewTokensAsWordsArray, inputWords)) {\n                        // seems like things changed between the i-th and j-th tokens.\n                        // It could be one of the following:\n                        //  1. just another char added/deleted to a token\n                        //  2. space added in the middle of a word making it two words.\n                        //  3. space removed between two words. This means two words joined.\n                        //  4. A larger set of char added or deleted\n                        //     through cut or  paste operations.\n                        //\n                        let end = lastFewTokensAsWordsArray.length;\n                        let numUnmatchedWords = inputWords.length - end, unmatchedWords = inputWords.slice(0, numUnmatchedWords);\n                        newUnrecognizedTokens = wordsToUnrecognizedTokens(unmatchedWords);\n                        // tokens i..j-1 should be replaced by unrecognized tokens\n                        // using the unmatched words\n                        return tokens.\n                            slice(0, i).\n                            concat(newUnrecognizedTokens).\n                            concat(lastFewTokens);\n                    }\n                }\n                // tokens j..end did not match anywhere in rest of input.\n                // so all the rest of input words will become\n                // unrecognized tokens\n                newUnrecognizedTokens = wordsToUnrecognizedTokens(inputWords);\n                return tokens.slice(0, i).concat(newUnrecognizedTokens);\n            }\n        }\n        // user typed after the tokens\n        return tokens.concat(wordsToUnrecognizedTokens(inputWords));\n    }\n    tokens = getTokens(_tokens);\n    if (wasTrimmed) {\n        tokens.push(sage.RecognizedToken.createUnrecognizedToken());\n    }\n    return tokens;\n}\nfunction getPixelWidthOfSageInputString(txt) {\n    let font = '14px Optimo-Plain,Helvetica Neue,Helvetica,Arial,sans-serif';\n    return fontMetricService.getTextWidth(txt, font);\n}\n/**\n * Recognized tokens have many fields, but if the three fields\n * compared here match then for all intents they can be\n * considered equivalent.\n * @param {sage.RecognizedToken} token1\n * @param {sage.RecognizedToken} token2\n * @returns {boolean}\n */\nfunction equalRecognizedTokens(token1, token2) {\n    if (token1.isUnrecognized()) {\n        if (token2.isUnrecognized()) {\n            return token1.getTokenTextLowerCase() === token2.getTokenTextLowerCase();\n        }\n        else {\n            return false;\n        }\n    }\n    return token1.getTokenTextLowerCase() === token2.getTokenTextLowerCase() &&\n        token1.getTypeEnum() === token2.getTypeEnum() && token1.guid === token2.guid;\n}\n/**\n * Given an input string, break it into words by looking for space('') or\n * operators (=, <, >, <=, >=, !=). If we find an operator anywhere\n * even if we don't have space separating them\n * we want them to become separate words. The return object gives us all the words.\n * If the caret is not overlapping with any token then,\n * we create an empty token at the caret so that server knows\n * that we are trying to generate a completion for that spot.\n * @param {string} inputString\n * @param {number=} caretPosition\n * @returns {Array}\n */\nfunction parseSageBarText(inputString, caretPosition) {\n    caretPosition = caretPosition === null ? inputString.length : caretPosition;\n    let result = [], wordStart = 0;\n    for (let i = 0, l = inputString.length; i < l; ++i) {\n        if (inputString[i] === ' ' || inputString[i] === String.fromCharCode(160)) {\n            if (wordStart < i\n                || (wordStart === i && (i === caretPosition || i === caretPosition - 1))) {\n                result.push(inputString.slice(wordStart, i));\n            }\n            wordStart = i + 1;\n        }\n    }\n    if (wordStart < inputString.length) {\n        result.push(inputString.slice(wordStart));\n    }\n    // If we have trailing space and cursor is at the end, or the string is empty,\n    // we add a trailing empty word.\n    if (result.length === 0 ||\n        (inputString[inputString.length - 1] === ' '\n            && caretPosition === inputString.length)) {\n        result.push('');\n    }\n    return result;\n}\n/**\n * Find the contiguous suffix recognized tokens and its corresponding string.\n * The suffix is calculated till we reach\n * the caret position, an unrecognized token or extensible token which has\n * caret within it or at the boundary (See\n * assumptions).\n * Spaces in the input string are included only when they are between\n * 2 recognized tokens (NOT empty or unrecognized), both of which should be after the caret.\n * Here is the behaviour: 1. quantity__ab|c__revenue or qua|ntity__revenue.\n * This would return [revenue] and revenue\n * (and not __revenue).\n *\n * Assumption:\n * 1. Input tokens should not have any empty token\n * 2. For extensible tokens - Unlike while calculating prefix tokens,\n *    we do not have to see the character before the\n * the extensible token. For eg, revenue > 10 and we paste/type something\n * before 10, caret would always be at the end\n * of this new substring: revenue > abc|10. Because we don't include extensible\n * tokens even if caret is at the boundary,\n * we are fine.\n *\n * TODO (Shikhar) - make this function pvt and update the unit test\n * to use the public method partitionInput...\n *\n * Note: In future, if we want to bring notion of empty token again, you can check this:\n * http://mothership:8080/#/c/9238/2 (patch set 2)\n * It also has unit tests for the same.\n *\n * @param inputStrLwrCase - input string in lower case\n * @param tokens\n * @param caretPosition\n * @returns {{suffixTokens: Array, suffixLen: number}}\n */\nfunction getSuffixRecognizedTokensInfo(inputStrLwrCase, tokens, caretPosition, isCaretBetweenTokens = false) {\n    let currentEndPos = inputStrLwrCase.length - 1, suffixObj = {\n        suffixTokens: [],\n        suffixLen: 0,\n        suffixStartIndex: inputStrLwrCase.length - 1\n    };\n    if (currentEndPos < 0 || !tokens.length || caretPosition >= inputStrLwrCase.length) {\n        return suffixObj;\n    }\n    for (let i = tokens.length - 1; i >= 0; i--) {\n        let token = tokens[i];\n        if (token.isUnrecognized()) {\n            if (token.isEmpty()) {\n                _logger.warn('Empty token found while calculating suffix tokens');\n                _logger.debug('Empty token found while calculating suffix tokens', inputStrLwrCase, tokens, caretPosition);\n            }\n            return suffixObj;\n        }\n        // Remove white spaces at the end of each token\n        let k = currentEndPos;\n        for (; k >= 0 && inputStrLwrCase[k] === ' '; k--) {\n            if (k === caretPosition) {\n                return suffixObj;\n            }\n        }\n        currentEndPos = k;\n        if (currentEndPos < 0) {\n            return suffixObj;\n        }\n        // For this token move currentEndPos until we get a character\n        // not matching the current token character.\n        let tokenStr = token.getTokenTextLowerCase();\n        for (let j = tokenStr.length - 1; j >= 0; j--, currentEndPos--) {\n            if (inputStrLwrCase[currentEndPos] !== tokenStr[j]\n                || currentEndPos - caretPosition < 0) {\n                return suffixObj;\n            }\n        }\n        // In case there is a character right at the start of suffix\n        // For e.g rev|color . Here `color` is recognized and rev is added.\n        // to the start of `color`. With the exception of tokens for which\n        // has_space_after: false (like <,> etc)\n        let previousTokenHasSpaceAfter = tokens[i - 1]\n            && !tokens[i - 1].isUnrecognized()\n            && tokens[i - 1].getHasSpaceAfter();\n        if (currentEndPos >= 0\n            && previousTokenHasSpaceAfter\n            && inputStrLwrCase[currentEndPos] !== ' ') {\n            return suffixObj;\n        }\n        // If caret is at the start of the token, it is not included.\n        if (!isCaretBetweenTokens && currentEndPos + 1 === caretPosition) {\n            return suffixObj;\n        }\n        suffixObj.suffixTokens.unshift(token);\n        suffixObj.suffixLen = (previousTokenHasSpaceAfter)\n            ? inputStrLwrCase.length - currentEndPos\n            : inputStrLwrCase.length - currentEndPos - 1;\n        suffixObj.suffixStartIndex = currentEndPos + 1;\n    }\n    return suffixObj;\n}\n/**\n * Dual of getSuffixRecognizedTokensInfo. Finds the contiguous prefix\n * recognized tokens and its corresponding string.\n * The prefix is calculated till we reach the caret position,\n * unrecognized token or extensible token if it has\n * non-space character immediately after it (See Note)\n * Spaces in the input string are included only when they are\n * between 2 recognized tokens (NOT empty or unrecognized),\n * both of which should be before the caret.\n * Here is the behaviour: 1. quantity__ab|c__revenue or quantity__re|venue.\n * This would return [quantity] and quantity\n * (and not quantity__).\n *\n * Assumption: Input tokens should not have any empty token\n *\n * Note: Special treatment of extensible token:\n * Suppose user types revenue > 1, 1 is recognized.\n * Now he adds 0: revenue > 10|. We detect 1 is extensible and see\n * the next char. If it is non-space, we don't include 1 in the prefix tokens.\n * We do not check caret for this case.\n * So 'revenue > 1| ' would include \"1\" as prefix as it has space after it.\n *\n * TODO (Shikhar) - make this function pvt and update the unit test to use\n * the public method partitionInput...\n *\n * @param inputStrLwrCase - input string in lower case\n * @param tokens\n * @param caretPosition\n * @param isCaretBetweenTokens\n * @returns {{prefixTokens: Array, prefixLen: number}}\n */\nfunction getPrefixRecognizedTokensInfo(inputStrLwrCase, tokens, caretPosition, isCaretBetweenTokens = false) {\n    let currentStartPos = 0, prefixObj = {\n        prefixTokens: [],\n        prefixLen: 0\n    }, effectiveInputLength = inputStrLwrCase.length;\n    if (effectiveInputLength <= 0 || !tokens.length || caretPosition <= 0) {\n        return prefixObj;\n    }\n    for (let i = 0; i < tokens.length; i++) {\n        let token = tokens[i];\n        if (token.isUnrecognized()) {\n            if (token.isEmpty()) {\n                _logger.warn('Empty token found while calculating prefix tokens');\n                _logger.debug('Empty token found while calculating prefix tokens', inputStrLwrCase, tokens, caretPosition);\n            }\n            return prefixObj;\n        }\n        // remove spaces before each token in the input string\n        let k = currentStartPos;\n        for (; k < effectiveInputLength && inputStrLwrCase[k] === ' '; k++) {\n            // >= coz this case: caretPos = 0\n            if (k >= caretPosition - 1) {\n                return prefixObj;\n            }\n        }\n        currentStartPos = k;\n        if (currentStartPos >= effectiveInputLength) {\n            return prefixObj;\n        }\n        let tokenStr = token.getTokenTextLowerCase();\n        for (let j = 0; j < tokenStr.length; j++, currentStartPos++) {\n            if (inputStrLwrCase[currentStartPos] !== tokenStr[j]\n                || currentStartPos >= caretPosition) {\n                return prefixObj;\n            }\n        }\n        if (currentStartPos > effectiveInputLength) {\n            _logger.error('current start position great than length');\n            return prefixObj;\n        }\n        // In case there is a non-space character right at the end of prefix\n        // For e.g revenuecol| region . Here `revenue` is recognized and `col` is added.\n        // to the end of `revenue`. `region` is recognized too.\n        let isNextTokenRecognized = tokens[i + 1] && !tokens[i + 1].isUnrecognized();\n        let areTokensTogether = isNextTokenRecognized && !token.getHasSpaceAfter();\n        if (!_.isUndefined(inputStrLwrCase[currentStartPos])\n            && !areTokensTogether\n            && inputStrLwrCase[currentStartPos] !== ' ') {\n            return prefixObj;\n        }\n        //Caret is at the start of a token, do not include that token.\n        if (!isCaretBetweenTokens && (currentStartPos === caretPosition)) {\n            return prefixObj;\n        }\n        prefixObj.prefixTokens.push(token);\n        prefixObj.prefixLen = (token.getHasSpaceAfter())\n            ? currentStartPos + 1\n            : currentStartPos;\n    }\n    return prefixObj;\n}\n/**\n * For the given caret position, partitions the inout tokens and\n * strings into contiguous recognized tokens before\n * caret, after caret, mid-unresolved tokens and mid0unresolved string\n * @param inputStrLwrCase\n * @param tokens\n * @param caretPosition\n * @param isCaretInBetweenTokens\n * @returns {{tokensBeforeCaret: *, tokensAfterCaret: *,\n *      unresolvedTokens: (*|Array|string|Blob|UTILS.slice|slice),\n     *  unresolvedStringStartIndex: number, unresolvedStringLength: number}}\n */\nfunction partitionInputBasedOnCaret(inputStrLwrCase, tokens, caretPosition, isCaretInBetweenTokens) {\n    let suffixObj = getSuffixRecognizedTokensInfo(inputStrLwrCase, tokens, caretPosition, isCaretInBetweenTokens);\n    let prefixObj = getPrefixRecognizedTokensInfo(inputStrLwrCase, tokens, caretPosition, isCaretInBetweenTokens);\n    let recognizedPrefixLen = prefixObj.prefixLen;\n    let recognizedSuffixLen = suffixObj.suffixLen;\n    return {\n        tokensBeforeCaret: prefixObj.prefixTokens,\n        tokensAfterCaret: suffixObj.suffixTokens,\n        unresolvedTokens: tokens.slice(prefixObj.prefixTokens.length, tokens.length - suffixObj.suffixTokens.length),\n        unresolvedStringStartIndex: recognizedPrefixLen,\n        unresolvedStringLength: inputStrLwrCase.length - (recognizedSuffixLen + recognizedPrefixLen)\n    };\n}\n/**\n * Traverses the input string character wise and gives starting position to each token.\n *\n * Note - this function is called for the tokens in response - not useful to call it\n * during the request.\n *\n * Assumption: Empty token can only come if it is the one being edited\n *\n * @param inputStr\n * @param tokens\n * @param caretPosition\n */\nfunction setTokensPosition(inputStr, tokens, caretPosition) {\n    if (!tokens.length) {\n        return;\n    }\n    let origStrLength = inputStr.length, tokenIndex = 0;\n    for (let i = 0; i < origStrLength && tokenIndex < tokens.length;) {\n        if (tokens[tokenIndex].isEmpty()) {\n            tokens[tokenIndex].startPosition = i;\n            tokenIndex++;\n        }\n        // Note: Make sure to first check for emptyToken (tokens[tokenIndex].isEmpty())\n        // and then empty char\n        if (inputStr[i] === ' ') {\n            i++;\n            continue;\n        }\n        tokens[tokenIndex].startPosition = i;\n        i += tokens[tokenIndex].getTokenTextLowerCase().length;\n        tokenIndex++;\n    }\n    // It might happen that string has completed, but there is still token left.\n    // This should only happen if the last\n    // token is empty. Consider: \"revenue\" and [revenue, empty]\n    if (tokenIndex < tokens.length) {\n        if (!tokens[tokenIndex].isEmpty()) {\n            _logger.debug('While calculating starting position, string finished but tokens left', inputStr, tokens, caretPosition);\n            _logger.warn('While calculating starting position, string finished but tokens left', inputStr);\n            return;\n        }\n        tokens[tokenIndex].startPosition = origStrLength;\n    }\n}\n/**\n * Return a word array given a token array. One token can have multiple words.\n * @param {Array.<sage.RecognizedToken} tokens\n */\nfunction tokensToWords(tokens) {\n    return tokens.map(function (t) {\n        return t.getTokenTextLowerCase().split(' ');\n    })\n        .reduce(function (p, c) {\n        return p.concat(c);\n    }, []);\n}\n/**\n *\n * @param {sage.ACTableResponse} tableResponse\n */\nfunction preProcessQueryCompletions(tableResponse) {\n    let queryCompletions = tableResponse.getQueryCompletions();\n    if (!queryCompletions || !queryCompletions.length) {\n        _logger.debug('No query completions found in the sage response', tableResponse);\n        return;\n    }\n    if (queryCompletions.length <= flags.getValue(flags.BLINK_FLAGS.maxNumCompletionsInSage.name)) {\n        _logger.info('All completions can fit, no folding is needed', queryCompletions.length);\n        return;\n    }\n    // Per SCAL-6472, if there are any duplicate suggestions from sage that are not as a\n    // result of an exact match\n    // we should fold them into one suggestion with a \"(4 matches)\" help text.\n    // However, when user selects one of those options, we will show all the matching suggestions.\n    // Build a map of (unique suggestion string -> array of completions)\n    let suggestionStringPresenceMap = {};\n    let foundFoldCandidate = false;\n    queryCompletions.forEach((completion) => {\n        // Folding is supported for only single token suggestions\n        // that are neither exact matches nor from history.\n        if (completion.getCompletionTokens().length === 1 &&\n            !completion.isSearchHistoryCompletion() &&\n            !completion.isExactMatch()) {\n            let suggestionString = completion.getCompletionTokensNormalizedQueryString()\n                .toLowerCase();\n            if (!suggestionStringPresenceMap.hasOwnProperty(suggestionString)) {\n                suggestionStringPresenceMap[suggestionString] = [];\n            }\n            suggestionStringPresenceMap[suggestionString].push(completion);\n            if (suggestionStringPresenceMap[suggestionString].length > 3) {\n                foundFoldCandidate = true;\n            }\n        }\n    });\n    if (!foundFoldCandidate) {\n        return;\n    }\n    // If all results have the same suggestion string, do not fold them into a single result\n    if (_.size(suggestionStringPresenceMap) === 1\n        && _.values(suggestionStringPresenceMap)[0].length\n            === queryCompletions.length) {\n        return;\n    }\n    // Iterate through each group of similar suggestions and fold if there are enough in the group\n    _.values(suggestionStringPresenceMap).forEach((similarCompletions) => {\n        let numDuplicates = similarCompletions.length;\n        if (numDuplicates <= 3) {\n            return;\n        }\n        let firstCompletion = similarCompletions.shift();\n        let indexOfFirstCompletion = queryCompletions.indexOf(firstCompletion);\n        // We do not want to modify the original object, so create a deep copy instead\n        let firstCompletionCopy = _.cloneDeep(firstCompletion);\n        // Create a folded completion with this group of similar completions\n        let originalToken = firstCompletionCopy.getCompletionTokens()[0];\n        let replacementToken = sage.RecognizedToken.createUnrecognizedToken(originalToken.token);\n        firstCompletionCopy.getCompletionTokens()[0] = replacementToken;\n        let foldedCompletion = new sage.FoldedQueryCompletion(firstCompletionCopy);\n        foldedCompletion.setNumDuplicates(numDuplicates);\n        // Replace the first in the group with our new folded completion, and remove the others\n        // from the list of completions (this means the folded completion is placed at the index\n        // of the first completion in the group of similar completions)\n        _.pull(queryCompletions, ...similarCompletions);\n        queryCompletions[indexOfFirstCompletion] = foldedCompletion;\n    });\n}\n/**\n * Sets up the scope for join disambiguation.\n * Also returns the sage dropdown item config needed to show\n * the \"mapping\" button and label.\n *\n * @param {sage.ACTableResponse} tableResponse\n * @param {function} joinCompleteCallback\n */\nfunction setupSageForJoinDisambiguation(tableResponse, joinCompleteCallback) {\n    if (!doesSageNeedJoinDisambiguation(tableResponse)) {\n        return;\n    }\n    let _joinDisambiguationHelper = new JoinDisambiguationHelper({\n        joinPathCollections: tableResponse.getJoinPathAmbiguities(),\n        tokens: tableResponse.getNewTokens()\n    }, JoinDisambiguationHelper.modes.EMBEDDED_IN_SAGE, joinCompleteCallback);\n    _joinDisambiguationHelper.init();\n    return _joinDisambiguationHelper;\n}\n/**\n * @param {Array.<sage.RecognizedToken>} tokens\n * @return {String}\n */\nfunction tokensToQuery(tokens) {\n    return tokens.map(function (token) {\n        return token.getTokenTextLowerCase();\n    }).join(' ');\n}\n/**\n * @param {Array.<sage.RecognizedToken>} tokens\n * @returns {Array.<sage.RecognizedToken>} tokens\n */\nfunction getPrefixRecognizedTokens(tokens) {\n    let firstUnrecognizedTokenIndex = tokens.findIndex(function (token) {\n        return token.isUnrecognized();\n    });\n    if (firstUnrecognizedTokenIndex === -1) {\n        firstUnrecognizedTokenIndex = tokens.length;\n    }\n    return tokens.slice(0, firstUnrecognizedTokenIndex);\n}\n/**\n * Returns true if the sage response contains any join ambiguities.\n *\n * @param {sage.ACTableResponse} tableResponse\n * @returns {boolean}\n */\nfunction doesSageNeedJoinDisambiguation(tableResponse) {\n    return tableResponse.getJoinPathAmbiguities()\n        && tableResponse.getJoinPathAmbiguities().length > 0;\n}\n/**\n * Gets the table hash key in context for table at given index.\n * @param sageContext {sage.ACContext}\n * @param index {number}\n * @returns {string}\n */\nfunction getHashKey(sageContext, index) {\n    if (!sageContext) {\n        return null;\n    }\n    let tables = sageContext.getTables();\n    let currentTable = tables[index];\n    return currentTable.getHashKey();\n}\n/**\n * The sage model's accessible tables give us all tables that has join paths from\n * the current query in the worksheet/answer. There is another set of tables which\n * is the selected tables from the left panel. The effective data scope is the\n * intersection of the 2.\n *\n * @param sageModel\n */\nfunction getEffectiveDataScope(sageModel) {\n    let dataScope = sageDataScopeService.getSources().slice(0);\n    if (!!sageModel && !!sageModel.getAccessibleTables()) {\n        let accessibleTables = sageModel.getAccessibleTables();\n        dataScope = dataScope.intersect(accessibleTables);\n    }\n    return dataScope;\n}\nfunction getViewMoreRequest(sageModel) {\n    let tableRequest = getNewACTableRequest();\n    tableRequest.setInputTokens(sageModel.tokens);\n    // SCAL-18922 4.2.1 Sage auto-complete crash loop.\n    //\n    // When getting more completions blink was sending token under caret\n    // as currently edited token which could be incorrect.\n    // It is possible that the user is typing at end of text but with\n    // some unrecognized tokens in the middle etc.\n    // When getting more completions for any postions using the\n    // completionStartPosition is an accurate value.\n    // We can assume blink works with 2 operating indexes\n    // 1. based on the user cursor(token under caret etc)\n    // 2. based on where sage suggest user to fix things.(competionPosition)\n    tableRequest.setCurrentlyEditedToken(sageModel.completionStartPosition);\n    tableRequest.setCursorOffsetInToken(sageModel.caretPositionFromTokenStart);\n    tableRequest.setExactMatchOnly(sageModel.showingExactMatches);\n    tableRequest.setMaxCompletions(MAX_MORE_COMPLETIONS);\n    tableRequest.previousRequestState = sageModel.getPrevRequestState();\n    return tableRequest;\n}\nfunction getTableRequestForFoldingCompletion(tokens, sageModel, numDuplicates) {\n    let tableRequest = getNewACTableRequest();\n    tableRequest.setInputTokens(tokens);\n    tableRequest.setCurrentlyEditedToken(sageModel.completionStartPosition);\n    tableRequest.setExactMatchOnly(true);\n    tableRequest.setMaxCompletions(numDuplicates);\n    tableRequest.previousRequestState = sageModel.getPrevRequestState();\n    return tableRequest;\n}\n/**\n * Is used to update the tokens of the sage model (using the tokens of the queryCompletion)\n *\n * @param queryCompletion\n */\nfunction getTokensFromCompletion(queryCompletion) {\n    return queryCompletion.getAllTokens();\n}\n/**\n * Processes tableResponse to give QueryCompletions\n *\n * @param {sage.ACTableResponse} tableResponse\n * @returns {Array.<sage.QueryCompletion>}\n */\nfunction getQueryCompletions(tableResponse) {\n    let completions = tableResponse.getQueryCompletions() || [];\n    completions.forEach(comp => {\n        let newTokens = tableResponse.getNewTokens();\n        let allTokens = [\n            ...newTokens.slice(0, comp.getNumPrefixTokens()),\n            ...comp.getCompletionTokens(),\n            ...newTokens.slice(newTokens.length - comp.getNumSuffixTokens())\n        ];\n        comp.setAllTokens(allTokens);\n    });\n    return completions;\n}\nexport { tokensToWords, wordsToUnrecognizedTokens, removeTrailingUnrecognizedEmptyTokens, getTokensFromWords, getPixelWidthOfSageInputString, equalRecognizedTokens, parseSageBarText, getSuffixRecognizedTokensInfo, getPrefixRecognizedTokensInfo, partitionInputBasedOnCaret, setTokensPosition, getQueryCompletions, preProcessQueryCompletions, setupSageForJoinDisambiguation, tokensToQuery, getPrefixRecognizedTokens, doesSageNeedJoinDisambiguation, getHashKey, getEffectiveDataScope, getViewMoreRequest, getTableRequestForFoldingCompletion, getTokensFromCompletion };\nProvide('sageUtil')({\n    tokensToWords,\n    wordsToUnrecognizedTokens,\n    removeTrailingUnrecognizedEmptyTokens,\n    getTokensFromWords,\n    getPixelWidthOfSageInputString,\n    equalRecognizedTokens,\n    parseSageBarText,\n    getSuffixRecognizedTokensInfo,\n    getPrefixRecognizedTokensInfo,\n    partitionInputBasedOnCaret,\n    setTokensPosition,\n    getQueryCompletions,\n    preProcessQueryCompletions,\n    setupSageForJoinDisambiguation,\n    tokensToQuery,\n    getPrefixRecognizedTokens,\n    doesSageNeedJoinDisambiguation,\n    getHashKey,\n    getEffectiveDataScope,\n    getViewMoreRequest,\n    getTableRequestForFoldingCompletion,\n    getTokensFromCompletion\n});\n//# sourceMappingURL=sage-util.js.map","/**\n * Copyright: ThoughtSpot Inc. 2019\n * Author: Lavish Mantri (lavish.mantri@thoughtspot.com)\n */\nimport { generateUUID } from '@thoughtspot/js-util';\nimport { isStackedChart } from './chart-type-specification-service';\nexport const CLIENT_STATE_VERSIONS = {\n    V2: 'V2'\n};\nexport const AXIS_TYPES = {\n    X: 'X',\n    Y: 'Y'\n};\nexport const CLIENT_STATE_KEYS = {\n    //old properties\n    roundedNumbers: 'roundedNumbers',\n    yAxisShared: 'yAxisShared',\n    gridLineConfig: 'gridLineConfig',\n    //upper level properties\n    columnProperties: 'columnProperties',\n    chartProperties: 'chartProperties',\n    axisProperties: 'axisProperties',\n    //column properties\n    dataLabels: 'dataLabels',\n    detailedLabels: 'detailedLabels',\n    format: 'format',\n    //axis properties\n    linkedColumns: 'linkedColumns',\n    yAxisRange: 'yAxisRange',\n    axisType: 'axisType',\n    name: 'name',\n    //chart level properties\n    pivotState: 'pivotState',\n    hidePivotSummaries: 'hidePivotSummaries',\n    summaryMode: 'summaryMode',\n    useFlatLayout: 'useFlatLayout',\n    isHeatmapOverlayed: 'isHeatmapOverlayed',\n    showLinearRegressionLine: 'showLinearRegressionLine',\n    markersEnabled: 'markersEnabled',\n    visibleSeriesNames: 'visibleSeriesNames',\n    axisExtremes: 'axisExtremes',\n    gridLines: 'gridLines',\n    isZoomed: 'isZoomed',\n    mapviewport: 'mapviewport',\n    isStackedAsPercent: 'isStackedAsPercent',\n    responsiveLayoutDisabled: 'responsiveLayoutDisabled',\n    chartSpecific: 'chartSpecific',\n    version: 'version'\n};\n// NOTE: The goal of this function is to translate client state from older\n// schema to new schema which is more amenable to the features we have now\n// with chart config v2.\n// The goal of this function is to not generate items based on heuristics etc\n// this purely translates value that were user set. This is critical distinction\n// we DONT want to generate system defined items here.\n// We have put in system defined pallete colors in the client state, but we need\n// to just decouple that from user defined as the impact on evaluation is different\n// on call sites.\nexport function upgradeClientStateToV2(chartModel) {\n    let columnProperties = {};\n    let axisProperties = {};\n    let chartProperties = {};\n    //set column properties\n    let columns = chartModel.getColumns();\n    columns.forEach(col => {\n        // NOTE: We set this for all columns and not just measure columns\n        // as there are cases like scatter chart where we have measure on\n        // x and y and we show data labels with the category value. In such\n        // case it makes sense to set this for all columns.\n        // For columns where its not needed this property won't be read.\n        let enableLabelsOnMeasure = isStackedChart(chartModel.getChartType())\n            ? chartModel.getUserData(CLIENT_STATE_KEYS.detailedLabels)\n            : chartModel.getUserData(CLIENT_STATE_KEYS.dataLabels);\n        columnProperties[col.getId()] = {\n            dataLabels: enableLabelsOnMeasure\n        };\n    });\n    // Set axis properties\n    // The axis configurator is not a system heuristic, this is expected\n    // to be not change unless user makes explicit changes and all explicit\n    // changes will be part of the model.\n    // There are the following cases in case of axis changes.\n    // 1. Edits in the query:\n    // 1a. Chart is locked:\n    // In this case the axis properties are retained as there is no change\n    // to the chart\n    // 1b. Chart is unlocked:\n    // In this case we will explicitly clear the axisProperties as the old\n    // properties are not expected to be reused.\n    // Further there will be an axis configuration generated using heuristics\n    // and at that point axisProperties need to be regenerated.\n    // 2. Axis configuration changes\n    // This is an incremental change so the callers will either add/remove axis\n    // or add/remove columns on axis\n    // Changes in properties like name, position, range etc are made on the axis.\n    // 3. Chart type changes\n    // 3a. Axis configuration is reused.\n    // In this case we retain axis properties.\n    // 3b. Axis configuration is generated.\n    // This is similar to case 1b, we will clear the axisProperties and regenerate\n    // the new ones.\n    let yAxisColumns = chartModel.getYAxisColumns();\n    let yAxisRange = chartModel.getUserData(CLIENT_STATE_KEYS.yAxisRange);\n    // If Y axis are shared, we put all axis as one at put columns linked in the state\n    if (chartModel.getUserData(CLIENT_STATE_KEYS.yAxisShared)) {\n        axisProperties[generateUUID()] = {\n            linkedColumns: yAxisColumns.map(col => col.getId()),\n            axisType: AXIS_TYPES.Y,\n            yAxisRange,\n        };\n        //if axis are unshared, we still put respective column Ids in state.\n        // So as to know which column it belongs to and this info helps during\n        // linking/unlinking.\n    }\n    else {\n        yAxisColumns.forEach(col => {\n            axisProperties[generateUUID()] = {\n                linkedColumns: [col.getId()],\n                axisType: AXIS_TYPES.Y,\n                yAxisRange\n            };\n        });\n    }\n    let xAxisColumns = chartModel.getXAxisColumns();\n    axisProperties[generateUUID()] = {\n        linkedColumns: xAxisColumns.map(col => col.getId()),\n        axisType: AXIS_TYPES.X\n    };\n    //set chart properties\n    let visibleSeriesNames = chartModel.getUserData(CLIENT_STATE_KEYS.visibleSeriesNames);\n    if (visibleSeriesNames) {\n        chartProperties.visibleSeriesNames = visibleSeriesNames;\n    }\n    let axisExtremes = chartModel.getUserData(CLIENT_STATE_KEYS.axisExtremes);\n    if (axisExtremes) {\n        chartProperties.axisExtremes = axisExtremes;\n    }\n    let gridLineConfig = chartModel.getUserData(CLIENT_STATE_KEYS.gridLineConfig);\n    if (gridLineConfig) {\n        chartProperties.gridLines = gridLineConfig;\n    }\n    let isZoomed = chartModel.getUserData(CLIENT_STATE_KEYS.isZoomed);\n    if (isZoomed) {\n        chartProperties.isZoomed = isZoomed;\n    }\n    let mapviewport = chartModel.getUserData(CLIENT_STATE_KEYS.mapviewport);\n    if (mapviewport) {\n        chartProperties.mapviewport = mapviewport;\n    }\n    let isStackedAsPercent = chartModel.getUserData(CLIENT_STATE_KEYS.isStackedAsPercent);\n    if (isStackedAsPercent) {\n        chartProperties.isStackedAsPercent = isStackedAsPercent;\n    }\n    if (isStackedChart(chartModel.getChartType())\n        && chartModel.getUserData(CLIENT_STATE_KEYS.dataLabels)) {\n        chartProperties.showStackedLabels = true;\n    }\n    let responsiveLayoutDisabled = chartModel.getUserData(CLIENT_STATE_KEYS.responsiveLayoutDisabled);\n    if (responsiveLayoutDisabled) {\n        chartProperties.responsiveLayoutDisabled = responsiveLayoutDisabled;\n    }\n    let showLinearRegressionLine = chartModel\n        .getUserData(CLIENT_STATE_KEYS.showLinearRegressionLine);\n    if (showLinearRegressionLine) {\n        chartProperties.showLinearRegressionLine = showLinearRegressionLine;\n    }\n    let chartSpecificProperties = {};\n    let props = [\n        CLIENT_STATE_KEYS.pivotState,\n        CLIENT_STATE_KEYS.hidePivotSummaries,\n        CLIENT_STATE_KEYS.summaryMode,\n        CLIENT_STATE_KEYS.useFlatLayout,\n        CLIENT_STATE_KEYS.isHeatmapOverlayed,\n        CLIENT_STATE_KEYS.markersEnabled\n    ];\n    props.forEach(prop => {\n        chartSpecificProperties[prop] = chartModel.getUserData(prop);\n    });\n    chartProperties.chartSpecific = chartSpecificProperties;\n    //TODO:: Should clear these keys once all respective getters and setters\n    //are removed. Should clear one by one, in case a getter setter is removed\n    // let keysToClear = [\n    //     'dataLabels',\n    //     'detailedLabels',\n    //     'roundedNumbers',\n    //     'yAxisShared',\n    //     'yAxisRange',\n    //     'visibleSeriesNames',\n    //     'axisExtremes',\n    //     'gridLineConfig',\n    //     'isZoomed',\n    //     'mapviewport',\n    //     'isStackedAsPercent',\n    //     'responsiveLayoutDisabled',\n    //     'pivotState',\n    //     'hidePivotSummaries',\n    //     'summaryMode',\n    //     'useFlatLayout',\n    //     'isHeatmapOverlayed',\n    //     'showLinearRegressionLine',\n    //     'markersEnabled'\n    // ];\n    //\n    // keysToClear.forEach(key => {\n    //     this.cleanClientStateForKey(key);\n    // });\n    return {\n        columnProperties,\n        axisProperties,\n        chartProperties,\n        [CLIENT_STATE_KEYS.version]: CLIENT_STATE_VERSIONS.V2\n    };\n}\n//# sourceMappingURL=client-state.js.map","/**\n * Copyright: ThoughtSpot Inc. 2014\n * Author: Shikhar Agarwal (shikhar@thoughtspot.com)\n * Francois Chabbey (francois.chabbey@thoughtspot.com)\n *\n * @fileoverview An interface of a model associated with a document.\n *               This encapsulates the header json and also exposes methods that are expected\n *               from different types of models\n *               like answerModel, logicalTableModel by sage, sharable item, etc.\n *\n */\n'use strict';\nimport * as tslib_1 from \"tslib\";\nimport * as Logger from '@thoughtspot/logger';\nimport { dateFormatPresets, formatTimeOfDay } from '@thoughtspot/date-format-util/date-util';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport _ from 'lodash';\nimport { ngRequire, Provide } from '../../base/decorators';\nimport { getUserActionFailureAlertContent } from '../../services/utilities/alert-message-util';\nimport { logUserActionFailureEvent } from '../../services/utilities/event-log-helper-util';\nlet messageService = ngRequire('messageService');\nlet metadataUtil = ngRequire('metadataUtil');\nlet DocumentModel = class DocumentModel {\n    constructor(headerJson) {\n        this._incompletionDetails = null;\n        this._isCorrupted = false;\n        this._shouldForceSave = false;\n        this._isAutoUpgraded = false;\n        this._recognizedTokens = [];\n        this._hasUserTriggeredChanges = false;\n        this._dataTraceIds = [];\n        if (!headerJson || !headerJson[jsonConstants.ID_KEY]) {\n            throw new Error('Invalid document model json: ' + JSON.stringify(headerJson));\n        }\n        this._header = headerJson;\n        this._docPermission = null; //DocumentPermissionFactory.createPermissiveInstance(\n        //jsonConstants.metadataType.LOGICAL_TABLE);\n        // TODO(Jasmeet): Move non document scoped data like tokens out of this model.\n        this._isCorrupted = false;\n        this._isAutoUpgraded = false;\n        this._incompletionDetails = null;\n        /**\n         * Whether on attempt to save this document on callosum, callosum should be forced to save\n         * the model even if the model has broken columns.\n         */\n        this._shouldForceSave = false;\n        this._logger = Logger.create('document-model');\n    }\n    /**\n     * Gets the header json\n     * @returns {*}\n     */\n    getHeaderJson() {\n        return this._header;\n    }\n    /**\n     * Gets the Id from the header json\n     * @returns {*}\n     */\n    getId() {\n        return this._header[jsonConstants.ID_KEY];\n    }\n    /**\n     *\n     * @param id {string}\n     */\n    setId(id) {\n        this._header[jsonConstants.ID_KEY] = id;\n    }\n    /**\n     * Gets the name from the header json\n     * @returns {*}\n     */\n    getName() {\n        return this._header[jsonConstants.NAME_KEY];\n    }\n    /**\n     * Gets the description from the header json\n     * @returns {*}\n     */\n    getDescription() {\n        return this._header[jsonConstants.DESCRIPTION_KEY];\n    }\n    /**\n     * Gets the author Id from the header json\n     * @returns {*}\n     */\n    getAuthorId() {\n        return this._header[jsonConstants.AUTHOR_KEY];\n    }\n    /**\n     * Gets the author name from the header json\n     * @returns {*}\n     */\n    getAuthorName() {\n        return this._header[jsonConstants.AUTHOR_NAME];\n    }\n    /**\n     * Gets the author name from the header json\n     * @returns {*}\n     */\n    getAuthorDisplayName() {\n        return this._header[jsonConstants.AUTHOR_DISPLAY_NAME];\n    }\n    /**\n     * Gets metadata trace id collected from callosum response\n     * @returns {*}\n     */\n    getMetadataTraceId() {\n        return this._metadataTraceId;\n    }\n    /**\n     * Gets data trace ids collected from callosum response\n     * @returns {*}\n     */\n    getDataTraceIds() {\n        return this._dataTraceIds;\n    }\n    /**\n     * Gets all trace ids collected from callosum response\n     * @returns {*}\n     */\n    getTraceIds() {\n        let traceIds = [];\n        traceIds.push(this._metadataTraceId);\n        traceIds.push.apply(traceIds, this._dataTraceIds);\n        return traceIds;\n    }\n    /**\n     * Returns if the document model is hidden.\n     * @returns {*}\n     */\n    isHidden() {\n        return !!this._header[jsonConstants.IS_HIDDEN_KEY];\n    }\n    /**\n     * Sets the name of the document in the header json\n     * @param name\n     */\n    setName(name) {\n        if (!name || !name.length) {\n            return;\n        }\n        this._header[jsonConstants.NAME_KEY] = name;\n    }\n    /**\n     * Sets the description in the header json\n     * @param description\n     */\n    setDescription(description) {\n        this._header[jsonConstants.DESCRIPTION_KEY] = description;\n    }\n    /**\n     * Sets the metadata traceId collected from callosum response\n     * @param traceId\n     */\n    setMetadataTraceId(traceId) {\n        this._metadataTraceId = traceId;\n    }\n    /**\n     * Append the data traceId collected from callosum response to traceIds list\n     * @param traceId\n     */\n    addDataTraceId(traceId) {\n        this._dataTraceIds.push(traceId);\n    }\n    /**\n     * Use the prototype to navigate the given json and find the document id from it.\n     *\n     * @param {Object} json\n     * @return {string}\n     */\n    getDocumentIdFromJson(json) {\n        return _.get(json, [jsonConstants.HEADER_KEY, jsonConstants.ID_KEY]);\n    }\n    // Section 2: Interfaces of methods common to different kinds of documents\n    /**\n     *\n     * @param {DocumentPermission} docPermission\n     */\n    setPermission(docPermission) {\n        this._docPermission = docPermission;\n    }\n    /**\n     *\n     * @return {DocumentPermission}\n     */\n    getPermission() {\n        return this._docPermission;\n    }\n    /**\n     * Return true if the document has been created on the backend datastore (postgres).\n     * @return {boolean}\n     */\n    isCreatedOnServer() {\n        return this._header && this._header[jsonConstants.GENERATION_NUM_KEY] >= 0;\n    }\n    setCreatedOnServer() {\n        if (this._header && this._header[jsonConstants.GENERATION_NUM_KEY]) {\n            if (!this._header[jsonConstants.GENERATION_NUM_KEY]\n                || this._header[jsonConstants.GENERATION_NUM_KEY] < 0) {\n                this._header[jsonConstants.GENERATION_NUM_KEY] = 1;\n            }\n        }\n    }\n    shouldForceSave() {\n        return this._shouldForceSave;\n    }\n    setShouldForceSave(shouldForceSave) {\n        this._shouldForceSave = !!shouldForceSave;\n    }\n    getCreatedTime() {\n        return formatTimeOfDay(this._header[jsonConstants.CREATED_KEY], dateFormatPresets.DATETIME_24_SHORT, true);\n    }\n    getCreatedEpoch() {\n        return this._header[jsonConstants.CREATED_KEY];\n    }\n    getModifiedTime(options) {\n        if (!this._header.hasOwnProperty('modified')) {\n            return '';\n        }\n        return formatTimeOfDay(this._header['modified'], dateFormatPresets.DATETIME_24_SHORT, true);\n    }\n    metadataEquals(model1, model2) {\n        return angular.equals(model1, model2);\n    }\n    containsChangesFromStateStoredOnServer(referenceMetadataJson) {\n        return this.hasBeenModified(referenceMetadataJson);\n    }\n    // TODO(Jasmeet): Migrate to a model where we only have two kinds of constructs\n    // 1. Has model state changed for properties stored on server.\n    // 2. Support diffing logic with params to ignore certain properties.\n    hasBeenModified(referenceMetadataJson) {\n        if (!referenceMetadataJson) {\n            this._logger.error('invalid referenceMetadataJson', referenceMetadataJson);\n            return false;\n        }\n        if (this.hasUserTriggeredChanges()) {\n            return true;\n        }\n        return !this.metadataEquals(referenceMetadataJson, this.getMetadataJson());\n    }\n    setHasUserTriggeredChanges(hasUserTriggeredChanges) {\n        this._hasUserTriggeredChanges = hasUserTriggeredChanges;\n    }\n    hasUserTriggeredChanges() {\n        return this._hasUserTriggeredChanges;\n    }\n    /**\n     *\n     * @return {boolean}\n     */\n    hasAnyEditorialWarnings() {\n        return false;\n    }\n    /**\n     *\n     * @return {string}\n     */\n    getEditorialWarnings() {\n        return '';\n    }\n    /**\n     *\n     * @return {boolean}\n     */\n    isPermittedToSave() {\n        return true;\n    }\n    /**\n     * Returns if the Document model is corrupted in any way\n     * @returns {boolean}\n     */\n    isCorrupted() {\n        return this._isCorrupted;\n    }\n    /**\n     * Returns the incompletionDetails\n     * @returns {Object}\n     */\n    getCorruptionDetails() {\n        return this._incompletionDetails;\n    }\n    getAlertContent(userAction, response, code) {\n        let params = {\n            substitutions: [this.getName()],\n            customData: {\n                incompleteDetails: this.getCorruptionDetails(),\n                getDisplayNameForMetadataTypeName: metadataUtil.getDisplayNameForMetadataTypeName\n            },\n            customUrl: 'src/common/widgets/alert/templates/missing-document-alert-template.html',\n            code: code || messageService.blinkGeneratedErrors.INCOMPLETE_DOCUMENT\n        };\n        let content = getUserActionFailureAlertContent(userAction, response, params);\n        logUserActionFailureEvent(userAction, response, params);\n        return content;\n    }\n    /**\n     * Reads the sage tokens in the given document and returns the list of tables\n     * that the tokens belong to.\n     *\n     * @return {Array.<string>=}\n     */\n    getSageDataScope() {\n        let tableGuids = this.getTableGuidsFromContext(this.getQuestionInfo());\n        // NOTE: In case of tokens like 'average' etc table guid is null.\n        return tableGuids.filter(tableGuid => !!tableGuid);\n    }\n    /**\n     * @returns {Array<string>} the table guid of the root table of the current query in\n     * the document\n     */\n    getQueryRoots() {\n        let recognizedTokens = this.getRecognizedTokens();\n        if (!recognizedTokens || !recognizedTokens.length) {\n            return null;\n        }\n        let queryRoots = [];\n        recognizedTokens.forEach((recognizedToken) => {\n            let joinPaths = recognizedToken.getJoinPaths();\n            if (!joinPaths || !joinPaths.length) {\n                this._logger.warn('join path missing from recognized token', recognizedTokens[0]);\n                return null;\n            }\n            joinPaths.forEach((joinPath) => {\n                let joinPathRoot = joinPath.getRootTableGuid();\n                if (queryRoots.indexOf(joinPathRoot) < 0) {\n                    queryRoots.push(joinPathRoot);\n                }\n            });\n        });\n        return queryRoots;\n    }\n    isAutoUpgraded() {\n        return this._isAutoUpgraded;\n    }\n    setIsAutoUpgraded(isAutoUpgraded) {\n        this._isAutoUpgraded = !!isAutoUpgraded;\n    }\n    getTimeToLive() {\n        return -1;\n    }\n    getRecognizedTokens() {\n        return this._recognizedTokens;\n    }\n    /**\n     * Extracts key model properties to be passed for eventCollection, logging etc.. purposes\n     */\n    getEventProperties() {\n        let eventProps = {\n            objectId: this.getId(),\n            objectAuthorId: this.getAuthorId(),\n            objectCreatedAt: this._header[jsonConstants.CREATED_KEY],\n            objectType: this.getMetadataType(),\n            objectSubType: this.getMetadataSubType(),\n            objectQueryTables: this.getQueryRoots(),\n        };\n        for (let prop in eventProps) {\n            if (!eventProps[prop]) {\n                eventProps[prop] = 'NA';\n            }\n        }\n        return eventProps;\n    }\n    setRecognizedTokens(recognizedTokes) {\n        this._recognizedTokens = recognizedTokes;\n    }\n    getGenerationNumber() {\n        return this._header[jsonConstants.GENERATION_NUM_KEY];\n    }\n    inheritNonJsonProperties(baseDocument) {\n        this.setPermission(baseDocument.getPermission());\n        this.setIsAutoUpgraded(baseDocument.isAutoUpgraded());\n        this._isCorrupted = baseDocument.isCorrupted();\n        this._incompletionDetails = baseDocument.getCorruptionDetails();\n        this.setShouldForceSave(baseDocument.shouldForceSave());\n        this.setRecognizedTokens(baseDocument.getRecognizedTokens());\n    }\n    getTableGuidsFromTokens(tokens) {\n        return tokens\n            .filter(rt => rt.hasTableMetadata())\n            .map(rt => rt.getTableGuid()) || [];\n    }\n    getTableGuidsFromContext(questionInfo) {\n        let sageContext = questionInfo.getContext();\n        let sageContextIndex = questionInfo.getContextIndex();\n        let tokens = sageContext.getTables()[sageContextIndex].getTokens();\n        let tableGuids = this.getTableGuidsFromTokens(tokens);\n        sageContext.getFormulae().forEach((formula) => {\n            tokens = formula.getTokens();\n            tableGuids.concat(this.getTableGuidsFromTokens(tokens));\n        });\n        return _.uniq(tableGuids);\n    }\n};\nDocumentModel = tslib_1.__decorate([\n    Provide('DocumentModel')\n], DocumentModel);\nexport { DocumentModel };\n//# sourceMappingURL=document-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2018\n * Author: Utsav Kapoor (utsav.kapoor@thoughtspot.com)\n *\n * @fileoverview Service used to access an answer\n */\nimport { ngRequire, Provide } from '../../../base/decorators';\nimport { strings } from '../../../base/strings';\nimport { AnswerModel } from '../../document-model/answer-model/answer-model';\nconst metadataService = ngRequire('metadataService');\nfunction processResponseData(metadataType, response) {\n    let data = response.data;\n    let permissions = null;\n    //if detailData is present, the format is wrapped by detailData and permission\n    if (data.hasOwnProperty('detailData')) {\n        data = response.data.detailData;\n        permissions = response.data.permissions;\n    }\n    //the structure of the json reported is needs to have some extra fields added to make it similar\n    //to the one returned when we fetch full model so that the parsing logic can stay the same\n    let dataNode = {};\n    data.reportContent.sheets.forEach(function (sheet) {\n        dataNode[sheet.header.id] = {\n            vizData: {}\n        };\n    });\n    data = {\n        completionRatio: 1,\n        reportBookData: dataNode,\n        reportBookMetadata: data\n    };\n    //TODO: update AnswerModel to accept data-less json in constructor\n    response.data = new AnswerModel(data);\n    let answerModel, answerSheet;\n    // NOTE:\n    // 1. In answer page redesign to remove redundant titles between answer and viz we end\n    // up in the situation where users might have old pinned answer where the answer name was\n    // never set instead user sets the viz title that was getting pinned.\n    // To avoid the jarring experience to showing UNTITLED as the title we display the title\n    // of the viz that was pinned.\n    // 2. The migration is done while loading the page as for the app this is not a change in\n    // answer model. If the name is changed upstream we run into issues when comparing answer\n    // model snapshots.\n    if (response.data.isHidden()) {\n        answerModel = response.data;\n        if (answerModel.getName() === strings.UNTITLED_OBJECT_NAME) {\n            answerSheet = answerModel && answerModel.getCurrentAnswerSheet();\n            let primaryViz = answerSheet && answerSheet.getPrimaryDisplayedViz();\n            if (!!primaryViz) {\n                answerModel.setName(primaryViz.getName());\n                answerModel.setDescription(primaryViz.description);\n            }\n        }\n    }\n    // NOTE: User can have unlocked configuration but in case of saved answer\n    // user expects the answer visualization he has saved. Hence, we are locking the config.\n    answerModel = response.data;\n    answerSheet = answerModel && answerModel.getCurrentAnswerSheet();\n    let chartVisualizations = !!answerSheet ? answerSheet.getChartVisualizations() : [];\n    chartVisualizations.forEach(function (chartViz) {\n        chartViz.setIsConfigurationLocked(true);\n    });\n    if (permissions !== null) {\n        response.permissions = permissions;\n    }\n    return response;\n}\nfunction getAnswerModelFromReportBook(reportBook) {\n    //the structure of the json reported is needs to have some extra fields added to make it similar\n    //to the one returned when we fetch full model so that the parsing logic can stay the same\n    let dataNode = {};\n    reportBook.reportContent.sheets.forEach((sheet) => {\n        dataNode[sheet.header.id] = {\n            vizData: {}\n        };\n    });\n    let data = {\n        completionRatio: 1,\n        reportBookData: dataNode,\n        reportBookMetadata: reportBook\n    };\n    return new AnswerModel(data);\n}\nfunction getInsightAnswerModelFromReportBook(reportBook) {\n    //the structure of the json reported is needs to have some extra fields added to make it similar\n    //to the one returned when we fetch full model so that the parsing logic can stay the same\n    let dataNode = {};\n    reportBook.reportContent.sheets.forEach((sheet) => {\n        dataNode[sheet.header.id] = {\n            vizData: {}\n        };\n    });\n    let data = {\n        completionRatio: 1,\n        reportBookData: dataNode,\n        reportBookMetadata: reportBook\n    };\n    return {};\n}\nfunction getModelMetadata(answerBookId, isIgnorable, metadataType) {\n    let params = {\n        showHidden: true,\n        isIgnorable: !!isIgnorable\n    };\n    let responseProcessor = processResponseData.bind(undefined, metadataType);\n    return metadataService.getMetadataObjectDetails(metadataType, answerBookId, params)\n        .then(responseProcessor);\n}\nfunction getModelMetadataWithPermission(answerBookId, isIgnorable, metadataType, requestType) {\n    let params = {\n        showHidden: true,\n        isIgnorable: !!isIgnorable,\n        requestType: requestType\n    };\n    let responseProcessor = processResponseData.bind(undefined, metadataType);\n    return metadataService.getMetadataObjectDetailWithPermission(metadataType, answerBookId, params)\n        .then(responseProcessor);\n}\nexport { getAnswerModelFromReportBook, getInsightAnswerModelFromReportBook, getModelMetadata, getModelMetadataWithPermission };\nProvide('answerMetadataUtil')({\n    getAnswerModelFromReportBook,\n    getInsightAnswerModelFromReportBook,\n    getModelMetadata,\n    getModelMetadataWithPermission\n});\n//# sourceMappingURL=answer-metadata-util.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2019\n * Author: Vibhor Nanavati (vibhor@thoughtspot.com),\n *         Shikhar Agarwal (shikhar@thoughtspot.com)\n *\n * @fileoverview Encapsulates the details of visualization.\n */\nimport * as tslib_1 from \"tslib\";\nvar VisualizationModel_1;\nimport { blinkConstants } from '@thoughtspot/blink-constants/blink-constants';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport { create } from '@thoughtspot/logger';\nimport _ from 'lodash';\nimport { ngRequire, Provide } from '../../../base/decorators';\nimport { flags } from '../../../base/flags';\nimport { strings } from '../../../base/strings';\nimport { VisualizationColumnModel } from '../../callosum/model/visualization-column';\nimport { getHashKey } from '../../sage-v2/sage-util/sage-util';\nconst util = ngRequire('util');\nlet VisualizationModel = VisualizationModel_1 = class VisualizationModel {\n    /**\n     * @param {Object} params Contains following properties:\n     *    - vizJson Json backing the visualization definition.\n     *    - vizData The visualization data for this viz.\n     *    - referencingVizModel Optional argument, when provided means this VisualizationModel\n     *      object is actually a reference copy of visualization from another book.\n     *      The referencingVizModel is the object in current book holding the\n     *      reference. See PinboardVizModel::getReferencedVisualization() for\n     *      more details.\n     *\n     * @constructor\n     */\n    constructor(params) {\n        this.params = params;\n        this._logger = create('visualization-model');\n        this._dataBatchSize = flags.getValue(flags.BLINK_FLAGS.dataBatchSize.name)\n            || blinkConstants.DEFAULT_DATA_BATCH_SIZE;\n        this._isRenderReady = false;\n        this._isSecondaryRenderReady = false;\n        // This is used in case of headline models to ignore rendering when query is sampled.\n        // In such cases the viz is not rendered as we know that the result is going to be\n        // inaccurate.\n        this.ignoreRendering = false;\n        this.isPBDDViz = false;\n        let vizJson = params.vizJson, vizData = params.vizData, referencingVizModel = params.referencingVizModel;\n        this._vizJson = vizJson;\n        this._vizData = vizData || {};\n        this._referencingVizModel = referencingVizModel || null;\n        this._answerModel = params.answerModel || null;\n        this._vizColumns = null;\n        this._dataLoadFailed = false;\n        if (vizData && _.has(vizData, 'currentOffset')) {\n            this.setSavedDataOffset(this._vizData.currentOffset);\n        }\n        let header = vizJson[jsonConstants.HEADER_KEY] || null;\n        if (!header) {\n            throw new Error('Invalid visualization specification (no header found)', vizJson);\n        }\n    }\n    static createEmptyVisualizationDefinition(answerSheet, vizType, vizGuid) {\n        return {\n            vizContent: {\n                vizType: vizType\n            },\n            header: {\n                id: vizGuid,\n                name: 'User created visualization',\n                owner: answerSheet.getId()\n            }\n        };\n    }\n    static areDefinitionsEqual(a, b) {\n        return a.getId() === b.getId() &&\n            JSON.stringify(a.getJson()) === JSON.stringify(b.getJson());\n    }\n    static areDataEqual(a, b) {\n        return JSON.stringify(a.getVizData()) === JSON.stringify(b.getVizData());\n    }\n    /**\n     * Whether two viz models are equal\n     *\n     * @param {Object}  a   First viz model\n     * @param {Object}  b   Second viz model\n     * @return {boolean}\n     */\n    static areModelsEqual(a, b) {\n        return VisualizationModel_1.areDefinitionsEqual(a, b)\n            && VisualizationModel_1.areDataEqual(a, b);\n    }\n    /**\n     * @return {string} Id of the visualization this model represents.\n     */\n    getId() {\n        return this._vizJson[jsonConstants.HEADER_KEY][jsonConstants.ID_KEY];\n    }\n    isCorrupted() {\n        return !this._vizJson[jsonConstants.VIZ_COMPLETE_KEY];\n    }\n    // TODO (Ashish/Rahul): We should ideally combine primary\n    // and secondary render into a render state enum.\n    isRenderReady() {\n        return this._isRenderReady;\n    }\n    setRenderReady(state) {\n        this._isRenderReady = state;\n    }\n    isSecondaryRenderReady() {\n        return this._isSecondaryRenderReady;\n    }\n    setSecondaryRenderReady(state) {\n        this._isSecondaryRenderReady = state;\n    }\n    /**\n     * @return {string} Type of the visualization this model represents.\n     */\n    getVizType() {\n        return _.get(this._vizJson, [jsonConstants.VIZ_CONTENT_KEY, jsonConstants.VIZ_TYPE_KEY]) || '';\n    }\n    /**\n     * @return {string} Subtype of the visualization this model represents.\n     */\n    getVizSubtype() {\n        return _.get(this._vizJson, [jsonConstants.VIZ_CONTENT_KEY, jsonConstants.VIZ_SUBTYPE_KEY]) || '';\n    }\n    /**\n     * @return {string} The name of the viz\n     */\n    getName() {\n        return this._vizJson[jsonConstants.HEADER_KEY][jsonConstants.VIZ_NAME_KEY];\n    }\n    setName(name) {\n        _.set(this._vizJson, [jsonConstants.VIZ_HEADER_KEY, jsonConstants.VIZ_NAME_KEY], name);\n    }\n    getDescription() {\n        if (!this._vizJson) {\n            return '';\n        }\n        return this._vizJson[jsonConstants.VIZ_HEADER_KEY][jsonConstants.DESCRIPTION_KEY] || '';\n    }\n    setDescription(description) {\n        _.set(this._vizJson, [jsonConstants.VIZ_HEADER_KEY, jsonConstants.DESCRIPTION_KEY], description);\n    }\n    /**\n     * Get the viz title\n     * @return {string} The title of the viz\n     */\n    getTitle() {\n        let vizContent = this._vizJson[jsonConstants.VIZ_CONTENT_KEY];\n        if (!vizContent) {\n            return '';\n        }\n        let vizTitleObj = vizContent[jsonConstants.VIZ_TITLE_KEY];\n        if (!vizTitleObj) {\n            return '';\n        }\n        return vizTitleObj[jsonConstants.VALUE_KEY][jsonConstants.TEXT_KEY];\n    }\n    getAutoTitle() {\n        let columns = this.getVizColumns();\n        let groupingColumnNames = '';\n        let valueColumnNames = '';\n        columns.forEach((column) => {\n            if (column.isGroupingColumn()) {\n                groupingColumnNames += ' ' + column.getName();\n            }\n            else {\n                valueColumnNames += ' ' + column.getName();\n            }\n        });\n        groupingColumnNames = groupingColumnNames.trim();\n        valueColumnNames = valueColumnNames.trim();\n        if (valueColumnNames && groupingColumnNames) {\n            return valueColumnNames + ' ' + strings.BY + ' ' + groupingColumnNames;\n        }\n        else if (valueColumnNames) {\n            return valueColumnNames;\n        }\n        else if (groupingColumnNames) {\n            return groupingColumnNames;\n        }\n        else {\n            return '';\n        }\n    }\n    getDisplayedViz() {\n        return this;\n    }\n    /**\n     * Set the viz title\n     * @param {string} title      The value we want to set as title\n     */\n    setTitle(title) {\n        let titlePath = [\n            jsonConstants.VIZ_CONTENT_KEY,\n            jsonConstants.VIZ_TITLE_KEY,\n            jsonConstants.VALUE_KEY,\n            jsonConstants.TEXT_KEY\n        ];\n        _.set(this._vizJson, titlePath, title);\n    }\n    setAutoTitle(prefixString) {\n        prefixString = prefixString.trim();\n        if (!prefixString) {\n            return;\n        }\n        let vizType = this.getVizType().toLowerCase();\n        this.setTitle(prefixString + ' ' + vizType);\n    }\n    /**\n     * Returns the visualization's content definition object.\n     */\n    getJson() {\n        return this._vizJson[jsonConstants.VIZ_CONTENT_KEY];\n    }\n    /**\n     * This visualization's data object.\n     *\n     * @return {Object}\n     */\n    getVizData() {\n        return this._vizData;\n    }\n    /**\n     * Size of the visualization's data\n     *\n     * @returns {number}\n     */\n    getVizDataSize() {\n        let vizData = this._vizData && this._vizData[0];\n        return (vizData)\n            ? this._vizData.length * this._vizData[0].lengthAdjust\n            : 0;\n    }\n    updateData(vizData) {\n        this._vizData = vizData;\n    }\n    clearData() {\n        delete this._vizData;\n    }\n    /**\n     * This visualization's ref to answer model that contains it.\n     *\n     * @return {AnswerModel}\n     */\n    getContainingAnswerModel() {\n        return this._answerModel;\n    }\n    /**\n     * This visualization's ref to answer model that contains it.\n     *\n     * @return {AnswerModel}\n     */\n    setContainingAnswerModel(answerModel) {\n        this._answerModel = answerModel;\n    }\n    /**\n     * Returns the visualization's referencing viz\n     *\n     * @return {Object}\n     */\n    getReferencingViz() {\n        return this._referencingVizModel;\n    }\n    /**\n     * Returns the visualization's referencing viz\n     *\n     * @return {Object}\n     */\n    setReferencingViz(referencingVizModel) {\n        this._referencingVizModel = referencingVizModel;\n    }\n    /**\n     * Returns the refAnswerSheetQuestion node in the viz's metadata json.\n     * @returns {Object}\n     */\n    getRefAnswerSheetInfo() {\n        let vizJson = this.getJson();\n        if (!vizJson || !_.has(vizJson, jsonConstants.REF_ANSWER_BOOK_KEY)) {\n            return null;\n        }\n        let refAnswerSheetInfo = vizJson[jsonConstants.REF_ANSWER_BOOK_KEY][jsonConstants.SHEETS_KEY][0];\n        return refAnswerSheetInfo;\n    }\n    /**\n     * Returns the parent answer sheet's question text if this is a referenced viz.\n     * Works by getting the referencing viz model, and calling the\n     * getReferencedQuestionText method on it.\n     *\n     * @return {string}\n     */\n    getQuestionText() {\n        return this.getQuestion().getText();\n    }\n    /**\n     * Returns the underlying Question model\n     * @return {null|any}\n     */\n    getQuestion() {\n        let parentAnswerModel = this.getContainingAnswerModel();\n        let parentAnswerSheet = parentAnswerModel.getCurrentAnswerSheet();\n        return parentAnswerSheet.getQuestionInfo();\n    }\n    /**\n     * Returns the id of the answer book that contains the referenced viz, meaning the id of the\n     * copy of the answer book the user dragged the viz from when they added it to the pinboard\n     * @return {string} The answer book id\n     */\n    getReferencedAnswerBookId() {\n        let refAnswerSheetInfo = this.getRefAnswerSheetInfo();\n        if (!refAnswerSheetInfo || !refAnswerSheetInfo[jsonConstants.OWNER_KEY]) {\n            return '';\n        }\n        return refAnswerSheetInfo[jsonConstants.OWNER_KEY];\n    }\n    getTopCount() {\n        let topCount = this.getJson().topCount;\n        return topCount || null;\n    }\n    /**\n     * @return {Array}\n     *\n     * Get the table columns\n     */\n    getColumns() {\n        return this.getJson().columns;\n    }\n    /**\n     * A hook to allow subclasses to use custom Viz Col subclasses.\n     * Used by headline column model.\n     * @returns {Array}\n     */\n    createVizColumns() {\n        let vizModel = this;\n        return this.getColumns().map(function (c, idx) {\n            let colData = vizModel.getColumnData(idx);\n            return new VisualizationColumnModel(c, idx, null, colData);\n        });\n    }\n    /**\n     * @return {Array.<VisualizationColumnModel>}\n     */\n    getVizColumns() {\n        if (this._vizColumns === null) {\n            this._vizColumns = this.createVizColumns();\n        }\n        return this._vizColumns;\n    }\n    getVisualizedColumns() {\n        return this.getVizColumns();\n    }\n    getVisualizedMeasureColumns() {\n        return this.getVisualizedColumns().filter((column) => {\n            return column.isEffectivelyNumeric();\n        });\n    }\n    getVisualizedAttributeColumns() {\n        return this.getVisualizedColumns().filter((column) => {\n            return column.isEffectivelyNonNumeric();\n        });\n    }\n    /**\n     * Returns the number of columns for which data is available\n     *\n     * @return {number}\n     */\n    getColumnCount() {\n        let vizJson = this.getJson();\n        if (vizJson.columns) {\n            return vizJson.columns.length;\n        }\n        return 0;\n    }\n    /**\n     * Returns the data for the column with the given dataRowIndex\n     * @param {Number} columnDataRowIndex\n     * @returns {Array.<*>}\n     */\n    getColumnData(columnDataRowIndex) {\n        let vizData = this.getVizData().data;\n        if (!vizData || !vizData.length) {\n            return [];\n        }\n        if (vizData[0].length <= columnDataRowIndex) {\n            this._logger.warn('no column data found for col at dataRowIndex', columnDataRowIndex);\n            return [];\n        }\n        return vizData.map(function (row) {\n            return row[columnDataRowIndex];\n        });\n    }\n    /**\n     * @return {boolean}\n     */\n    hasMoreData() {\n        return !this.getVizData().isLastBatch;\n    }\n    /**\n     * Returns true if this viz model is same as that.\n     * The meaning of equals() is very strict.\n     * Both the content definition and viz data have to match.\n     *\n     * @param {VisualizationModel} that\n     */\n    equals(that) {\n        if (!that) {\n            return false;\n        }\n        return VisualizationModel_1.areModelsEqual(this, that);\n    }\n    /**\n     * Returns true if this viz is configured to load data lazily.\n     *\n     * @return {boolean}\n     */\n    isDataOnDemand() {\n        return !!this.getJson().dataOnDemand;\n    }\n    /**\n     * Reconfigure viz to load data synchronously.\n     *\n     * @param {boolean} dataOnDemand\n     */\n    setDataOnDemand(dataOnDemand) {\n        this.getJson().dataOnDemand = dataOnDemand;\n    }\n    setUserData(key, value) {\n        let clientState = this.getClientState();\n        _.set(clientState, key, value);\n    }\n    getUserData(key) {\n        let clientState = this.getClientState();\n        return clientState && _.get(clientState, key);\n    }\n    clearUserData(key) {\n        let clientState = this.getClientState();\n        if (clientState) {\n            util.deleteProp(clientState, key);\n        }\n    }\n    hasUserData(key) {\n        let clientState = this.getClientState();\n        return clientState && _.has(clientState, key);\n    }\n    hasUserMadeConfigChanges() {\n        return false;\n    }\n    getSavedDataOffset() {\n        return this.getUserData('dataOffset') || 0;\n    }\n    setSavedDataOffset(offset) {\n        return this.setUserData('dataOffset', offset);\n    }\n    isConfigurationLocked() {\n        return !!this.getJson().locked;\n    }\n    setIsConfigurationLocked(locked) {\n        this.getJson().locked = locked;\n    }\n    toggleConfigurationLock() {\n        let json = this.getJson();\n        json.locked = !json.locked;\n    }\n    isPendingDataLoad() {\n        if (this._dataLoadFailed) {\n            return false;\n        }\n        if (this.isCorrupted()) {\n            return false;\n        }\n        if (this._vizData && this._vizData.length > 0) {\n            return false;\n        }\n        let answerSheet = this._answerModel.getCurrentAnswerSheet(), vizId = this._referencingVizModel ? this._referencingVizModel.getId() : this.getId();\n        return !answerSheet.hasDataForViz(vizId);\n    }\n    didDataLoadFail() {\n        return this._dataLoadFailed;\n    }\n    setDataLoadFailed(dataLoadFailed) {\n        this._dataLoadFailed = !!dataLoadFailed;\n    }\n    getPermission() {\n        let permission = this.getContainingAnswerModel().getPermission();\n        if (this.isPinboardViz()) {\n            let pinboardAnswerModel = this.getReferencingViz().getContainingPinboard();\n            let referencedAnswerBookId = this.getReferencingViz().getReferencedAnswerBookId();\n            permission = pinboardAnswerModel.getPermission();\n            // Get the permission object of the answer model corresponding to the current viz.\n            permission = permission.getAnswerDocumentPermission(referencedAnswerBookId);\n        }\n        return permission;\n    }\n    isMissingUnderlyingDataAccess() {\n        let permission = this.getPermission();\n        return !permission || permission.isMissingUnderlyingAccess();\n    }\n    hasNoAccessToColumn() {\n        if (!this.isPinboardViz()) {\n            return;\n        }\n        let refVizId = this.getReferencingViz().getReferencedAnswerBookId();\n        if (!refVizId) {\n            return;\n        }\n        let pinboardAnswerModel = this.getReferencingViz().getContainingPinboard();\n        let permission = pinboardAnswerModel.getPermission();\n        let answerDocumentPermissions = permission.getAnswerDocumentPermission(refVizId);\n        if (!answerDocumentPermissions) {\n            this._logger.error('No answer document permission found');\n            return false;\n        }\n        return answerDocumentPermissions.hasNoAccessPermission();\n    }\n    getMatchingFilterModel(column) {\n        if (!this._answerModel || !column) {\n            return null;\n        }\n        let answerSheet = this._answerModel.getCurrentAnswerSheet();\n        return answerSheet.getFilterModelByColumn(column);\n    }\n    getModifiedTimestamp() {\n        return this._vizJson && this._vizJson.header.modified;\n    }\n    isOlderComparedTo(otherVizModel) {\n        if (!otherVizModel) {\n            return false;\n        }\n        return this.getModifiedTimestamp() < otherVizModel.getModifiedTimestamp();\n    }\n    /**\n     * Returns if the viz belongs to a pinboard.\n     * @return {Boolean}\n     */\n    isPinboardViz() {\n        return !!this._referencingVizModel;\n    }\n    getTotalRowCount() {\n        if (!this._vizData) {\n            return 0;\n        }\n        return this._vizData.totalRowCount;\n    }\n    hasNoData() {\n        return this.getTotalRowCount() === 0;\n    }\n    getSamplingRatio() {\n        if (!this._vizData) {\n            return null;\n        }\n        return this._vizData.samplingRatio;\n    }\n    getCompletionRatio() {\n        if (!this._vizData) {\n            return null;\n        }\n        return this._vizData.completionRatio;\n    }\n    allowsFormulaAddition() {\n        return false;\n    }\n    getMetricsForSampledData() {\n        let totalRowsDisplayed = '1000', totalRowCount = '1000+', showSampledMesg = false;\n        if (this.getTotalRowCount() > 1000) {\n            showSampledMesg = true;\n        }\n        else {\n            totalRowCount = totalRowsDisplayed = this.getTotalRowCount().toString();\n        }\n        if (this.getSamplingRatio() < 1 || this.getCompletionRatio() < 1) {\n            totalRowCount = 'many';\n            showSampledMesg = true;\n        }\n        if (showSampledMesg) {\n            return {\n                totalRowCount: totalRowCount,\n                totalRowsDisplayed: totalRowsDisplayed\n            };\n        }\n        else {\n            return {};\n        }\n    }\n    isGenericViz() {\n        return false;\n    }\n    getBatchSize() {\n        return this._dataBatchSize;\n    }\n    setBatchSize(value) {\n        this._dataBatchSize = value;\n    }\n    getSchemaVersion() {\n        let vizContent = this._vizJson[jsonConstants.VIZ_CONTENT_KEY];\n        return !!vizContent ? vizContent[jsonConstants.SCHEMA_VERSION] : '0.0';\n    }\n    getRelatedLinksCount() {\n        if (!this.isPinboardViz()) {\n            return 0;\n        }\n        let ref = this.getReferencingViz();\n        if (!ref) {\n            return 0;\n        }\n        let relatedLinks = ref._vizJson[jsonConstants.relatedLink.RELATED_LINKS];\n        return relatedLinks.length;\n    }\n    shouldIgnoreRendering() {\n        return this.ignoreRendering;\n    }\n    setIgnoreRendering() {\n        this.ignoreRendering = true;\n    }\n    getReferencedVizIds() {\n        return [];\n    }\n    allowAnalysis() {\n        return !!this.getQuestion();\n    }\n    isQuerySame(vizModel) {\n        let currentContext = this.getQuestion().getContext();\n        let currentContextIndex = this.getQuestion().getContextIndex();\n        let currentHashKey = getHashKey(currentContext, currentContextIndex);\n        let newContext = vizModel.getQuestion().getContext();\n        let newContextIndex = vizModel.getQuestion().getContextIndex();\n        let newHashKey = getHashKey(newContext, newContextIndex);\n        return currentHashKey === newHashKey;\n    }\n    isClientStateSame(vizModel, ignoredKeys = []) {\n        let ignoredKeyMap = ignoredKeys.reduce((obj, key) => {\n            obj[key] = true;\n            return obj;\n        }, {});\n        // Here we want to handle the ignoredKeys, when the key name matches\n        // ignorable key then we just return true in the comparator.\n        // In the case where we return undefined the recursive check will continue.\n        return util.isEqualWith(this.getClientState(), vizModel.getClientState(), (val1, val2, key) => {\n            return ignoredKeyMap[key];\n        });\n    }\n    isColumnMetricsDefinitionSame(vizModel) {\n        let newVizColumns = vizModel.getVizColumns();\n        return this.getVizColumns().every((vizCol, idx) => {\n            let oldMetrics = JSON.stringify(vizCol.getMetricsDefinition());\n            let newMetrics = JSON.stringify(newVizColumns[idx].getMetricsDefinition());\n            return oldMetrics === newMetrics;\n        });\n    }\n    setIsPBDDViz(state) {\n        this.isPBDDViz = state;\n    }\n    getIsPBDDViz() {\n        return this.isPBDDViz;\n    }\n    getReferencedLogicalTables() {\n        let question = this.getQuestion();\n        let queryContext = question.getContext();\n        let tables = queryContext.getTables() || [];\n        let tablesUsedMap = tables.reduce(function (tablesUsedMap, table) {\n            let tokens = table.getTokens() || [];\n            tokens.forEach(function (token) {\n                let tableGuid = _.get(token, 'tokenMetadata.table.guid');\n                if (!!tableGuid) {\n                    tablesUsedMap[tableGuid] = true;\n                }\n            });\n            return tablesUsedMap;\n        }, {});\n        return tablesUsedMap;\n    }\n    getLinkedColumnsForColumn(columnId) { return []; }\n    getClientState() {\n        if (!this || !this._vizJson) {\n            return null;\n        }\n        let clientState = this._vizJson.header.clientState;\n        if (!clientState) {\n            clientState = this._vizJson.header.clientState = {};\n        }\n        return clientState;\n    }\n    getVizContent() {\n        if (!this._vizJson) {\n            return null;\n        }\n        let vizContent = this._vizJson.header.vizContent;\n        if (!vizContent) {\n            vizContent = this._vizJson.header.vizContent = {};\n        }\n        return vizContent;\n    }\n};\nVisualizationModel = VisualizationModel_1 = tslib_1.__decorate([\n    Provide('VisualizationModel')\n], VisualizationModel);\nexport { VisualizationModel };\n//# sourceMappingURL=visualization-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Shashank Singh (sunny@thoughtspot.com)\n *\n * @fileoverview Model for encapsulating a corrupt visualization model\n */\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport { VisualizationModel } from './visualization-model';\nexport class CorruptVizModel extends VisualizationModel {\n    constructor(params) {\n        if (!params.vizJson) {\n            params.vizJson = {};\n        }\n        params.vizJson[jsonConstants.HEADER_KEY] = {};\n        super(params);\n    }\n    isCorrupted() {\n        return true;\n    }\n}\n//# sourceMappingURL=corrupt-viz-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2017\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview\n */\nimport { blinkConstants } from '@thoughtspot/blink-constants/blink-constants';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport _ from 'lodash';\nimport { ngRequire, Provide } from '../../../base/decorators';\nimport { getAnswerModelFromReportBook, getInsightAnswerModelFromReportBook } from '../../viz-layout/answer/answer-metadata-util';\nimport { CorruptVizModel } from '../../viz-layout/viz/corrupt-viz-model';\nlet genericVizModelFactory = ngRequire('genericVizModelFactory');\nProvide('pinboardAnswerSheetUtil')({\n    getVisualizationAnswerModels,\n    resolveReferencedGenericVisualization,\n    getPinboardLayout\n});\nfunction getVisualizationAnswerModels(objectResolver, answerModel) {\n    if (!objectResolver) {\n        return null;\n    }\n    let result = {};\n    _.forIn(objectResolver, (resolvedVizContent, id) => {\n        if (!resolvedVizContent) {\n            result[id] = new CorruptVizModel({\n                answerModel: answerModel\n            });\n            return;\n        }\n        result[id] = answerModel.isInsightPinboard && answerModel.isInsightPinboard() ?\n            getInsightAnswerModelFromReportBook(resolvedVizContent) :\n            getAnswerModelFromReportBook(resolvedVizContent);\n    });\n    return result;\n}\nfunction resolveReferencedGenericVisualization(subType, origJson, answerModel) {\n    return genericVizModelFactory.createGenericVizModel(subType, {\n        vizJson: origJson,\n        answerModel: answerModel\n    });\n}\n/**\n * Checks whether a certain viz is in the layout array\n * @param {Object} layout   The layout array\n * @param {string} vizId    The id of the viz\n * @return {boolean | undefined}\n */\nfunction vizIsInLayout(layout, vizId) {\n    if (!vizId) {\n        return false;\n    }\n    let matchIndex = _.findIndex(layout, (tile) => {\n        return tile[jsonConstants.ID_KEY] === vizId;\n    });\n    return matchIndex > -1;\n}\nfunction getPinboardLayout(originalLayout, visualizationMap, visualizationArray, flattenClusters, applyInsightsStyle, defaultTileSize) {\n    // Create layout tiles of vizs that dont have layout tiles.\n    visualizationArray.forEach((viz) => {\n        let vizId = viz.getId();\n        if (!vizIsInLayout(originalLayout, vizId)) {\n            let layoutItem = {\n                id: vizId\n            };\n            originalLayout.push(layoutItem);\n        }\n    });\n    // Clean up the layout definition for stale definitions.\n    // Filter the layout array to remove any viz that is not in the visualizations object\n    let layout = originalLayout.filter(function (item) {\n        let id = item[jsonConstants.ID_KEY];\n        if (!id) {\n            throw new Error('Invalid layout description in answersheet');\n        }\n        return visualizationMap.hasOwnProperty(id);\n    });\n    // Ids of pinboard vizs which are part on any cluster.\n    let vizsInClusters = {};\n    let filterVizs = {};\n    // Ids of pinboard vizs which refer to cluster viz.\n    let clusterVizIds = {};\n    _.forIn(visualizationMap, (viz) => {\n        let referencedViz = viz.getReferencedVisualization();\n        if (referencedViz.getVizType() === jsonConstants.VIZ_TYPE_CLUSTER) {\n            clusterVizIds[viz.getId()] = true;\n            let refVizIds = referencedViz.getReferencedVizIds();\n            refVizIds.forEach(function (id) {\n                vizsInClusters[id] = true;\n            });\n        }\n        if (referencedViz.getVizType() === jsonConstants.vizType.FILTER) {\n            let id = viz.getId();\n            filterVizs[id] = true;\n        }\n    });\n    layout = layout.filter(function (item) {\n        return !filterVizs[item.id];\n    });\n    // Handle the flattening of clusters.\n    if (flattenClusters) {\n        layout = layout.filter(function (item) {\n            return !clusterVizIds[item.id];\n        });\n    }\n    else {\n        // NOTE: We operate under the assumption that a viz will have only\n        // one manifestation.\n        // Eg 1: Viz part of a cluster will not show as a individual viz on\n        // pinboard.\n        // Eg 2: Same viz will not be part of multiple clusters.\n        layout = layout.filter(function (item) {\n            return !vizsInClusters[item.id];\n        });\n    }\n    // TODO(Jasmeet): This logic needs to be moved to backend.\n    // The intent here is to make first 2 unclustered tiles as large tiles\n    // and also mark all clustered vizs as large tile. All remaining tiles\n    // take the medium size by default.\n    if (applyInsightsStyle) {\n        let tileIndexWithSavedSize = _.findIndex(layout, (tile) => {\n            return !!tile.size || !_.isNil(tile.order);\n        });\n        let hasUserAppliedStyle = tileIndexWithSavedSize > -1;\n        if (!hasUserAppliedStyle) {\n            layout.forEach((item, idx) => {\n                let id = item[jsonConstants.ID_KEY];\n                let increaseSize = false;\n                if (clusterVizIds[id]) {\n                    increaseSize = true;\n                }\n                if (increaseSize) {\n                    item.size = blinkConstants.tileSizes.EXTRA_LARGE;\n                }\n                item.order = idx;\n            });\n        }\n    }\n    function getDefaultTileSize(pinboardVizModel) {\n        let vizModel = pinboardVizModel.getReferencedVisualization();\n        let vizType = vizModel.getVizType();\n        switch (vizType) {\n            case jsonConstants.vizType.HEADLINE:\n                return blinkConstants.tileSizes.EXTRA_SMALL;\n            case jsonConstants.vizType.TABLE:\n                return blinkConstants.tileSizes.LARGE;\n            default:\n                return blinkConstants.tileSizes.MEDIUM;\n        }\n    }\n    layout.forEach((tile) => {\n        if (_.isNil(tile.size)) {\n            tile.size = !!defaultTileSize\n                ? defaultTileSize\n                : getDefaultTileSize(visualizationMap[tile.id]);\n        }\n    });\n    return layout;\n}\nexport { getVisualizationAnswerModels, resolveReferencedGenericVisualization, getPinboardLayout };\n//# sourceMappingURL=pinboard-answer-sheet-util.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview This is the base class for all search pages.\n */\nimport { UIComponent } from '../../base/base-types/ui-component';\nimport { Provide } from '../../base/decorators';\nexport var AnswerDisplayMode;\n(function (AnswerDisplayMode) {\n    AnswerDisplayMode[\"TABLE\"] = \"TABLE-MODE\";\n    AnswerDisplayMode[\"CHART\"] = \"CHART-MODE\";\n    AnswerDisplayMode[\"R_ANALYSIS\"] = \"R-ANALYSIS-MODE\";\n})(AnswerDisplayMode || (AnswerDisplayMode = {}));\nexport class BaseAnswerComponent extends UIComponent {\n    constructor() {\n        super();\n    }\n    getAnswerModel() {\n        return this._answerModel;\n    }\n}\nProvide('BaseAnswer')({\n    AnswerDisplayMode: AnswerDisplayMode\n});\n//# sourceMappingURL=base-answer.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Model for representing data result set.\n */\nimport * as tslib_1 from \"tslib\";\nimport { Provide } from '../../../base/decorators';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nlet QueryData = class QueryData {\n    constructor(infoJson) {\n        this.info = infoJson;\n        this.data = this.info[jsonConstants.queryInfo.DATA];\n    }\n    getData() {\n        return this.data;\n    }\n};\nQueryData = tslib_1.__decorate([\n    Provide('QueryData')\n], QueryData);\nexport { QueryData };\n//# sourceMappingURL=query-data.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview This service exposes functionality to get best axis config map per chart type\n * for a given chart Model\n */\n'use strict';\nimport { Provide } from '../../../../base/decorators';\nimport { chartTypes, computeBestChartAxisConfig } from './chart-type-specification-service';\nexport function computeChartTypesToBestAxisConfigMap(chartModel) {\n    return Object.keys(chartTypes)\n        .reduce((bestAxisColumnConfigForChartType, chartType) => {\n        let bestConfig = computeBestChartAxisConfig(chartType, chartModel);\n        if (!!bestConfig) {\n            bestAxisColumnConfigForChartType[chartType] = bestConfig;\n        }\n        return bestAxisColumnConfigForChartType;\n    }, {});\n}\nProvide('bestChartAxisConfigService')({\n    computeChartTypesToBestAxisConfigMap\n});\n//# sourceMappingURL=best-chart-axis-config-service.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Provides a service that maps callosum chart axis config to\n * UI axis config and vice versa.\n */\n'use strict';\nimport { create } from '@thoughtspot/logger';\nimport _ from 'lodash';\nimport { Provide } from '../../../../base/decorators';\nimport { getQueriesDefinitions, getUniqueIdForVizCol, setQueriesDefinition } from './chart-type-specification-service';\nimport * as chartUtilService from './chart-util-service';\nlet logger;\nProvide('chartAxisConfigMappingService')({\n    setBackendConfiguration,\n    getBackendConfiguration\n});\nexport function setBackendConfiguration(chartModel, axisConfig) {\n    if (!logger) {\n        logger = create('chart-axis-config-mapping-service');\n    }\n    // clear axis state on all columns\n    let allColumns = chartModel.getColumns();\n    allColumns.forEach((column) => chartUtilService.setChartAxisInClientState(column, chartUtilService.ChartAxis.NONE));\n    axisConfig.xAxisColumns.forEach((column) => chartUtilService.setChartAxisInClientState(column, chartUtilService.ChartAxis.X));\n    axisConfig.yAxisColumns.forEach((column) => chartUtilService.setChartAxisInClientState(column, chartUtilService.ChartAxis.Y));\n    axisConfig.legendColumns.forEach((column) => chartUtilService.setChartAxisInClientState(column, chartUtilService.ChartAxis.Z));\n    if (axisConfig.radialColumn) {\n        chartUtilService.setChartAxisInClientState(axisConfig.radialColumn, chartUtilService.ChartAxis.R);\n    }\n    // define base query\n    setQueriesDefinition(axisConfig, chartModel);\n}\nexport function getBackendConfiguration(chartModel) {\n    if (!logger) {\n        logger = create('chart-axis-config-mapping-service');\n    }\n    let chartJson = chartModel.getJson(), configurations = {\n        [chartUtilService.ChartAxis.X]: {},\n        [chartUtilService.ChartAxis.Y]: {},\n        [chartUtilService.ChartAxis.Z]: {},\n        [chartUtilService.ChartAxis.R]: null,\n        columnsInChartDataNotOnAnyAxis: {},\n        allColumns: {}\n    }, queryDefinitions = getQueriesDefinitions(chartModel, chartJson.chartConfigurations ? chartJson.chartConfigurations : []);\n    queryDefinitions.forEach((queryDefn) => {\n        queryDefn.getColumnsInDataOrder().forEach((column) => {\n            const uniqueIdForVizCol = getUniqueIdForVizCol(column);\n            configurations.allColumns[uniqueIdForVizCol] = column;\n            let axisClientState = chartUtilService.getChartAxisFromClientState(column);\n            switch (axisClientState) {\n                case chartUtilService.ChartAxis.X:\n                case chartUtilService.ChartAxis.Y:\n                case chartUtilService.ChartAxis.Z:\n                    configurations[axisClientState][uniqueIdForVizCol] = column;\n                    break;\n                case chartUtilService.ChartAxis.R: // that would be nice if we can have an array\n                    configurations['r'] = column; // TS complain otherwise\n                    break;\n                // NOTE: This condition here allows default to go to hidden to\n                // support backward compatibility.\n                default:\n                    configurations.columnsInChartDataNotOnAnyAxis[uniqueIdForVizCol] = column;\n                    break;\n            }\n        });\n    });\n    let backendConfigurations = {\n        allColumns: _.values(configurations.allColumns),\n        xAxisColumns: _.values(configurations[chartUtilService.ChartAxis.X]),\n        yAxisColumns: _.values(configurations[chartUtilService.ChartAxis.Y]),\n        legendColumns: _.values(configurations[chartUtilService.ChartAxis.Z]),\n        radialColumn: configurations['r'],\n        columnsInChartDataNotOnAnyAxis: _.values(configurations.columnsInChartDataNotOnAnyAxis),\n        queryDefinitions\n    };\n    let hasNoXandYColumns = backendConfigurations.xAxisColumns.length === 0 &&\n        backendConfigurations.yAxisColumns.length === 0;\n    // This is a fail safe logic in cases where the axis config is not available on server.\n    // We also check chartType here as whenever chart type is set in model the axis\n    // configuration should be set. Otherwise in case of adhoc answer we dont want to set\n    // the x and y with fail safe logic. We will defer this logic to chart viz.\n    if (hasNoXandYColumns && !!chartModel.chartType) {\n        backendConfigurations.chartModel = chartModel;\n        backendConfigurations.chartModel.setIsMissingAxisConfigurationDetail(true);\n    }\n    return backendConfigurations;\n}\n//# sourceMappingURL=chart-axis-config-mapping-service.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015-2016\n * Author: Sagar Patni\n *\n * @fileoverview Library containing logic for commonly used data operations.\n */\n'use strict';\nexport class VarianceCalculator {\n    constructor() {\n        this.n = 0;\n        this.mean = 0;\n        this.m2 = 0;\n    }\n    add(val) {\n        this.n++;\n        let delta = val - this.mean;\n        this.mean = this.mean + delta / this.n;\n        this.m2 = this.m2 + delta * (val - this.mean);\n    }\n    getVariance() {\n        return this.n <= 1 ? 0 : this.m2 / (this.n - 1);\n    }\n    getMean() {\n        return this.mean;\n    }\n    // TODO(sunny): co-efficient of variation does not make sense as a measure of spread of data\n    // if the data has negative values (http:// stats.stackexchange.com/q/56399)\n    getCoefficientOfVariation() {\n        let variance = this.getVariance();\n        return variance === 0 ? 0 : Math.abs(variance / this.getMean());\n    }\n}\n//# sourceMappingURL=blink-statistics-library.js.map","/**\n * Copyright Thoughtspot Inc. 2016\n * Author:  francois.chabbey (francois.chabbey@thoughtspot.com)\n *\n * @fileoverview: The Data model for the Dx table component\n */\nimport { create } from '@thoughtspot/logger';\nimport { ngRequire } from '../../../../base/decorators';\nimport { aggregateTypes } from '../../../../base/enums/aggregateTypes';\nimport * as chartUtilService from '../chart/chart-util-service';\nimport { ChartDataModel } from '../chart/highcharts/highchart-data-model';\n//Note(chab) we are not importing ChartModel as it will cause tests to fail\nlet util = ngRequire('util');\nexport class BaseTableDataModel extends ChartDataModel {\n    constructor(chartModel) {\n        super();\n        this.chartModel = chartModel;\n        this._columnIdToColumn = {};\n        // _columnNameToColumn - Unique column name to Column object map needed in pivot component\n        this._columnNameToColumn = {};\n        // _colIdToUniqueName - Map Col GUID to Unique name using\n        // chartUtilService.getColumnIdToDisambiguatedName\n        this._colIdToUniqueName = {};\n        this.logger = create('dx-table-data-model');\n        //Note(chab) hack for preventing unit test to fail\n        BaseTableDataModel.blinkAggTypesToPivotAggTypes = {\n            [aggregateTypes.SUM]: 'sum',\n            // For local aggregations, count is like sum.\n            [aggregateTypes.COUNT]: 'sum',\n            [aggregateTypes.COUNT_DISTINCT]: 'sum',\n            [aggregateTypes.AVERAGE]: 'avg',\n            [aggregateTypes.MIN]: 'min',\n            [aggregateTypes.MAX]: 'max'\n        };\n        this.parseDefinitions(chartModel);\n        if (chartModel.getVisualizedColumns().length === 0) {\n            this._data = [];\n        }\n        else {\n            this.processData(chartModel);\n        }\n    }\n    get hasNoData() {\n        return this._count === 0;\n    }\n    get hasMoreData() {\n        return this.chartModel.hasMoreData();\n    }\n    get count() {\n        return this._count;\n    }\n    get data() {\n        return this._data;\n    }\n    get columns() {\n        return this._columns;\n    }\n    get columnIdToColumn() {\n        return this._columnIdToColumn;\n    }\n    get columnNameToColumn() {\n        return this._columnNameToColumn;\n    }\n    getColumnById(id) {\n        let column = this._columnIdToColumn[id];\n        if (!column && id) {\n            this.logger.error('unknown column', id);\n        }\n        return column;\n    }\n    columnCanContainsLink(id) {\n        let column = this.getColumnById(id);\n        return (column && column.isAttribute() && column.isEffectivelyNonNumeric());\n    }\n    getEffectiveAggrType(col) {\n        let aggType = col.getTrueEffectiveAggregateType();\n        return BaseTableDataModel.blinkAggTypesToPivotAggTypes[aggType];\n    }\n    getDataRowAttribute(data) {\n        let specialFormat = util.getSpecialFormatData(data);\n        data = (!!specialFormat)\n            ? specialFormat\n            : data + '';\n        return data;\n    }\n    parseDefinitions(chartModel) {\n        this.buildColumnMaps(chartModel);\n    }\n    processData(chartModel) {\n        let dataArray = chartModel.getDataArray();\n        if (!dataArray) {\n            return;\n        }\n        let data = dataArray[0].getData();\n        if (!data) {\n            return;\n        }\n        this._dataRowIndexToColumn = chartModel.getVisualizedColumns()\n            .reduce((dataRowIndexToColumn, column) => {\n            dataRowIndexToColumn[column.getDataRowIndex()] = column;\n            return dataRowIndexToColumn;\n        }, {});\n        this._data = data.map((dataRow) => {\n            return this.getDataRow(chartModel, dataRow);\n        });\n        this._count = this._data.length;\n    }\n    buildColumnMaps(chartModel) {\n        this._colIdToUniqueName = chartUtilService.getColumnIdToDisambiguatedName(chartModel.getVizColumns(), true);\n        this._columnIdToColumn = chartModel.getVizColumns().reduce((map, col) => {\n            let name = col.getId();\n            map[name] = col;\n            this._columnNameToColumn[this._colIdToUniqueName[name]] = col;\n            return map;\n        }, {});\n    }\n    getDataRow(chartModel, dataRow) {\n        return dataRow.reduce((row, data, idx) => {\n            let column = this._dataRowIndexToColumn[idx];\n            let colId = column.getId();\n            let isColAttr = chartModel.isColAttribute(column);\n            if (this.getDataRowMeasureAndAttribute) {\n                data = this.getDataRowMeasureAndAttribute(data, colId, this.getDataRowAttribute, isColAttr);\n            }\n            row[colId] = data;\n            return row;\n        }, {});\n    }\n}\n//# sourceMappingURL=dx-table-data-model.js.map","/**\n * Copyright Thoughtspot Inc. 2016\n * Author:  ashish.shubam (ashish.shubham@thoughtspot.com)\n *\n * @fileoverview: Utility methods for dx widget\n */\nimport _ from 'lodash';\nimport { blinkConstants } from '@thoughtspot/blink-constants/blink-constants';\nimport { strings } from '../../../../base/strings';\nconst SUPPORTED_AGGREGATIONS = new Set(['SUM', 'MAX', 'MIN', 'AVERAGE']);\n/**\n * Comparator method which is used to sort an array containing\n * both strings and numbers. The numbers come before strings.\n * @param prev {Object}\n * @param next {Object}\n * @returns {number}\n */\nexport function sortMethod(prev, next) {\n    let a = prev.value;\n    let b = next.value;\n    a = (isNaN(a)) ? a : Number.parseFloat(a);\n    b = (isNaN(b)) ? b : Number.parseFloat(b);\n    if (_.isNumber(a) && _.isNumber(b)) {\n        return a - b;\n    }\n    if (_.isString(a) && _.isString(b)) {\n        return a.localeCompare(b);\n    }\n    if (_.isNumber(a)) {\n        return -1;\n    }\n    return 1;\n}\nexport function rowColFormatter(vizCol, params, isPercent = false, noShorten = true, agg, isDouble) {\n    if (_.isUndefined(params.value)) {\n        return '';\n    }\n    let formattedVal = vizCol.getDataFormatter()(params.value, {\n        isPercent: isPercent || vizCol.isPercentColumn(),\n        isDouble: isDouble || vizCol.isDoubleColumn(),\n        noShorten,\n    });\n    if (!agg) {\n        return String(formattedVal);\n    }\n    let trueAgg = vizCol.getTrueEffectiveAggregateType();\n    if (SUPPORTED_AGGREGATIONS.has(trueAgg)) {\n        return `${vizCol.getName(false)} : ${formattedVal}`;\n    }\n    return `${strings.aggregateTypes.SUM} ${vizCol.getName(true)} : ${formattedVal}`;\n}\nexport function dataFormatter(vizCol, summaryMode, params) {\n    if (_.isUndefined(params.value)) {\n        return '';\n    }\n    // When one of the entries is NaN or Infinity, Pivot tables concatenates these as string\n    if (typeof params.value === 'string') {\n        return strings.pivotTable.UNDEFINED_RESULT;\n    }\n    let isPercent = summaryMode() && summaryMode() !== 'None';\n    //if summary mode is enabled, percent values are calculated by Blink which is double\n    return rowColFormatter(vizCol, params, isPercent, true, undefined, isPercent);\n}\nexport function getSortOrder(vizCol) {\n    if (!vizCol.isSorted()) {\n        return;\n    }\n    return vizCol.isAscendingSort()\n        ? blinkConstants.pivotTable.ascendingSort\n        : blinkConstants.pivotTable.descendingSort;\n}\n//# sourceMappingURL=dx-table-util.js.map","/**\n * Copyright Thoughtspot Inc. 2016\n * Author:  Ashish shubham (ashish.shubham@thoughtspot.com)\n *\n * @fileoverview: The Data model for the Pivot Table component.\n */\nimport * as tslib_1 from \"tslib\";\nimport { blinkConstants } from '@thoughtspot/blink-constants/blink-constants';\nimport { Provide } from '../../../../base/decorators';\nimport { BaseTableDataModel } from '../dx-table/dx-table-data-model';\nimport { dataFormatter, getSortOrder, rowColFormatter, sortMethod } from '../dx-table/dx-table-util';\nexport let areaToAxisMap = {\n    column: 'legendColumns',\n    row: 'xAxisColumns',\n    data: 'yAxisColumns'\n};\nlet PivotDataModel = class PivotDataModel extends BaseTableDataModel {\n    constructor(chartModel) {\n        super(chartModel);\n        this.getPivotSummaryMode = () => {\n            return chartModel.getPivotSummaryMode();\n        };\n    }\n    get rows() {\n        return this._rows;\n    }\n    get measures() {\n        return this._measures;\n    }\n    getPivotDataSource() {\n        return {\n            fields: this.getFields(),\n            store: this._data\n        };\n    }\n    min(di) {\n        return this._min[di];\n    }\n    max(di) {\n        return this._max[di];\n    }\n    unsetCustomizeText(dataSource) {\n        this._measures.forEach(measureCol => {\n            delete dataSource.field(measureCol.getId()).customizeText;\n        });\n    }\n    setCustomizeText(dataSource) {\n        let self = this;\n        this._measures.forEach(measureCol => {\n            let fOpts = dataSource.field(measureCol.getId());\n            fOpts.customizeText = dataFormatter.bind(self, measureCol, self.getPivotSummaryMode);\n            dataSource.field(measureCol.getId(), fOpts);\n        });\n    }\n    getFields() {\n        let sortField;\n        let summarySortOrder;\n        let self = this;\n        this._measures.forEach((measureCol) => {\n            if (measureCol.isSorted()) {\n                sortField = measureCol.getId(true);\n                summarySortOrder = getSortOrder(measureCol);\n            }\n        });\n        let columns = this._columns.map(col => {\n            return {\n                dataField: col.getId(),\n                area: blinkConstants.pivotTable.Areas.COLUMN,\n                isMeasure: col.isEffectivelyNumeric(),\n                // Using correct caption means no remapping needed after pivot table is displayed\n                caption: col.getTitle() || self._colIdToUniqueName[col.getId()],\n                customizeText: rowColFormatter.bind(self, col),\n                sortBySummaryField: sortField,\n                sortBy: 'value',\n                sortingMethod: sortMethod,\n                sortOrder: getSortOrder(col) || summarySortOrder\n            };\n        });\n        let rows = this._rows.map(col => {\n            return {\n                dataField: col.getId(),\n                area: blinkConstants.pivotTable.Areas.ROW,\n                isMeasure: col.isEffectivelyNumeric(),\n                // Using correct caption means no remapping needed after pivot table is displayed\n                caption: col.getTitle() || self._colIdToUniqueName[col.getId()],\n                customizeText: rowColFormatter.bind(self, col),\n                sortBySummaryField: sortField,\n                sortBy: 'value',\n                sortingMethod: sortMethod,\n                sortOrder: getSortOrder(col) || summarySortOrder\n            };\n        });\n        let measures = this._measures.map(col => {\n            return {\n                dataField: col.getId(),\n                area: blinkConstants.pivotTable.Areas.DATA,\n                isMeasure: col.isEffectivelyNumeric(),\n                // Using correct caption means no remapping needed after pivot table is displayed\n                caption: col.getTitle() || self._colIdToUniqueName[col.getId()],\n                summaryType: self.getEffectiveAggrType(col),\n                summaryDisplayMode: self.getPivotSummaryMode(),\n                dataType: 'number',\n                customizeText: dataFormatter.bind(self, col, self.getPivotSummaryMode)\n            };\n        });\n        return [].concat(columns).concat(rows).concat(measures);\n    }\n    parseAxisConfig(axisConfig) {\n        this._min = {};\n        this._max = {};\n        this._rows = axisConfig[areaToAxisMap.row];\n        this._columns = axisConfig[areaToAxisMap.column];\n        this._measures = axisConfig[areaToAxisMap.data];\n    }\n    getDataRowMeasureAndAttribute(data, colId, getDataRowAttribute, isColAttr) {\n        data = this.columnIdToColumn[colId].convertValueFromBackend(data);\n        if (isColAttr) {\n            data = getDataRowAttribute(data);\n        }\n        this.updateMinMax(data, colId);\n        return data;\n    }\n    parseDefinitions(chartModel) {\n        this.parseAxisConfig(chartModel.getAxisConfig());\n        super.parseDefinitions(chartModel);\n    }\n    updateMinMax(data, colId) {\n        this._min[colId] = (!this._min[colId] || data < this._min[colId]) ? data : this._min[colId];\n        this._max[colId] = (!this._max[colId] || data > this._max[colId]) ? data : this._max[colId];\n    }\n};\nPivotDataModel = tslib_1.__decorate([\n    Provide('PivotDataModel')\n], PivotDataModel);\nexport { PivotDataModel };\n//# sourceMappingURL=pivot-data-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Service to process Data for the chart.\n */\nimport _ from 'lodash';\nimport { create } from '@thoughtspot/logger';\nimport { VarianceCalculator } from '../../../../base/blink-statistics-library';\nimport { VisualizationColumnModel } from '../../../callosum/model/visualization-column';\nimport { PivotDataModel } from '../pivot/pivot-data-model';\nimport { chartProviders, getChartProvider } from './chart-type-specification-service';\nimport { HighchartDataModel } from './highcharts/highchart-data-model';\nimport { NetworkChartDataModel } from './networks/network-chart-data-model';\nexport { computeMetaDataInformation, getDataModel };\nfunction computeMetaDataInformation(chartModel) {\n    create('chart-data-processor');\n    let colCardinality = {};\n    let timeSeriesColumns = chartModel.getTimeSeriesColumns(), chartedAsAttributeColumns = _.difference(chartModel.getAttributeColumns(), timeSeriesColumns);\n    chartedAsAttributeColumns.forEach(function (col) {\n        let colId = col.getId();\n        colCardinality[colId] = col.getUniqueCount() || -1;\n    });\n    if (chartModel.hasNoData()) {\n        return {\n            colCardinality: colCardinality\n        };\n    }\n    let definition = chartModel.getJson(), measureColumns = [], attributeColumns = [], dataRowIndex = 0;\n    [definition.series, definition.categories, definition.values]\n        .forEach(function (bucket) {\n        if (!bucket || !bucket.columns || !bucket.columns.length) {\n            return;\n        }\n        bucket.columns.forEach(function (columnJson) {\n            if (!columnJson || !Object.keys(columnJson).length) {\n                return false;\n            }\n            let idx = dataRowIndex++;\n            let column = new VisualizationColumnModel(columnJson, idx, null, chartModel.getColumnData(idx));\n            if (column.isEffectivelyNumeric()) {\n                measureColumns.push(column);\n            }\n            else {\n                attributeColumns.push(column);\n            }\n        });\n    });\n    let columnIdToMin = {}, columnIdToMax = {}, columnIdToUniques = {}, dataRowIndexToAttributeColId = {}, dataRowIndexToMeasureColId = {}, measureColIdToVarianceCalculator = {};\n    attributeColumns.forEach(function (col) {\n        let colId = col.getId(), dataRowIndex = col.getDataRowIndex();\n        dataRowIndexToAttributeColId[dataRowIndex] = colId;\n        columnIdToUniques[colId] = {};\n    });\n    measureColumns.forEach(function (col) {\n        let colId = col.getId(), dataRowIndex = col.getDataRowIndex();\n        columnIdToUniques[colId] = {};\n        columnIdToMin[colId] = Number.POSITIVE_INFINITY;\n        columnIdToMax[colId] = Number.NEGATIVE_INFINITY;\n        dataRowIndexToMeasureColId[dataRowIndex] = colId;\n        measureColIdToVarianceCalculator[colId] = new VarianceCalculator();\n    });\n    let attributeDataRowIndices = Object.keys(dataRowIndexToAttributeColId), measureDataRowIndices = Object.keys(dataRowIndexToMeasureColId);\n    let chartData = chartModel.getDataArray()[0].getData();\n    let i = chartData.length;\n    while (i--) {\n        let dataRow = chartData[i], dataRowLength = dataRow.length;\n        let value, colId, colUniques;\n        let j = attributeDataRowIndices.length;\n        while (j--) {\n            dataRowIndex = Number(attributeDataRowIndices[j]);\n            if (dataRowIndex < dataRowLength) {\n                value = dataRow[dataRowIndex];\n                colId = dataRowIndexToAttributeColId[dataRowIndex];\n                colUniques = columnIdToUniques[colId];\n                if (!colUniques.hasOwnProperty(value)) {\n                    colUniques[value] = 1;\n                }\n            }\n        }\n        j = measureDataRowIndices.length;\n        while (j--) {\n            dataRowIndex = Number(measureDataRowIndices[j]);\n            if (dataRowIndex < dataRowLength) {\n                value = dataRow[dataRowIndex];\n                if (!isNaN(value)) {\n                    colId = dataRowIndexToMeasureColId[dataRowIndex];\n                    // update min/max for the column\n                    columnIdToMin[colId] = Math.min(value, columnIdToMin[colId]);\n                    columnIdToMax[colId] = Math.max(value, columnIdToMax[colId]);\n                    measureColIdToVarianceCalculator[colId].add(value);\n                }\n                // for measures we include NaN values in uniques as well since at this point we\n                // don't have the information about whether a given measure column can allow nulls.\n                // this is because whether a column allows nulls can depend on the axis it is on\n                // (which is not decided yet). We err on the side of over counting cardinality.\n                colUniques = columnIdToUniques[colId];\n                if (colUniques && !colUniques.hasOwnProperty(value)) {\n                    colUniques[value] = 1;\n                }\n            }\n        }\n    }\n    return {\n        columnIdToMin: columnIdToMin,\n        columnIdToMax: columnIdToMax,\n        columnIdToUniques: columnIdToUniques,\n        colCardinality: colCardinality,\n        dataRowIndexToAttributeColId: dataRowIndexToAttributeColId,\n        dataRowIndexToMeasureColId: dataRowIndexToMeasureColId\n    };\n}\nfunction getChartProviderToDataModel() {\n    return {\n        [chartProviders.HIGHCHART]: HighchartDataModel,\n        [chartProviders.GEO_MAP]: HighchartDataModel,\n        [chartProviders.GEO_EARTH]: HighchartDataModel,\n        [chartProviders.PIVOT_TABLE]: PivotDataModel,\n        [chartProviders.NETWORK]: NetworkChartDataModel\n    };\n}\nfunction getDataModel(chartModel) {\n    let chartType = chartModel.getChartType();\n    let chartProvider = getChartProvider(chartType) || chartProviders.HIGHCHART;\n    let chartProviderToDataModel = getChartProviderToDataModel();\n    return new chartProviderToDataModel[chartProvider](chartModel);\n}\n//# sourceMappingURL=chart-data-processor-service.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015-2017\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n * Francois Chabbey(francois.chabbey@thoughtspot.com)\n *\n * @fileoverview Provides api abstraction for persistence of chart related information\n * in session store; this can be extended in future to allow persistence\n *\n * in local store on clients.\n */\n'use strict';\n// TODO(Jasmeet): This doesnt really need persistence and can be in memory.\nimport _ from 'lodash';\nimport { Provide } from '../../../../base/decorators';\nimport { sessionStore } from '../../../../base/web-storage';\nimport { ChartAxisConfig } from './chart-axis-config';\nlet columnEffectiveIdGetter = column => column.getId();\nexport function getConfig(key) {\n    let config = sessionStore.getItem(key);\n    return !config ? null : config;\n}\nexport function persistChartTypeAndAxisConfig(chartModel) {\n    if (chartModel.isPinboardViz()) {\n        return;\n    }\n    let key = chartModel.getId(), chartType = chartModel.getChartType(), xAxisColumnIds = chartModel.getXAxisColumns().map(columnEffectiveIdGetter), yAxisColumnIds = chartModel.getYAxisColumns().map(columnEffectiveIdGetter), legendColumnIds = chartModel.getLegendColumns().map(columnEffectiveIdGetter), allColumnIds = chartModel.getColumns().map(columnEffectiveIdGetter), radialColumn = chartModel.getRadialColumn();\n    let radialColumnIds = (radialColumn)\n        ? [columnEffectiveIdGetter(radialColumn)]\n        : [];\n    let visualizedColumnIdsAndAxis = getVisualizedColumnIdsAndAxis(xAxisColumnIds, yAxisColumnIds, legendColumnIds, radialColumnIds);\n    let storeEntry = {\n        xAxisColumnIds,\n        yAxisColumnIds,\n        legendColumnIds,\n        radialColumnIds,\n        chartType,\n        allColumnIds,\n        visualizedColumnIdsAndAxis\n    };\n    sessionStore.setItem(key, storeEntry);\n}\nfunction getVisualizedColumnIdsAndAxis(xAxisColumnIds, yAxisColumnIds, legendColumnIds, radialColumnIds) {\n    let columnIdsByAxis = {\n        xAxisColumnIds,\n        yAxisColumnIds,\n        legendColumnIds,\n        radialColumnIds\n    };\n    return Object.keys(columnIdsByAxis)\n        .reduce((visualizedColumnIdsAndAxis, axisName) => {\n        columnIdsByAxis[axisName].forEach(c => visualizedColumnIdsAndAxis[c] = axisName);\n        return visualizedColumnIdsAndAxis;\n    }, {});\n}\nexport function generateMatchingConfig(axisIdsConfig, allColumnsMap) {\n    let matchingXColumns = axisIdsConfig.xAxisColumnIds.map(id => allColumnsMap[id]);\n    let matchingYColumns = axisIdsConfig.yAxisColumnIds.map(id => allColumnsMap[id]);\n    let matchingLegendColumns = axisIdsConfig.legendColumnIds.map(id => allColumnsMap[id]);\n    let matchingRadialColumns = axisIdsConfig.radialColumnIds.map(id => allColumnsMap[id]);\n    return new ChartAxisConfig(_.compact(matchingXColumns), _.compact(matchingYColumns), _.compact(matchingLegendColumns), matchingRadialColumns[0]);\n}\nProvide('chartPersistedStore')({\n    getConfig,\n    persistChartTypeAndAxisConfig,\n    generateMatchingConfig\n});\n//# sourceMappingURL=chart-persisted-store.js.map","import _ from 'lodash';\nimport { computeChartTypesToBestAxisConfigMap } from './best-chart-axis-config-service';\nimport { generateMatchingConfig, getConfig } from './chart-persisted-store';\nimport * as chartTypeSpecificationService from './chart-type-specification-service';\nimport { flags } from '../../../../base/flags';\nlet columnEffectiveIdGetter = function (column) {\n    return column.getId();\n};\n// This function checks if this is a modification to the chart visualization user was viewing\n// and all columns in the chart are the exact same.\n// In this case we would like to retain the config user was viewing before the transformation.\nfunction checkIfAllColumnsChangedAndReturnConfig(chartModel) {\n    // if the new answer has exactly same columns we retreive last viewed config.\n    let previousConfig = getConfig(chartModel.getId());\n    if (!previousConfig) {\n        return null;\n    }\n    let allColumns = chartModel.getColumns();\n    if (!allColumns || !allColumns.length) {\n        return null;\n    }\n    if (previousConfig.allColumnIds.length !== allColumns.length) {\n        return null;\n    }\n    let allColumnIds = allColumns.map(columnEffectiveIdGetter), allColumnsMap = chartModel.getColumnsMap();\n    let allColumnsMatch = previousConfig.allColumnIds.every(function (columnId) {\n        return allColumnsMap.hasOwnProperty(columnId);\n    });\n    if (allColumnsMatch) {\n        let axisConfig = generateMatchingConfig(previousConfig, allColumnsMap);\n        let chartType = previousConfig.chartType;\n        let isConfigValid = chartTypeSpecificationService.validateAxisConfig(chartType, axisConfig);\n        if (isConfigValid) {\n            return {\n                axisConfig: axisConfig,\n                chartType: chartType\n            };\n        }\n    }\n    return null;\n}\nexport let getDefaultAxisConfigAndChartType = function (chartModel) {\n    let chartTransformationConfig = checkIfAllColumnsChangedAndReturnConfig(chartModel);\n    if (!!chartTransformationConfig) {\n        return chartTransformationConfig;\n    }\n    let bestChartAxisConfigMap = computeChartTypesToBestAxisConfigMap(chartModel);\n    let chartType = null;\n    // Constants\n    let BUBBLE_CHART_SINGLE_YAXIS_MIN_CARDINALITY_THRESHOLD = 10, VERY_HIGH_CARDINALITY_THRESHOLD = 30;\n    // Input data read from chart model\n    let measureColumns = chartModel.getMeasureColumns(), numMeasureColumns = measureColumns.length, timeSeriesColumns = chartModel.getTimeSeriesColumns(), numTimeSeriesColumns = timeSeriesColumns.length, chartedAsAttributeColumns = _.difference(chartModel.getAttributeColumns(), timeSeriesColumns), numChartedAsAttributeColumns = chartedAsAttributeColumns.length, columnCardinality = chartModel.getCardinalityData();\n    // we don't support more than two attribute\n    // columns in default configurations so we select the \"best\" two\n    // attribute columns we would want to include\n    let attrCol1, attrCol2, attrColId1, attrColId2, attrColCardinality1, attrColCardinality2;\n    // lower cardinality is better than higher cardinality\n    let bestAttributeColumns = chartedAsAttributeColumns\n        .sort(function (col1, col2) {\n        let colId1 = col1.getId(), colId2 = col2.getId(), colCardinality1 = columnCardinality[colId1], colCardinality2 = columnCardinality[colId2];\n        return colCardinality1 - colCardinality2;\n    });\n    attrCol1 = bestAttributeColumns[0];\n    attrCol2 = bestAttributeColumns[1];\n    attrColId1 = attrCol1 && attrCol1.getId();\n    attrColId2 = attrCol2 && attrCol2.getId();\n    attrColCardinality1 = attrCol1 && columnCardinality[attrColId1];\n    attrColCardinality2 = attrCol2 && columnCardinality[attrColId2];\n    let topCount = chartModel.getTopCount();\n    let BAR_COLUMN_CHART = (topCount)\n        ? chartTypeSpecificationService.chartTypes.BAR\n        : chartTypeSpecificationService.chartTypes.COLUMN;\n    /*global flags*/\n    if (flags.getValue(flags.BLINK_FLAGS.enableWebGLMaps.name)) {\n        if (!!bestChartAxisConfigMap[chartTypeSpecificationService.chartTypes.GEO_EARTH_AREA]) {\n            chartType = chartTypeSpecificationService.chartTypes.GEO_EARTH_AREA;\n        }\n        else if (!!bestChartAxisConfigMap[chartTypeSpecificationService.chartTypes.GEO_EARTH_BUBBLE]) {\n            chartType = chartTypeSpecificationService.chartTypes.GEO_EARTH_BUBBLE;\n        }\n    }\n    else {\n        if (!!bestChartAxisConfigMap[chartTypeSpecificationService.chartTypes.GEO_AREA]) {\n            chartType = chartTypeSpecificationService.chartTypes.GEO_AREA;\n        }\n        else if (!!bestChartAxisConfigMap[chartTypeSpecificationService.chartTypes.GEO_BUBBLE]) {\n            chartType = chartTypeSpecificationService.chartTypes.GEO_BUBBLE;\n        }\n    }\n    if (!chartType && numMeasureColumns === 1 && numChartedAsAttributeColumns === 0) {\n        if (numTimeSeriesColumns >= 1) {\n            chartType = chartTypeSpecificationService.chartTypes.LINE;\n        }\n    }\n    if (!chartType && numMeasureColumns === 1 && numChartedAsAttributeColumns === 1) {\n        if (numTimeSeriesColumns >= 1) {\n            chartType = chartTypeSpecificationService.chartTypes.LINE;\n        }\n        else {\n            chartType = BAR_COLUMN_CHART;\n        }\n    }\n    if (!chartType && numMeasureColumns === 1 && numChartedAsAttributeColumns === 2) {\n        if (numTimeSeriesColumns === 1) {\n            chartType = chartTypeSpecificationService.chartTypes.LINE;\n        }\n        else {\n            if (attrColCardinality1 <= 5 && attrColCardinality2 <= 10) {\n                chartType = BAR_COLUMN_CHART;\n            }\n            else if (attrColCardinality1 > 30 && attrColCardinality2 > 30) {\n                chartType = BAR_COLUMN_CHART;\n            }\n            else if (attrColCardinality1 < 30 && attrColCardinality2 > 30) {\n                chartType = chartTypeSpecificationService.chartTypes.STACKED_COLUMN;\n            }\n            else {\n                chartType = chartTypeSpecificationService.chartTypes.STACKED_COLUMN;\n            }\n        }\n    }\n    if (!chartType && numMeasureColumns === 2 && numChartedAsAttributeColumns === 0) {\n        if (numTimeSeriesColumns >= 1) {\n            chartType = chartTypeSpecificationService.chartTypes.LINE;\n        }\n    }\n    if (!chartType && numMeasureColumns === 2 && numChartedAsAttributeColumns === 1) {\n        if (numTimeSeriesColumns === 1) {\n            chartType = chartTypeSpecificationService.chartTypes.LINE;\n        }\n        if (numTimeSeriesColumns === 0) {\n            let effectiveCardinality = topCount || attrColCardinality1;\n            if (effectiveCardinality > VERY_HIGH_CARDINALITY_THRESHOLD) {\n                chartType = chartTypeSpecificationService.chartTypes.SCATTER;\n            }\n            else {\n                chartType = BAR_COLUMN_CHART;\n            }\n        }\n    }\n    if (!chartType && numMeasureColumns === 2\n        && numChartedAsAttributeColumns === 2 && numTimeSeriesColumns === 0) {\n        let effectiveCardinality = topCount || attrColCardinality1 * attrColCardinality2;\n        if (effectiveCardinality <= VERY_HIGH_CARDINALITY_THRESHOLD) {\n            chartType = BAR_COLUMN_CHART;\n        }\n        else {\n            chartType = chartTypeSpecificationService.chartTypes.SCATTER;\n        }\n    }\n    if (!chartType && numMeasureColumns === 3 && numChartedAsAttributeColumns === 0) {\n        if (numTimeSeriesColumns === 1) {\n            chartType = chartTypeSpecificationService.chartTypes.LINE;\n        }\n    }\n    if (!chartType && numMeasureColumns === 3 && numChartedAsAttributeColumns === 1) {\n        if (numTimeSeriesColumns === 0) {\n            let effectiveCardinality = topCount || attrColCardinality1;\n            if (effectiveCardinality > BUBBLE_CHART_SINGLE_YAXIS_MIN_CARDINALITY_THRESHOLD) {\n                chartType = chartTypeSpecificationService.chartTypes.BUBBLE;\n            }\n            else {\n                chartType = BAR_COLUMN_CHART;\n            }\n        }\n        if (numTimeSeriesColumns === 1) {\n            chartType = chartTypeSpecificationService.chartTypes.LINE;\n        }\n    }\n    if (!chartType && numMeasureColumns === 3 && numChartedAsAttributeColumns === 2) {\n        chartType = chartTypeSpecificationService.chartTypes.BUBBLE;\n    }\n    if (!chartType && numMeasureColumns === 4\n        && numChartedAsAttributeColumns === 0 && numTimeSeriesColumns === 1) {\n        chartType = chartTypeSpecificationService.chartTypes.LINE;\n    }\n    if (!chartType && numMeasureColumns === 4 && numChartedAsAttributeColumns === 1) {\n        if (attrColCardinality1 > BUBBLE_CHART_SINGLE_YAXIS_MIN_CARDINALITY_THRESHOLD) {\n            chartType = chartTypeSpecificationService.chartTypes.BUBBLE;\n        }\n        else {\n            chartType = BAR_COLUMN_CHART;\n        }\n    }\n    return {\n        axisConfig: bestChartAxisConfigMap[chartType] || {\n            xAxisColumns: [],\n            yAxisColumns: [],\n            legendColumns: [],\n            radialColumn: null\n        },\n        chartType: chartType\n    };\n};\n//# sourceMappingURL=default-chart-config-service.js.map","/**\n * Copyright: ThoughtSpot Inc. 2019\n * Author: Ashish Shubham (ashish.shubham@thoughtspot.com)\n *\n * @fileoverview Axis config management in the presence\n * of mustVisualize columns\n */\nimport { create } from '@thoughtspot/logger';\nimport _ from 'lodash';\nimport { generateMatchingConfig, getConfig, persistChartTypeAndAxisConfig } from './chart-persisted-store';\nimport { addAttributeColumnToChart, chartTypes, stackedVersionForChartType, tryAddingMeasureColumnToChart, validateAxisConfig } from './chart-type-specification-service';\nlet logger = create('must-visualize-columns-axis');\nfunction checkIfReplacementAndReturnConfig(chartModel) {\n    let previousConfig = getConfig(chartModel.getId());\n    if (!previousConfig) {\n        persistChartTypeAndAxisConfig(chartModel);\n        previousConfig = getConfig(chartModel.getId());\n    }\n    let previousVisualizedColumnIds = Object.keys(previousConfig.visualizedColumnIdsAndAxis);\n    let newMustVisualizeColumnIds = chartModel.getMustVisualizeColumns()\n        .map(c => c.getId());\n    let newColumns = _.difference(newMustVisualizeColumnIds, previousVisualizedColumnIds);\n    // If there are more than one oldColumns its not a single column replacement, we just replace\n    // the first column in that case.\n    let oldColumn = _.difference(previousVisualizedColumnIds, newMustVisualizeColumnIds)[0];\n    if (oldColumn && newColumns.length) {\n        let oldColumnAxis = previousConfig.visualizedColumnIdsAndAxis[oldColumn];\n        let oldColIdx = previousConfig[oldColumnAxis].findIndex(oldColumn);\n        previousConfig[oldColumnAxis][oldColIdx] = newColumns.shift();\n    }\n    let allColumnsMap = chartModel.getColumnsMap();\n    let axisConfig = generateMatchingConfig(previousConfig, allColumnsMap);\n    let chartType = previousConfig.chartType;\n    return {\n        axisConfig: axisConfig,\n        chartType: chartType,\n        remainingMustVisualizeColumns: newColumns\n    };\n}\nfunction validatedConfigOrNull(config) {\n    if (validateAxisConfig(config.chartType, config.axisConfig)) {\n        return config;\n    }\n    else {\n        logger.warn('Axis config created with Must visualize columns was not valid');\n        return null;\n    }\n}\nexport function getAxisConfigWithMustVisualizeColumns(chartModel) {\n    if (!chartModel.getMustVisualizeColumns().length) {\n        return null;\n    }\n    let axisConfigAndChartType = checkIfReplacementAndReturnConfig(chartModel);\n    if (!axisConfigAndChartType.remainingMustVisualizeColumns.length) {\n        return validatedConfigOrNull(axisConfigAndChartType);\n    }\n    let remainingMustVisualizeCols = axisConfigAndChartType.remainingMustVisualizeColumns\n        .map(c => chartModel.getColumn(c));\n    let axisConfig = axisConfigAndChartType.axisConfig;\n    let chartType = axisConfigAndChartType.chartType;\n    remainingMustVisualizeCols.forEach(column => {\n        if (column.isAttribute()) {\n            axisConfigAndChartType = addAttributeColumn(chartModel, axisConfigAndChartType, column);\n        }\n        else if (column.isMeasure()) {\n            axisConfigAndChartType = addMeasureColumn(chartModel, axisConfigAndChartType, column);\n        }\n    });\n    return validatedConfigOrNull(axisConfigAndChartType);\n}\nfunction addAttributeColumn(chartModel, axisConfigAndChartType, column) {\n    let { axisConfig, chartType } = axisConfigAndChartType;\n    // If there are no legend Columns, we try to convert this chart to a stacked\n    // version if possible.\n    if (!axisConfig.legendColumns.length && stackedVersionForChartType[chartType]) {\n        chartType = stackedVersionForChartType[chartType];\n    }\n    addAttributeColumnToChart(chartModel, axisConfig, chartType, column);\n    return {\n        axisConfig,\n        chartType\n    };\n}\nfunction addMeasureColumn(chartModel, axisConfigAndChartType, column) {\n    let { axisConfig, chartType } = axisConfigAndChartType;\n    let numYAxisColumns = axisConfig.yAxisColumns.length;\n    // Try adding a measure column to the chart.\n    let isColumnAdded = tryAddingMeasureColumnToChart(chartModel, axisConfig, chartType, column);\n    // If the addition of measure columns was not possible to due to chartType\n    // constraints. We convert this into a LINE_STACKED_COLUMN.\n    if (!isColumnAdded) {\n        chartType = chartTypes.LINE_STACKED_COLUMN;\n    }\n    tryAddingMeasureColumnToChart(chartModel, axisConfig, chartType, column);\n    return {\n        axisConfig,\n        chartType\n    };\n}\n//# sourceMappingURL=must-visualize-columns-axis-service.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2013\n * Author: Vibhor Nanavati (vibhor@thoughtspot.com)\n *\n * @fileoverview Model for encapsulating chart details.\n */\nimport * as tslib_1 from \"tslib\";\nvar ChartModel_1;\nimport * as Logger from '@thoughtspot/logger';\nimport { blinkConstants } from '@thoughtspot/blink-constants/blink-constants';\nimport { dateFormatPresets, formatDate } from '@thoughtspot/date-format-util/date-util';\nimport { generateUUID } from '@thoughtspot/js-util';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport _ from 'lodash';\nimport { Provide } from '../../../../base/decorators';\nimport { flags } from '../../../../base/flags';\nimport { strings } from '../../../../base/strings';\nimport { areArraysSameSet, getAllCombinationsOfSize, mapArrayToHash } from '../../../../base/utils/util-ts';\nimport { QueryData } from '../../../callosum/model/query-data';\nimport { VisualizationModel } from '../visualization-model';\nimport { computeChartTypesToBestAxisConfigMap } from './best-chart-axis-config-service';\nimport { ChartAxisConfig } from './chart-axis-config';\nimport { getBackendConfiguration, setBackendConfiguration } from './chart-axis-config-mapping-service';\nimport * as chartDataProcessor from './chart-data-processor-service';\nimport { formatDateByFormatConfig } from '@thoughtspot/date-format-util/date-util';\nimport { getValueFormattedByConfig } from '@thoughtspot/number-format-util/number-util';\nimport { persistChartTypeAndAxisConfig } from './chart-persisted-store';\nimport { areProvidersEqual, chartProviders, chartTypes, chartTypesInDisplayOrder, configOptions, customColorSelectorConfig, getChartDataValidationError, getChartProvider, getLegendLabels, getYSEOPConfig, hasNativeLegend, hasPersistentLegend, isGeoChartType, isStackedChart, useMeasureOnXAxisAsOrdinal, useMeasureOnYAxisAsOrdinal, useOrdinalXAxis, validateAxisConfig } from './chart-type-specification-service';\nimport { formatCompositeAxisValue, formatCompositeColumnValue, } from './chart-util-service';\nimport { AXIS_TYPES, CLIENT_STATE_KEYS, upgradeClientStateToV2 } from './client-state';\nimport { getDefaultAxisConfigAndChartType } from './default-chart-config-service';\nimport { getAxisConfigWithMustVisualizeColumns } from './must-visualize-columns-axis-service';\n// TODO(chab) unit test will fail if we use import\n// TODO(chab) see above\n// TODO(chab) see above\nconst unitToFormatMap = {\n    millisecond: [\n        dateFormatPresets.DATETIME_24_SHORT_WITH_MILLIS,\n        dateFormatPresets.DATETIME_24_SHORT_WITH_MILLIS_WITHOUT_YEAR\n    ],\n    second: [\n        dateFormatPresets.DATETIME_SHORT_WITH_SECONDS,\n        dateFormatPresets.DATETIME_SHORT_WITH_SECONDS_WITHOUT_YEAR\n    ],\n    minute: [\n        dateFormatPresets.DATETIME_24_SHORT,\n        dateFormatPresets.DATETIME_24_SHORT_WITHOUT_YEAR\n    ],\n    hour: [\n        dateFormatPresets.DATE_SHORT_WITH_HOUR_24,\n        dateFormatPresets.DATE_SHORT_WITH_HOUR_24_WITHOUT_YEAR\n    ],\n    day: [\n        dateFormatPresets.DATE_SHORT_2_DIGIT_YEAR,\n        dateFormatPresets.DAY_WITH_MONTH_NUM\n    ],\n    week: [\n        dateFormatPresets.DATE_SHORT,\n        dateFormatPresets.DAY_WITH_MONTH_NUM\n    ],\n    month: [\n        dateFormatPresets.MONTH_WITH_2_DIGIT_YEAR,\n        'MMM'\n    ],\n    quarter: [\n        dateFormatPresets.QUARTER_WITH_2_DIGIT_YEAR,\n        dateFormatPresets.QUARTER\n    ],\n    year: [\n        'yyyy',\n        'yyyy'\n    ]\n};\nlet ChartModel = ChartModel_1 = class ChartModel extends VisualizationModel {\n    constructor(params) {\n        super(params);\n        this.params = params;\n        this._logger = Logger.create('chart-model');\n        this._axisConfigDeferred = false;\n        this.getFormattingForColumn = (colId) => {\n            return _.get(this.getColumnProperties(), `${colId}.${CLIENT_STATE_KEYS.format}`, undefined);\n        };\n        this.getFormattingForAxis = (axisId) => {\n            let axisProperties = this.getAxisProperties();\n            return _.get(axisProperties, `${axisId}.${CLIENT_STATE_KEYS.format}`, undefined);\n        };\n        this.allowChartTypeChangeOnDataLoad = false;\n        this._allColumnsMap = {};\n        let allColumns = params.allColumns || [];\n        allColumns.forEach((column) => {\n            if (!!column) {\n                this._allColumnsMap[column.getGuid()] = column;\n            }\n        });\n        this._init();\n        let data = params.vizData;\n        if (!!data) {\n            this.updateData(data);\n        }\n        if (this.getSchemaVersion() < ChartModel_1.EFFECTIVE_ID_DEFINITION_SCHEMA_CHANGE_VERSION) {\n            if (this.getYAxisColumns().length > 1) {\n                this.clearVisibleSeriesIds();\n            }\n        }\n        this.upgradeClientState();\n    }\n    static getLabelForNumericColumn(value, column, allColumnValuesOnAxis, formattingOverrides) {\n        let isDouble = column.isDoubleColumn(), nDecimal, noShorten = false;\n        if (isDouble) {\n            if (allColumnValuesOnAxis && allColumnValuesOnAxis.length > 1) {\n                // here we don't use the precision of column but compute\n                // it for the values Highcharts has decided to put on the labels.\n                nDecimal = 2;\n                if (column.isEffectivelyPercent()) {\n                    nDecimal = Math.max(0, nDecimal - 2);\n                }\n            }\n            else {\n                nDecimal = blinkConstants.decimalPrecision.MIN;\n            }\n            noShorten = nDecimal > 0;\n        }\n        return column.getDataFormatter()(value, Object.assign({\n            noShorten: noShorten,\n            isDouble: isDouble,\n            nDecimal: nDecimal\n        }, formattingOverrides));\n    }\n    static areComparableRanges(min1, max1, min2, max2) {\n        let mid1 = (min1 + max1) / 2, mid2 = (min2 + max2) / 2, range1 = Math.abs(max1 - min1), range2 = Math.abs(max2 - min2);\n        // Note(sunny): this is a rather arbitrary measure of \"comparable\" ranges.\n        // will need improvement\n        return Math.abs(mid1 - mid2) <= Math.min(range1, range2) * 2;\n    }\n    static isPrimarySortOnXAxisColumns(xAxisColumns, yAxisColumns) {\n        let maxXAxisColSortIndex = Number.NEGATIVE_INFINITY;\n        for (let i = 0; i < xAxisColumns.length; i++) {\n            let xAxisColumn = xAxisColumns[i];\n            if (!xAxisColumn.isSorted()) {\n                // all x-axis columns must be sorted\n                return false;\n            }\n            maxXAxisColSortIndex = Math.max(maxXAxisColSortIndex, xAxisColumn.getSortIndex());\n        }\n        // none of the y-axis columns should be sorted with a sort index\n        // lower than any x-axis column\n        return !yAxisColumns.some(function (yAxisColumn) {\n            return yAxisColumn.isSorted() && yAxisColumn.getSortIndex() < maxXAxisColSortIndex;\n        });\n    }\n    _getYAxisRowValuesAtCol(colIdx) {\n        return this._dataModel.yValueToRawValues[colIdx];\n    }\n    isMissingAxisConfigurationDetail() {\n        return this._axisConfigDeferred;\n    }\n    setIsMissingAxisConfigurationDetail(value) {\n        this._axisConfigDeferred = value;\n    }\n    getQueryDefinitions() {\n        return this._queryDefinitions;\n    }\n    setQueryDefinitions(queryDefinitions) {\n        this._queryDefinitions = queryDefinitions;\n    }\n    getChartType() {\n        return this.chartType;\n    }\n    getValidChartTypes() {\n        return Object.keys(this._bestAxisColumnConfigForChartType);\n    }\n    hasVerticalLegend() {\n        return this.getChartType() === chartTypes.SANKEY;\n    }\n    hasNativeLegend() {\n        return hasNativeLegend(this.chartType);\n    }\n    upgradeClientState() {\n        // TODO(Lavish): Add a check to compare current version and upgrade\n        // conditionally.\n        let clientState = upgradeClientStateToV2(this);\n        _.forIn(clientState, (value, key) => {\n            this.setUserData(key, value);\n        });\n        this.originalClientState = _.cloneDeep(clientState);\n        delete this.originalClientState.version;\n    }\n    setChartType(chartType) {\n        if (this.getChartType() === chartType) {\n            return false;\n        }\n        let isCurrentChartGeo = isGeoChartType(this.chartType);\n        let isNewChartGeo = isGeoChartType(chartType);\n        let areChartCategoriesDifferent = isCurrentChartGeo !== isNewChartGeo;\n        let isCurrentChartRainbow = !!this.chartType &&\n            configOptions(this.chartType, void 0)\n                .useRainbowColors;\n        let isNewChartRainbow = configOptions(chartType, void 0).useRainbowColors;\n        let isColorStrategyDifferent = isCurrentChartRainbow !== isNewChartRainbow;\n        let isCurrentChartAlpha = !!this.chartType &&\n            configOptions(this.chartType, void 0)\n                .useAlphaColors;\n        let isNewChartAlpha = configOptions(chartType, void 0).useAlphaColors;\n        let isAlphaUseDifferent = isCurrentChartAlpha !== isNewChartAlpha;\n        if (areChartCategoriesDifferent ||\n            isColorStrategyDifferent ||\n            isAlphaUseDifferent) {\n            this.clearSystemDecidedColors();\n        }\n        let axisConfig = {\n            xAxisColumns: this.getXAxisColumns(),\n            yAxisColumns: this.getYAxisColumns(),\n            legendColumns: this.getLegendColumns(),\n            radialColumn: this.getRadialColumn()\n        };\n        let isChartTypeSupportedOnCurrentConfig = validateAxisConfig(chartType, axisConfig);\n        if (isChartTypeSupportedOnCurrentConfig) {\n            this.chartType = chartType;\n            this.getJson().chartType = chartType;\n            persistChartTypeAndAxisConfig(this);\n            // SCAL-8917 : There are changes made to the series object like chart type etc\n            // which causes issues in the case where a legend is hidden and re displayed.\n            if (!this.hasNoData()) {\n                this._dataModel = chartDataProcessor.getDataModel(this);\n            }\n            this._unsupportedDataError = getChartDataValidationError(this);\n            return false;\n        }\n        else if (!!this._bestAxisColumnConfigForChartType[chartType]) {\n            this.setIsConfigurationLocked(false);\n            let bestAxisConfig = this._bestAxisColumnConfigForChartType[chartType];\n            this.chartType = chartType;\n            this.getJson().chartType = chartType;\n            let newChartAxisConfig = new ChartAxisConfig(bestAxisConfig.xAxisColumns, bestAxisConfig.yAxisColumns, bestAxisConfig.legendColumns, bestAxisConfig.radialColumn);\n            this.updateAxisConfig(newChartAxisConfig);\n            setBackendConfiguration(this, newChartAxisConfig);\n            this.clearData();\n            this.getContainingAnswerModel().getCurrentAnswerSheet().clearDataForViz(this.getId());\n            persistChartTypeAndAxisConfig(this);\n            this.setAxisProperties(this.generateAxisPropertiesFromAxisConfig());\n            return true;\n        }\n        else if (isChartTypeSupportedOnCurrentConfig) {\n            // In case where the user views the attribute by attribute, there are cases chart types\n            // that dont suggest any best config as they are not suited to show that chart based on\n            // metadata.\n            // But the user here has capability to still select the chart in cases where they are\n            // certain the data does not have issues like more than 1 y-value for x.\n            // eg Query : \"username age\".\n            this.chartType = chartType;\n            this.getJson().chartType = chartType;\n            persistChartTypeAndAxisConfig(this);\n            // SCAL-8917 : There are changes made to the series object like chart type etc\n            // which causes issues in the case where a legend is hidden and re displayed.\n            if (!this.hasNoData()) {\n                this._dataModel = chartDataProcessor.getDataModel(this);\n            }\n            this._unsupportedDataError = getChartDataValidationError(this);\n        }\n        else {\n            this._logger\n                .error('tried to set chart type that is not possible with the current answer');\n        }\n    }\n    hasMetrics() {\n        return _.some(Object.keys(this._allColumnsMap), k => this._allColumnsMap[k].getMetricsDefinition() !== null);\n    }\n    updateAxisConfigAndSetBackendConfig(chartAxisConfig) {\n        this.updateAxisConfig(chartAxisConfig);\n        setBackendConfiguration(this, chartAxisConfig);\n        persistChartTypeAndAxisConfig(this);\n    }\n    defaultConfigExistsForAnswer() {\n        return !!this.chartType;\n    }\n    hasNoData() {\n        return this._hasNoData;\n    }\n    getEffectiveIdToColumnMap() {\n        return this._columnEffectiveIdToColumn;\n    }\n    getDataArray() {\n        return this._dataArray;\n    }\n    updateData(newVizData) {\n        super.updateData.call(this, (newVizData && newVizData[0]) || null);\n        this._hasNoData = false;\n        if (!newVizData || !Array.isArray(newVizData)) {\n            this._hasNoData = true;\n            return;\n        }\n        newVizData.forEach((dataset) => {\n            if (!dataset.data) {\n                this._hasError = true;\n                this._hasNoData = true;\n            }\n            if (dataset.data && !dataset.data.length) {\n                this._hasNoData = true;\n            }\n        });\n        if (this._hasError || this._hasNoData) {\n            return;\n        }\n        this._dataArray = newVizData.map((dataJson) => {\n            return new QueryData(dataJson);\n        });\n        // TODO(Jasmeet): Try to get rid of reparsing in case of data update.\n        this.parseDefinition(this);\n        persistChartTypeAndAxisConfig(this);\n        this._dataModel = chartDataProcessor.getDataModel(this);\n        // Metadata for data should be computed after data is processed.\n        this._computedMetaInformation = chartDataProcessor.computeMetaDataInformation(this);\n        this._bestAxisColumnConfigForChartType = computeChartTypesToBestAxisConfigMap(this);\n        let unsupportedDataError = getChartDataValidationError(this);\n        if (!this.allowChartTypeChangeOnDataLoad) {\n            this._unsupportedDataError = unsupportedDataError;\n        }\n        else if (!!unsupportedDataError) {\n            let candidateChartType = this.getChartTypeWithNoDataErrors();\n            if (!!candidateChartType) {\n                this.chartType = candidateChartType;\n                this.getJson().chartType = candidateChartType;\n            }\n            else {\n                this._unsupportedDataError = unsupportedDataError;\n            }\n        }\n        else {\n            this._unsupportedDataError = unsupportedDataError;\n        }\n        // check if we can bypass that check and just assign\n        if (this.getDataModel() && this.getDataModel().hasNoData) {\n            this._hasNoData = true;\n        }\n    }\n    getComparableMeasureColumns() {\n        let measureColumns = this.getMeasureColumns();\n        if (measureColumns.length <= 1) {\n            return null;\n        }\n        let self = this, allPairs = getAllCombinationsOfSize(measureColumns, 2);\n        return allPairs.find(function (pair) {\n            let col1 = pair[0], col2 = pair[1];\n            return self._measureColumnsHaveComparableRange(col1, col2);\n        }) || null;\n    }\n    isXAxisMeasure() {\n        return this._xAxisColumns.length === 1 && (this._xAxisColumns[0].isEffectivelyNumeric());\n    }\n    isYAxisMeasure() {\n        return this._yAxisColumns.every(function (column) {\n            return column.isEffectivelyNumeric();\n        });\n    }\n    isSomeYAxisNumeric() {\n        return _.castArray(this.getYAxisColumns())\n            .some((column) => column.isEffectivelyNumeric());\n    }\n    isRadialColumnNumeric() {\n        return this.getRadialColumn().isEffectivelyNumeric();\n    }\n    isYAxisDateOrTime() {\n        return this._yAxisColumns.every(function (column) {\n            return column.isDateColumn() || column.isTimeColumn();\n        });\n    }\n    _isXAxisDate() {\n        return this._xAxisColumns.length === 1 && this._xAxisColumns[0].isDateColumn();\n    }\n    getLegendCardinality() {\n        let chartConfigOptions = configOptions(this.getChartType(), void 0);\n        let displayYValuesWithLegendSeries = chartConfigOptions.displayYValuesWithLegendSeries;\n        let yAxisColumns = this.getYAxisColumns();\n        let uniqueLegendValues = _.get(this._dataModel, 'uniqueLegendValues') || [];\n        if (yAxisColumns.length > 1) {\n            if (displayYValuesWithLegendSeries) {\n                let legendSeriesCount = uniqueLegendValues.length;\n                return legendSeriesCount + yAxisColumns.length - 1;\n            }\n            else {\n                return yAxisColumns.length;\n            }\n        }\n        return uniqueLegendValues.length;\n    }\n    getXAxisCardinality() {\n        return this._dataModel && this._dataModel.xValueToRawValues ?\n            this._dataModel.xValueToRawValues.length\n            : 0;\n    }\n    hasError() {\n        return this._hasError;\n    }\n    getUnsupportedDataError() {\n        return this._unsupportedDataError;\n    }\n    doesNotSupportData() {\n        return !!this._unsupportedDataError;\n    }\n    /**\n     * Returns true if there is any possible combination of the columns across the axes\n     * which supports the chart type\n     * __type__\n     * @param type {chartTypeSpecificationService.chartTypes}\n     * @returns {*|boolean}\n     */\n    isChartTypeSupported(type) {\n        let axisConfig = {\n            xAxisColumns: this.getXAxisColumns(),\n            yAxisColumns: this.getYAxisColumns(),\n            legendColumns: this.getLegendColumns(),\n            radialColumn: this.getRadialColumn()\n        };\n        // In case where the user views the attribute by attribute, there are cases chart types\n        // that dont suggest any best config as they are not suited to show that chart based on\n        // metadata.\n        // But the user here has capability to still select the chart in cases where they are\n        // certain the data does not have issues like more than 1 y-value for x.\n        // eg Query : \"username age\".\n        return _.has(this._bestAxisColumnConfigForChartType, type)\n            || validateAxisConfig(type, axisConfig);\n    }\n    yAxisColumnHasSorting() {\n        return this.getYAxisColumns().some(function (column) {\n            return column.isUserSorted();\n        });\n    }\n    xAxisColumnHasSorting() {\n        return this.getXAxisColumns().some(function (column) {\n            return column.isUserSorted();\n        });\n    }\n    getYAxisColumn(distinctNameIdentifier) {\n        return this._yAxisColumns[this.distinctYAxisColumnNames.indexOf(distinctNameIdentifier)];\n    }\n    getYAxisColumnById(outputGuid) {\n        return this._yAxisColumns.find((column) => {\n            return column.getId() === outputGuid;\n        });\n    }\n    // NOTE: The semantics of this function are:\n    // Whether the column matching the guid would be grouped on legend columns or not.\n    isYColumnGroupedByLegendColumns(columnId) {\n        let yAxisColumns = this.getYAxisColumns();\n        return yAxisColumns.length > 0 ? yAxisColumns[0].getId() === columnId : true;\n    }\n    getColumns() {\n        return _.values(this._allColumnsMap);\n    }\n    getColumnsMap() {\n        return this._allColumnsMap;\n    }\n    getColumn(columnGuid) {\n        return this._allColumnsMap[columnGuid];\n    }\n    getVizColumns() {\n        let allColumns = this.getColumns();\n        if (!!allColumns.length) {\n            return allColumns;\n        }\n        return this.getVisualizedColumns() || [];\n    }\n    getVisualizedColumns() {\n        let allIncludedColumns = _.flatten([this._xAxisColumns,\n            this._yAxisColumns,\n            this._legendColumns,\n            this._columnsInChartDataNotOnAnyAxis]);\n        if (this._radialColumn) {\n            allIncludedColumns.push(this._radialColumn);\n        }\n        return allIncludedColumns;\n    }\n    getMustVisualizeColumns() {\n        return this.getColumns()\n            .filter(c => c.isMustVisualize);\n    }\n    getNotVisualizedColumns() {\n        return _.difference(this.getColumns(), this.getVisualizedColumns());\n    }\n    setColumnsInChartDataNotOnAnyAxis(columns) {\n        this._columnsInChartDataNotOnAnyAxis = columns;\n    }\n    getXAxisColumns() {\n        return this._xAxisColumns;\n    }\n    setXAxisColumns(columns) {\n        this._xAxisColumns = columns;\n    }\n    getYAxisColumns() {\n        return this._yAxisColumns;\n    }\n    setYAxisColumns(columns) {\n        this._yAxisColumns = columns;\n    }\n    getYAxisColumnsForSheet(queryIndex = 0) {\n        return this._yAxisColumns.filter(column => column.getQueryIndex() === queryIndex);\n    }\n    getLegendColumns() {\n        return this._legendColumns;\n    }\n    setLegendColumns(columns) {\n        this._legendColumns = columns;\n    }\n    getRadialColumn() {\n        return this._radialColumn;\n    }\n    setRadialColumn(column) {\n        this._radialColumn = column;\n    }\n    getAxisConfig() {\n        return new ChartAxisConfig(this._xAxisColumns, this._yAxisColumns, this._legendColumns, this._radialColumn);\n    }\n    getCategoryColumnNotOnAxis() {\n        // In the current model there is a possibility that there is not column\n        // put on category in backend config.\n        // In that case any unused attribute will be put into category,\n        // this is a minimum requirement.\n        // When the data comes back from the backend at that point the config\n        // should reflect the state where there is a column in chart data\n        // which is not on any axis config.\n        // This is currently consumed to add tooltip information\n        // Eg: Scatter plot with measures on x and y.\n        return this._columnsInChartDataNotOnAnyAxis[0];\n    }\n    getMeasureColumn(idx) {\n        let measureColumns = this.getMeasureColumns();\n        if (idx < 0 || idx >= measureColumns.length) {\n            return null;\n        }\n        return measureColumns[idx];\n    }\n    getMeasureColumns() {\n        return this.getColumns().filter(function (column) {\n            return column.isEffectivelyNumeric() && !column.isGroupingColumn();\n        });\n    }\n    /**\n     * List of columns which make a linear non-ending time series.\n     * For eg. DAILY, MONTHLY etc.\n     *\n     * @returns {VisualizationColumnModel[]}\n     */\n    getTimeSeriesColumns() {\n        return this.getColumns().filter(function (column) {\n            return column.isDateColumn();\n        });\n    }\n    /**\n     * List of all time type columns.\n     * This includes timeseries columns and bucket columns like\n     * DAY OF WEEK, MONTH OF YEAR etc.\n     *\n     * @returns {VisualizationColumnModel[]}\n     */\n    getTimeFamilyColumns() {\n        return this.getColumns().filter(function (column) {\n            return column.isDateFamilyColumn();\n        });\n    }\n    getAttributeColumns() {\n        return this.getColumns().filter(function (column) {\n            return column.isEffectivelyNonNumeric() || column.isGroupingColumn();\n        });\n    }\n    isColAttribute(column) {\n        return column.isEffectivelyNonNumeric() || column.isGroupingColumn();\n    }\n    getSortedAttributeColumns() {\n        function compareAttributeCardinality(a, b, indexA, indexB) {\n            if (!_.isNumber(a) || !_.isNumber(b)) {\n                this._logger.error('Cardinality for column not defined');\n            }\n            if (a < 0 && b >= 0) {\n                return 1;\n            }\n            if (b < 0 && a >= 0) {\n                return -1;\n            }\n            if (a < 0 && b < 0 || a === b) {\n                return indexA - indexB;\n            }\n            return a - b;\n        }\n        let timeFamilyColumns = this.getTimeFamilyColumns();\n        let attributeColumns = _.without(this.getAttributeColumns(), ...timeFamilyColumns);\n        let cardinalityData = this.getCardinalityData();\n        let effectiveIdToOriginalIndex = mapArrayToHash(attributeColumns, function (column) {\n            return column.getId();\n        }, function (column, index) {\n            return index;\n        });\n        let sortedAttributeColumns = attributeColumns.sort(function (col1, col2) {\n            let colId1 = col1.getId(), colId2 = col2.getId(), colCardinality1 = cardinalityData[colId1], colCardinality2 = cardinalityData[colId2], index1 = effectiveIdToOriginalIndex[colId1], index2 = effectiveIdToOriginalIndex[colId2];\n            return compareAttributeCardinality(colCardinality1, colCardinality2, index1, index2);\n        });\n        return sortedAttributeColumns;\n    }\n    hasAnySortedMeasure() {\n        return this.getColumns().some(column => column.isMeasure() && column.isSorted());\n    }\n    hasAnySortedMeasureNotOnAxis() {\n        return this._columnsInChartDataNotOnAnyAxis\n            .some(column => column.isMeasure() && column.isSorted());\n    }\n    getCardinalityData() {\n        return this._computedMetaInformation.colCardinality;\n    }\n    getSeries() {\n        // NOTE: It is possible that the data model is not yet defined.\n        return (this._dataModel && this._dataModel.series) || [];\n    }\n    /**\n     * Currently we do not have the UI capability to support Geo Filters.\n     * Until we decide to support it, we will return empty arrays.\n     * @return {GeoFilterObject[]}\n     */\n    getGeoObjects() {\n        return [];\n    }\n    getDataModel() {\n        return this._dataModel;\n    }\n    /**\n     * Updates the names of all the series visible in chart-ui.\n     * The list is persisted if the parent answer is saved.\n     * @param seriesNames {Array}\n     */\n    setVisibleSeriesIds(seriesNames) {\n        this.setUserData('visibleSeriesNames', seriesNames);\n    }\n    /**\n     * Clears the persistable list of visible series names\n     */\n    clearVisibleSeriesIds() {\n        this.clearUserData('visibleSeriesNames');\n    }\n    /**\n     * Returns the list of all the series visible in the chart-ui as previously set.\n     * In case of saved answer this might be something that was set in another session.\n     * null is returned if no previously set list of names was found\n     * (e.g. when a fresh answer is being loaded)\n     * @returns {Array}\n     */\n    getVisibleSeriesIds() {\n        return this.getUserData('visibleSeriesNames');\n    }\n    /**\n     * Returns custom set colors on the series in a chart. this Tist is persisted.\n     * @returns {Object}\n     */\n    getSeriesColorsMap() {\n        return _.assign({}, this.getUserData(jsonConstants.chartClientStateKeys.SYSTEM_SERIES_COLORS), this.getUserData(jsonConstants.chartClientStateKeys.SERIES_COLORS));\n    }\n    getGridLinesConfig() {\n        const chartConfigOptions = configOptions(this.chartType, this);\n        const defaultGridLinesConfig = _.get(chartConfigOptions, 'allowedConfigurations.gridLineConfig', {});\n        return _.assign(defaultGridLinesConfig, this.getUserData('gridLineConfig'));\n    }\n    setGridLinesConfig(gridLineConfig) {\n        let lastConfig = this.getGridLinesConfig();\n        _.assign(lastConfig, gridLineConfig);\n        this.setUserData('gridLineConfig', lastConfig);\n    }\n    /**\n     * Sets the color for a seriesId\n     * @param seriesId\n     * @param color\n     */\n    setSeriesColor(seriesId, color) {\n        let seriesColors = this.getUserData(jsonConstants.chartClientStateKeys.SERIES_COLORS) || {};\n        seriesColors[seriesId] = color;\n        this.setUserData(jsonConstants.chartClientStateKeys.SERIES_COLORS, seriesColors);\n        let serie = this.getSerie(seriesId);\n        if (serie) {\n            serie.color = color;\n        }\n    }\n    setSystemSeriesColor(seriesId, color) {\n        let systemSeriesColors = this.getUserData(jsonConstants.chartClientStateKeys.SYSTEM_SERIES_COLORS) || {};\n        systemSeriesColors[seriesId] = color;\n        this.setUserData(jsonConstants.chartClientStateKeys.SYSTEM_SERIES_COLORS, systemSeriesColors);\n    }\n    getLongestSerieName() {\n        return this._dataModel._longestSerieName;\n    }\n    getMultiColorSeriesColors() {\n        return _.assign({}, this.getUserData(jsonConstants.chartClientStateKeys.SYSTEM_MULTI_COLOR_SERIES_COLORS), this.getUserData(jsonConstants.chartClientStateKeys.MULTI_COLOR_SERIES_COLORS));\n    }\n    clearMultiColorSeriesColors() {\n        this.setUserData(jsonConstants.chartClientStateKeys.SYSTEM_MULTI_COLOR_SERIES_COLORS, {});\n        this.setUserData(jsonConstants.chartClientStateKeys.MULTI_COLOR_SERIES_COLORS, {});\n    }\n    clearSeriesColors() {\n        this.setUserData(jsonConstants.chartClientStateKeys.SYSTEM_SERIES_COLORS, {});\n        this.setUserData(jsonConstants.chartClientStateKeys.SERIES_COLORS, {});\n    }\n    setMultiColorSeriesColors(seriesId, xAxisColumnHash, colors) {\n        let multiColorSeriesColors = this.getMultiColorSeriesColors();\n        if (!multiColorSeriesColors[seriesId]) {\n            multiColorSeriesColors[seriesId] = {};\n        }\n        multiColorSeriesColors[seriesId][xAxisColumnHash] = colors;\n        this.setUserData(jsonConstants.chartClientStateKeys.MULTI_COLOR_SERIES_COLORS, multiColorSeriesColors);\n    }\n    setSystemMultiColorSeriesColors(seriesId, xAxisColumnHash, colors) {\n        let systemMultiColorSeriesColors = this.getUserData(jsonConstants.chartClientStateKeys.SYSTEM_MULTI_COLOR_SERIES_COLORS) || {};\n        if (!systemMultiColorSeriesColors[seriesId]) {\n            systemMultiColorSeriesColors[seriesId] = {};\n        }\n        systemMultiColorSeriesColors[seriesId][xAxisColumnHash] = colors;\n        this.setUserData(jsonConstants.chartClientStateKeys.SYSTEM_MULTI_COLOR_SERIES_COLORS, systemMultiColorSeriesColors);\n    }\n    clearSystemDecidedColors() {\n        this.clearUserData(jsonConstants.chartClientStateKeys.SYSTEM_MULTI_COLOR_SERIES_COLORS);\n        this.clearUserData(jsonConstants.chartClientStateKeys.SYSTEM_SERIES_COLORS);\n    }\n    /**\n     * sets whether the y-axes of the chart (if more than one) are to share their scale\n     * @param yAxisShared {boolean}\n     */\n    setIsYAxisShared(yAxisShared) {\n        this.setUserData('yAxisShared', yAxisShared);\n        let multiYAxis = this.getYAxisColumns().length > 1;\n        if (multiYAxis) {\n            this.getSeries().forEach(function (series, index) {\n                series.yAxis = yAxisShared ? 0 : index;\n            });\n        }\n    }\n    /**\n     * Returns whether the y-axes of the chart (if more than one) are to share their scale\n     * @returns {boolean}\n     */\n    isYAxisShared() {\n        return this.getUserData('yAxisShared');\n    }\n    /**\n     * Gets the number of YAxis for the chart\n     */\n    getNumberOfYAxes() {\n        return (this.isYAxisShared()) ? 1 : this.getYAxisColumns().length;\n    }\n    /**\n     * Sets highcharts axes extremes/zoom state\n     * @param xAxisExtremes {Array} each item of array is a map with keys [min, max]\n     * @param yAxisExtremes {Array} each item of array is a map with keys [min, max]\n     */\n    setAxisExtremes(xAxisExtremes, yAxisExtremes) {\n        this.setUserData('axisExtremes', {\n            x: xAxisExtremes,\n            y: yAxisExtremes\n        });\n    }\n    setMapViewport(mapView) {\n        this.setUserData('mapViewport', mapView);\n    }\n    clearMapViewport() {\n        this.clearUserData('mapViewport');\n    }\n    getMapViewport() {\n        return this.getUserData('mapViewport');\n    }\n    clearAxisExtremes() {\n        this.clearUserData('axisExtremes');\n    }\n    _getAxisExtremes(axis) {\n        let extremes = this.getUserData('axisExtremes');\n        if (!extremes) {\n            return null;\n        }\n        return extremes[axis];\n    }\n    /**\n     * Returns the saved x-axes (note plural) extremes/zoom state\n     * @returns {Array}\n     */\n    getXAxisExtremes() {\n        return this._getAxisExtremes('x');\n    }\n    /**\n     * Returns the saved y-axes (note plural) extremes/zoom state\n     * @returns {*}\n     */\n    getYAxisExtremes() {\n        return this._getAxisExtremes('y');\n    }\n    /**\n     * Setter/Getter for Chart Zoomed boolean.\n     * @param isZoomed\n     * @returns {null}\n     */\n    isZoomedIn(isZoomed) {\n        if (arguments.length > 0) {\n            this.setUserData('isZoomed', !!isZoomed);\n            return isZoomed;\n        }\n        else {\n            return this.getUserData('isZoomed') || null;\n        }\n    }\n    isRoundedNumbersEnabled() {\n        return this.isRoundedNumbersEnabledSetByUser() ?\n            this.getUserData('roundedNumbers') : true;\n    }\n    isRoundedNumbersEnabledSetByUser() {\n        return !_.isUndefined(this.getUserData('roundedNumbers'));\n    }\n    setRoundedNumbersEnabled(enabled) {\n        this.setUserData('roundedNumbers', !!enabled);\n    }\n    canShowRegressionLine() {\n        return configOptions(this.chartType, void 0)\n            .allowedConfigurations\n            .regressionLine;\n    }\n    toggleShowLinearRegressionLine() {\n        this.setShowRegressionLine(!this.getShowRegressionLine());\n    }\n    toggleResponsiveLayout() {\n        this.setUserData(jsonConstants.RESPONSIVE_LAYOUT_DISABLED, !this.getUserData(jsonConstants.RESPONSIVE_LAYOUT_DISABLED));\n    }\n    isResponsiveLayoutEnabled() {\n        return !this.getUserData(jsonConstants.RESPONSIVE_LAYOUT_DISABLED);\n    }\n    toggleMarkersEnabled() {\n        this.setUserData(jsonConstants.MARKERS_ENABLED, !this.getUserData(jsonConstants.MARKERS_ENABLED));\n    }\n    markersEnabled() {\n        return !!this.getUserData(jsonConstants.MARKERS_ENABLED);\n    }\n    get showPivotSummaries() {\n        // NB: Inverted value since we want to show summaries by default\n        return !this.getUserData(jsonConstants.pivotConfig.HIDE_PIVOT_SUMMARIES);\n    }\n    set showPivotSummaries(val) {\n        if (!val) {\n            this.setUserData(jsonConstants.pivotConfig.HIDE_PIVOT_SUMMARIES, true);\n        }\n        else {\n            this.clearUserData(jsonConstants.pivotConfig.HIDE_PIVOT_SUMMARIES);\n        }\n    }\n    get useTreeLayout() {\n        // NB: Inverted value since we want to use tree layout as default\n        return !this.getUserData(jsonConstants.pivotConfig.USE_FLAT_LAYOUT);\n    }\n    set useTreeLayout(val) {\n        if (!val) {\n            this.setUserData(jsonConstants.pivotConfig.USE_FLAT_LAYOUT, true);\n        }\n        else {\n            this.clearUserData(jsonConstants.pivotConfig.USE_FLAT_LAYOUT);\n        }\n    }\n    getPivotSummaryMode() {\n        return this.getUserData(jsonConstants.pivotConfig.SUMMARY_MODE);\n    }\n    setPivotSummaryMode(val) {\n        this.setUserData(jsonConstants.pivotConfig.SUMMARY_MODE, val);\n    }\n    columnsMakeTimeSeries(xAxisColumns, yAxisColumns) {\n        return xAxisColumns.length === 1 && xAxisColumns[0].isDateColumn()\n            && xAxisColumns[0].isCalendarGregorianOrFiscal()\n            && ChartModel_1.isPrimarySortOnXAxisColumns(xAxisColumns, yAxisColumns);\n    }\n    /**\n     * Returns true, if the chart has date column as x-axis.\n     *\n     * @return {boolean}\n     */\n    isTimeSeries() {\n        return this.columnsMakeTimeSeries(this._xAxisColumns, this._yAxisColumns);\n    }\n    isXAxisOrdinalBased() {\n        let chartType = this.getChartType();\n        if (useOrdinalXAxis(chartType)) {\n            return true;\n        }\n        let useMeasureAsOrdinal = useMeasureOnXAxisAsOrdinal(chartType);\n        return !((this.isXAxisMeasure() && !useMeasureAsOrdinal) || this.isTimeSeries());\n    }\n    isYAxisSelectorDisabled() {\n        return this.chartType === chartTypes.GRID_TABLE;\n    }\n    isYAxisOrdinalBased() {\n        let chartType = this.getChartType();\n        let useMeasureAsOrdinal = useMeasureOnYAxisAsOrdinal(chartType);\n        return (!this.isYAxisMeasure() && !this.isYAxisDateOrTime()) || useMeasureAsOrdinal;\n    }\n    /**\n     * Returns true if the chart data is primarily sorted on the x-axis column.\n     *\n     * @return {boolean}\n     */\n    isPrimarySortOnXAxisColumns() {\n        return ChartModel_1.isPrimarySortOnXAxisColumns(this._xAxisColumns, this._yAxisColumns);\n    }\n    /**\n     * Returns a list of values of all x-axis columns for a given index x.\n     * Note that unlike legends we can't map between formatted composite value\n     * and raw data because the formatted composite value can change over time\n     * (even without chart reload), e.g., in a time series granularity decreased\n     * with the decrease in the width available to the chart.\n     * @param x {Number} the index in unique x values' list\n     * @returns {Array}\n     */\n    getRawXAxisValues(x) {\n        if (!this.isXAxisOrdinalBased()) {\n            return [x];\n        }\n        let rawValues = this._dataModel.xValueToRawValues[x];\n        if (!rawValues) {\n            this._logger.warn('no raw values found for formatted x-axis value', x);\n        }\n        return rawValues.map(function (valueObjects) {\n            return valueObjects.value;\n        });\n    }\n    /**\n     *  Returns a value for a given index y, and a given column from the y-axis underlying coluns\n     *  Currently the mapping of y values is different from the mapping of x values, which\n     *  brings a different implementation for this method\n     *\n     * @param y {Number} the index or value of the unique y values list\n     * @param column {ColumnModel} column of the y axis\n     * @returns value - Single value for the given axis and column\n     */\n    getRawYAxisValueForColumn(y, column) {\n        // Note that there is no sense in returning the two values of the differents columns\n        // of the y axis. These values are not grouped, like in x axis, you just have\n        // 2 different y axises. This explains the added column parameter, which is\n        // needed to discriminate between the different columns of the y-axis\n        // if column is numeric, we already have the good value\n        if (column.isEffectivelyNumeric()) {\n            return y;\n        }\n        // if column is not numeric, we must fetch the value\n        let rawValue = this._dataModel.yValueToRawValues[column.getDataRowIndex()][y].value;\n        if (!rawValue) {\n            this._logger.warn('no raw values found for formatted y-axis value', y);\n        }\n        return rawValue;\n    }\n    getRawLegendValues(compositeLegendValue) {\n        let rawValues = this._dataModel.compositeLegendValueToRawValues[compositeLegendValue];\n        if (!rawValues) {\n            this._logger.warn('no raw values found for formatted legend value', compositeLegendValue);\n        }\n        return rawValues;\n    }\n    getLegendColumnValues() {\n        return this._dataModel.uniqueLegendValues || [];\n    }\n    columnHasInfinityValues(column) {\n        return this._dataModel.columnHasInfinityValues[column.getDataRowIndex()];\n    }\n    columnHasMinusInfinityValues(column) {\n        return this._dataModel.columnHasMinusInfinityValues[column.getDataRowIndex()];\n    }\n    getInfinityPlaceholder(column) {\n        return this._dataModel.columnInfinityPlaceholder[column.getDataRowIndex()];\n    }\n    getNegativeInfinityPlaceholder(column) {\n        return this._dataModel.columnNegativeInfinityPlaceholder[column.getDataRowIndex()];\n    }\n    getContextOptions() {\n        return this._contextOptions || {};\n    }\n    setContextOptions(newOptions) {\n        if (!this._contextOptions) {\n            this._contextOptions = {};\n        }\n        $.extend(true, this._contextOptions, newOptions);\n    }\n    _getXAxisValuesAt(x) {\n        return this._dataModel.xValueToRawValues[x];\n    }\n    _getYAxisValuesAt(colIdx, y) {\n        let columnValues = this._getYAxisRowValuesAtCol(colIdx);\n        if (columnValues) {\n            return columnValues[y];\n        }\n    }\n    _hasXAxisValuesAt(x) {\n        return this._dataModel.xValueToRawValues.hasOwnProperty(x);\n    }\n    hasCaptionValuesForXAxis() {\n        let xValueToRawValues = this._dataModel.xValueToRawValues;\n        if (xValueToRawValues) {\n            return xValueToRawValues.some(ChartModel_1.extractCaptionTitleAndLink);\n        }\n        return false;\n    }\n    hasCaptionValuesForYAxis(colIdx) {\n        let yValueToRawValues = this._dataModel.yValueToRawValues[colIdx];\n        if (yValueToRawValues) {\n            return yValueToRawValues.some(ChartModel_1.extractCaptionTitleAndLink);\n        }\n        return false;\n    }\n    captionValuesForXAxisAt(x) {\n        let valueAtX = this._getXAxisValuesAt(x);\n        if (valueAtX) {\n            return ChartModel_1.extractCaptionTitleAndLink(valueAtX);\n        }\n    }\n    captionValuesForYAxisAt(colIdx, y) {\n        let valueAtY = this._getYAxisValuesAt(colIdx, y);\n        if (valueAtY) {\n            return ChartModel_1.extractCaptionTitleAndLink(valueAtY);\n        }\n    }\n    getXAxisColumnLabelAt(x) {\n        let firstXAxisColumn = this.getXAxisColumns()[0];\n        let useMeasureAsOrdinal = useMeasureOnXAxisAsOrdinal(this.getChartType());\n        if (this.isXAxisMeasure()) {\n            let value = !useMeasureAsOrdinal ? x : this._getXAxisValuesAt(x)[0].value;\n            return this.getLabelForNumericColumn(x, firstXAxisColumn.getId(), undefined, { noShorten: !this.isRoundedNumbersEnabled() });\n        }\n        if (!_.isInteger(x) && !this.isTimeSeries()) {\n            return '';\n        }\n        if (this.isTimeSeries()) {\n            let timestampValue, isXAxisOrdinalBased = this.isXAxisOrdinalBased();\n            if (!isXAxisOrdinalBased) {\n                timestampValue = x;\n            }\n            else {\n                if (!this._hasXAxisValuesAt(x)) {\n                    return '';\n                }\n                timestampValue = this._getXAxisValuesAt(x)[0].value;\n            }\n            if (flags.getValue(flags.BLINK_FLAGS.enableChartConfigV2.name)) {\n                //todo: not reverting it at present might have to add back for SCAL-44771\n                //todo: look at this after design changes as part of SCAL-44771\n                let format = this.getFormattingForColumn(firstXAxisColumn.getId());\n                if (format) {\n                    let formattedValue = formatDateByFormatConfig(timestampValue, format);\n                    return formattedValue;\n                }\n            }\n            return firstXAxisColumn.getDataFormatter()(timestampValue);\n        }\n        let xValues = this._getXAxisValuesAt(x);\n        if (_.isUndefined(xValues)) {\n            this._logger.everyN(Logger.LogLevel.WARN, 10, 'invalid x-axis value', x);\n            return '';\n        }\n        return formatCompositeColumnValue(this, xValues);\n    }\n    // TODO (Ashish): Move this label naming/handling logic to its own service.\n    getXAxisLabelAt(x, allXValuesOnLabels, options) {\n        let xAxis = this.getXAxes()[0];\n        let firstXAxisColumn = this.getXAxisColumns()[0];\n        let useMeasureAsOrdinal = useMeasureOnXAxisAsOrdinal(this.getChartType());\n        if (this.isXAxisMeasure()) {\n            // for measure x-axis we pass on real x-values to highcharts\n            // iff the column is sorted, we use index-in-array approach otherwise.\n            // we want to, however, format the real value as number in both the cases\n            if (!useMeasureAsOrdinal) {\n                return this.getLabelForNumericAxis(x, xAxis.id, allXValuesOnLabels, { noShorten: !this.isRoundedNumbersEnabled() });\n            }\n            else {\n                // highcharts can send an index value that is 1 more than\n                // the number of values we have.\n                // Note(sunny): this check is redundant after the fix for SCAL-4695\n                if (!this._hasXAxisValuesAt(x)) {\n                    return '';\n                }\n                // mapping all labels on the x-axis for each label makes this\n                // a quadratic cost call but it is okay because the number of labels\n                // on the x-axis is never too high.\n                let self = this, realXValues = allXValuesOnLabels && _.compact(allXValuesOnLabels.map(function (index) {\n                    if (!self._hasXAxisValuesAt(index)) {\n                        return null;\n                    }\n                    return self._getXAxisValuesAt(index)[0].value;\n                }));\n                return this.getLabelForNumericAxis(this._getXAxisValuesAt(x)[0].value, xAxis.id, realXValues, { noShorten: !this.isRoundedNumbersEnabled() });\n            }\n        }\n        // on zooming in too much highcharts can try to generate intermediate points\n        // for everything but ascending timeseries we are going to look up this value\n        // in our array of raw values and don't allow generated intermediate values\n        if (!_.isInteger(x) && !this.isTimeSeries()) {\n            return '';\n        }\n        // highcharts doesn't like x-axis in descending order so we can't use raw timestamp values\n        // for timeseries (so we use index-in-data-array approach).\n        // However we still want to use formatting for descending timeseries\n        // so we handle that case specially in the same code branch\n        if (this.isTimeSeries()) {\n            // NOTE(vibhor): If the data is not primarily sorted on the date column,\n            // then we can't really show a bucketed timeseries axis.\n            // This is because 2 labels such as \"Q2 1992\" and \"Q1 1993\" gives an impression\n            // that the data point between the 2 labels fit in that timeframe.\n            // However, if the data is sorted on some other key, then this is not necessarily true.\n            let timestampValue, isXAxisOrdinalBased = this.isXAxisOrdinalBased();\n            if (!isXAxisOrdinalBased) {\n                timestampValue = x;\n            }\n            else {\n                if (!this._hasXAxisValuesAt(x)) {\n                    return '';\n                }\n                timestampValue = this._getXAxisValuesAt(x)[0].value;\n            }\n            if (flags.getValue(flags.BLINK_FLAGS.enableChartConfigV2.name)) {\n                let axis = this.getXAxes()[0];\n                let format = this.getFormattingForAxis(axis.id);\n                if (format) {\n                    let formattedValue = formatDateByFormatConfig(timestampValue, format);\n                    return formattedValue;\n                }\n            }\n            return firstXAxisColumn.getDataFormatter()(timestampValue, options);\n        }\n        // TODO(vibhor): This function should look for any overlapping labels\n        // and use a different format if possible.\n        // Today, we simply use formattingConstants.MAX_LABEL_LENGTH to truncate.\n        // The biggest date format should be under that limit.\n        let xValues = this._getXAxisValuesAt(x);\n        if (_.isUndefined(xValues)) {\n            this._logger.everyN(Logger.LogLevel.WARN, 10, 'invalid x-axis value', x);\n            return '';\n        }\n        return formatCompositeAxisValue(this, xValues);\n    }\n    getYAxisLabelForAttribute(column, y) {\n        if (column.isDateColumn() || column.isTimeColumn()) {\n            if (this.isYAxisOrdinalBased()) {\n                y = this._getYAxisValuesAt(column.getDataRowIndex(), y);\n                // highchart can choose to add a tick that is outside the domain of y axis\n                // in that case, we have no value for it\n                if (!y || !y.value) {\n                    return strings.NULL_VALUE_PLACEHOLDER_LABEL;\n                }\n                y = y.value;\n            }\n            return formatDate(y, column.getFormatPattern());\n        }\n        let yValue = this._getYAxisValuesAt(column.getDataRowIndex(), y);\n        // We need this check as sometimes highcharts calls formatter with value: -1\n        if (!yValue) {\n            return;\n        }\n        if (!yValue.value) {\n            return (yValue.value === 0) ? 0 : strings.NULL_VALUE_PLACEHOLDER_LABEL;\n        }\n        return yValue.value;\n    }\n    /**\n     * @param {Object} params\n     * @param {VisualizationColumnModel} params.yAxisColumn\n     * @param {number} params.y  the y value to return formatted label for\n     * @param {Array.<number>=} params.allYValuesOnLabels all y values that will be shown\n     * on the y-axis.\n     * When this array is provided extra shortening is done on the label if it can be\n     * determined (using allYValuesOnLabels) that the shortening won't cause information loss.\n     * @param {Object=} params.formattingOverrides overrides to be passed to numericFormatter.\n     * @returns {*}\n     */\n    getYAxisLabel(params) {\n        let yAxisColumn = params.yAxisColumn, y = params.y, allYValuesOnLabels = params.allYValuesOnLabels || [], formattingOverrides = params.formattingOverrides || {};\n        return ChartModel_1.getLabelForNumericColumn(y, yAxisColumn, allYValuesOnLabels, formattingOverrides);\n    }\n    getMaxXValue(xAxisColumn) {\n        const queryIndex = xAxisColumn.getQueryIndex();\n        const dataRowIndex = xAxisColumn.getDataRowIndex();\n        if (!this.isXAxisMeasure() && !this._isXAxisDate()) {\n            this._logger.error('max/min of x axis is supported only when x-axis is a measure/date');\n            return Number.POSITIVE_INFINITY;\n        }\n        return _.get(this._dataModel.maxColumnValues, `${queryIndex}.${dataRowIndex}`);\n    }\n    getMinXValue(xAxisColumn) {\n        const queryIndex = xAxisColumn.getQueryIndex();\n        const dataRowIndex = xAxisColumn.getDataRowIndex();\n        if (!this.isXAxisMeasure() && !this._isXAxisDate()) {\n            this._logger.error('max/min of x axis is supported only when x-axis is a measure/date');\n            return Number.NEGATIVE_INFINITY;\n        }\n        return _.get(this._dataModel.minColumnValues, `${queryIndex}.${dataRowIndex}`);\n    }\n    getMaxYValue(yAxisColumn) {\n        const queryIndex = yAxisColumn.getQueryIndex();\n        const dataRowIndex = yAxisColumn.getDataRowIndex();\n        if (!!this._dataModel.maxColumnValues && dataRowIndex >= 0) {\n            let maxValue = _.get(this._dataModel.maxColumnValues, `${queryIndex}.${dataRowIndex}`);\n            return isNaN(maxValue) ? Number.POSITIVE_INFINITY : maxValue;\n        }\n        return Number.POSITIVE_INFINITY;\n    }\n    getMinYValue(yAxisColumn) {\n        const queryIndex = yAxisColumn.getQueryIndex();\n        const dataRowIndex = yAxisColumn.getDataRowIndex();\n        if (!!this._dataModel.minColumnValues && dataRowIndex >= 0) {\n            let minValue = _.get(this._dataModel.minColumnValues, `${queryIndex}.${dataRowIndex}`);\n            return isNaN(minValue) ? Number.NEGATIVE_INFINITY : minValue;\n        }\n        return Number.NEGATIVE_INFINITY;\n    }\n    getMaxRadialValue() {\n        return this.getMaxYValue(this.getRadialColumn());\n    }\n    getMinRadialValue() {\n        return this.getMinYValue(this.getRadialColumn());\n    }\n    equals(that) {\n        if (this === that) {\n            return true;\n        }\n        // Hack(sunny): Models with Json marked as dirty are not equal to any other model\n        // This is used to refresh the model/chart locally (e.g. in case of axes change)\n        let thisJson = this.getJson();\n        if (thisJson._backendConfigChanged) {\n            delete thisJson._backendConfigChanged;\n            return false;\n        }\n        let thatJson = that.getJson();\n        if (thatJson._backendConfigChanged) {\n            delete thatJson._backendConfigChanged;\n            return false;\n        }\n        if (!VisualizationModel.areModelsEqual(this, that)) {\n            return false;\n        }\n        return true;\n    }\n    // i am unsure of the semantic of this method ( do we consider highchart legend\n    // as a legend ? )\n    downloadedChartContainsLegend() {\n        return this.hasLegend();\n    }\n    /**\n     *\n     * Whether this chart display a legend\n     *\n     * @returns {boolean}\n     */\n    hasLegend() {\n        // TODO(chab) seems that we can simply by using directy getLegendCardinality\n        // We can only show a legend control for chart which has either one or more\n        // legend columns or multiple y-axes.\n        let options = configOptions(this.chartType, this);\n        if (options.doNotShowLegend) {\n            return false;\n        }\n        else {\n            if (hasPersistentLegend(this.chartType)) {\n                return true;\n            }\n            else {\n                return !(this.getLegendCardinality() <= 1);\n            }\n        }\n    }\n    getBatchSize() {\n        let chartSpecificBatchSize;\n        return flags.getValue(flags.BLINK_FLAGS.dataBatchSize.name)\n            || super.getBatchSize();\n    }\n    isDataSetComplete() {\n        return this.getDefaultQueryData().length === this.getTotalRowCount()\n            && this.getSamplingRatio() === 1;\n    }\n    isYAxisStackedAsPercent() {\n        return !!this.getUserData(jsonConstants.IS_STACKED_AS_PERCENT);\n    }\n    toggleShowYAxisAsPercent() {\n        if (this.isYAxisStackedAsPercent()) {\n            this.clearUserData(jsonConstants.IS_STACKED_AS_PERCENT);\n        }\n        else {\n            this.setUserData(jsonConstants.IS_STACKED_AS_PERCENT, true);\n        }\n    }\n    isHeatmapOverlayed() {\n        return !!this.getUserData(jsonConstants.IS_HEATMAP_OVERLAYED);\n    }\n    setIsHeatmapOverlayed(isOverlayed = false) {\n        this.setUserData(jsonConstants.IS_HEATMAP_OVERLAYED, isOverlayed);\n    }\n    get pivotState() {\n        return this.getUserData(jsonConstants.pivotConfig.PIVOT_STATE);\n    }\n    set pivotState(state) {\n        this.setUserData(jsonConstants.pivotConfig.PIVOT_STATE, state);\n    }\n    getDefaultQueryData() {\n        let dataArray = this.getDataArray();\n        let defaultQueryData = dataArray && dataArray[0];\n        return defaultQueryData && defaultQueryData.getData();\n    }\n    getAutoTitle() {\n        let yAxisColumns = this.getYAxisColumns();\n        let xAxisColumns = this.getXAxisColumns();\n        let legendColumns = this.getLegendColumns();\n        let radialColumn = this.getRadialColumn();\n        let title = yAxisColumns.map((column) => {\n            return column.getName();\n        }).join(', ');\n        if (radialColumn) {\n            title += ' ';\n            title += strings.AND;\n            title += ' ';\n            title += radialColumn.getName();\n        }\n        title += ' ';\n        title += strings.BY;\n        title += ' ';\n        title += xAxisColumns.map((column) => {\n            return column.getName();\n        }).join(', ');\n        if (legendColumns && legendColumns.length) {\n            title += ' ';\n            title += strings.AND;\n            title += ' ';\n            title += legendColumns.map((column) => {\n                return column.getName();\n            }).join(', ');\n        }\n        return title;\n    }\n    //region Chart Configuration\n    // This section contains function related to changes to chart type and axis config.\n    getCurrentAxisConfig() {\n        return {\n            xAxisColumns: this.getXAxisColumns(),\n            yAxisColumns: this.getYAxisColumns(),\n            legendColumns: this.getLegendColumns(),\n            radialColumn: this.getRadialColumn()\n        };\n    }\n    setAllowChartTypeChangeOnDataLoad(allowChartTypeChangeOnDataLoad) {\n        this.allowChartTypeChangeOnDataLoad = allowChartTypeChangeOnDataLoad;\n    }\n    isHighchartsProvider() {\n        return getChartProvider(this.chartType) === chartProviders.HIGHCHART;\n    }\n    getYSEOPConfig() {\n        let yseopConfig = {\n            extensionVersion: '2',\n            charts: []\n        };\n        let chartConfig = getYSEOPConfig(this);\n        yseopConfig.charts.push(chartConfig);\n        return yseopConfig;\n    }\n    getXAxisColumnsHash() {\n        return this.getXAxisColumns()\n            .map((col) => {\n            return col.getGuid();\n        })\n            .join(',');\n    }\n    isAxisConfigSame(chartModel) {\n        let currentConfig = this.getAxisConfig();\n        let newConfig = chartModel.getAxisConfig();\n        return currentConfig.isAxisConfigEqual(newConfig);\n    }\n    isSerieVisible(serieName) {\n        let serie = this.getSerie(serieName);\n        return !serie ? false : serie.visible;\n    }\n    isOnlySelectedSeries(serieName) {\n        return this.getSeries()\n            .every((s) => s.name === serieName ?\n            this.isSerieVisible(s.name) :\n            !this.isSerieVisible(s.name));\n    }\n    getSerie(serieName) {\n        return !!this._dataModel._seriesMap ? this._dataModel._seriesMap[serieName] : '';\n    }\n    updateLegendVisibilityState() {\n        let series = this.getSeries();\n        let visibleSeriesIds = series\n            .filter((serie) => this.isSerieVisible(serie.name))\n            .map(serie => serie.blinkSeriesId);\n        this.setVisibleSeriesIds(visibleSeriesIds);\n    }\n    getSeriesColor(serieName) {\n        let serie = this.getSerie(serieName);\n        return (!serie || !serie.color) ? '' : serie.color;\n    }\n    //TODO: can set some sort of mapping for attributes to colors to make this smoother\n    // further it can be saved system wide, so that it can be re-used let's say at pinboard level\n    configureColors(colors, onColorSelect, chartRedraw) {\n        const specConfigOptions = configOptions(this.chartType, void 0);\n        const colorsConfig = [];\n        if (specConfigOptions.allowedConfigurations.useCustomColorSelector) {\n            let result = customColorSelectorConfig(this.chartType, this, colors, onColorSelect);\n            _.reduce(result, (resultObject, colorDataObject, idx) => {\n                let colorSelectOption = {\n                    caption: colorDataObject.label,\n                    selectedColor: colorDataObject.color,\n                    closeCallback: (color) => {\n                        colorDataObject.closeCallback(color);\n                        onColorSelect(color, idx);\n                    }\n                };\n                if (colorSelectOption.selectedColor) {\n                    resultObject.push(colorSelectOption);\n                }\n                else {\n                    this._logger.warn('Color not selected for the attribute ' + idx +\n                        'in custom color selector');\n                }\n                return resultObject;\n            }, colorsConfig);\n        }\n        else if (specConfigOptions.allowedConfigurations.configureColorForXAttrs) {\n            _.reduce(this.getDataModel()._xValueToRawValues, (result, rawValue, idx) => {\n                let label = this.getXAxisLabelAt(idx, void 0, void 0);\n                let colorSelectOption = {\n                    caption: label,\n                    selectedColor: colors[idx],\n                    closeCallback: (color) => {\n                        this.setSeriesColor(label, color);\n                        onColorSelect(color, idx);\n                    }\n                };\n                if (colorSelectOption.selectedColor) {\n                    result.push(colorSelectOption);\n                }\n                return result;\n            }, colorsConfig);\n        }\n        else {\n            _.reduce(this.getLegendLabels(), (result, legendLabel) => {\n                let label = legendLabel.label;\n                let colorSelectOption = {\n                    caption: label,\n                    selectedColor: this.getSeriesColor(label),\n                    closeCallback: (color) => {\n                        let serieId = this.getSerie(label).blinkSeriesId;\n                        this.setSeriesColor(serieId, color);\n                        chartRedraw();\n                    }\n                };\n                if (colorSelectOption.selectedColor) {\n                    result.push(colorSelectOption);\n                }\n                return result;\n            }, colorsConfig);\n        }\n        return colorsConfig;\n    }\n    getLegendLabels() {\n        return getLegendLabels(this);\n    }\n    updateAxisConfig(chartAxisConfig) {\n        // reset legend if needed\n        if (!areArraysSameSet(chartAxisConfig.legendColumns, this.getLegendColumns())) {\n            this.clearVisibleSeriesIds();\n        }\n        let yAxisColumns = this.getYAxisColumns();\n        let hasMultiYAxisLegend = !!yAxisColumns ? yAxisColumns.length > 1 : false;\n        if (hasMultiYAxisLegend\n            && !areArraysSameSet(chartAxisConfig.yAxisColumns, yAxisColumns)) {\n            this.clearVisibleSeriesIds();\n        }\n        if (isGeoChartType(this.chartType)) {\n            let xAxisColumns = this.getXAxisColumns();\n            if (!areArraysSameSet(chartAxisConfig.xAxisColumns, xAxisColumns)) {\n                this.clearMapViewport();\n            }\n        }\n        this._xAxisColumns = chartAxisConfig.xAxisColumns;\n        this._yAxisColumns = chartAxisConfig.yAxisColumns;\n        this._legendColumns = chartAxisConfig.legendColumns;\n        this._radialColumn = chartAxisConfig.radialColumn;\n        this.upgradeClientState();\n    }\n    //Column properties in client state\n    setShowDataLabels(enabled, columnId) {\n        let columnProperties = this.getColumnProperties() || {};\n        if (!columnProperties[columnId]) {\n            columnProperties[columnId] = {};\n        }\n        columnProperties[columnId].dataLabels = enabled;\n        this.setColumnProperties(columnProperties);\n        // TODO(Jasmeet): Remove when we are done with chart config migration\n        if (isStackedChart(this.getChartType())) {\n            this.setUserData('detailedLabels', !!enabled);\n        }\n        else {\n            this.setUserData('dataLabels', !!enabled);\n        }\n    }\n    getShowDataLabels(columnId) {\n        let columnProperties = this.getColumnProperties();\n        return columnProperties\n            && columnProperties[columnId]\n            && columnProperties[columnId].dataLabels;\n    }\n    //This is to support backward compatibility with chart config v1\n    isDataLabelsEnabledUndefined() {\n        return _.isUndefined(this.getShowDataLabels(Object.keys(this.getColumnProperties())[0]));\n    }\n    getShowStackedLabels() {\n        let chartProperties = this.getChartProperties();\n        return chartProperties\n            && chartProperties.showStackedLabels;\n    }\n    setShowStackedLabels(enabled) {\n        if (enabled) {\n            let chartProperties = this.getChartProperties();\n            if (!chartProperties) {\n                this.setChartProperties({});\n            }\n            this.getChartProperties().showStackedLabels = true;\n        }\n        else {\n            let chartProperties = this.getChartProperties();\n            if (chartProperties) {\n                delete chartProperties.showStackedLabels;\n            }\n        }\n        // TODO(Jasmeet): Remove when we are done with chart config migration\n        this.setUserData('dataLabels', !!enabled);\n    }\n    getShowRegressionLine() {\n        return !!this.getChartProperties() && !!this.getChartProperties().showLinearRegressionLine;\n    }\n    setShowRegressionLine(enabled) {\n        if (enabled) {\n            let chartProperties = this.getChartProperties();\n            if (!chartProperties) {\n                this.setChartProperties({});\n            }\n            this.getChartProperties().showLinearRegressionLine = true;\n            // TODO(Jasmeet): Remove when are done with chart config migration\n            this.setUserData(jsonConstants.SHOW_LINEAR_REGRESSION_LINE, true);\n        }\n        else {\n            let chartProperties = this.getChartProperties();\n            if (chartProperties) {\n                delete chartProperties.showLinearRegressionLine;\n            }\n            // TODO(Jasmeet): Remove when are done with chart config migration\n            this.clearUserData(jsonConstants.SHOW_LINEAR_REGRESSION_LINE);\n        }\n    }\n    setFormattingForColumn(format, columnId) {\n        let columnProperties = this.getColumnProperties();\n        if (!columnProperties[columnId]) {\n            columnProperties[columnId] = {};\n        }\n        columnProperties[columnId][CLIENT_STATE_KEYS.format] = format;\n        this.setColumnProperties(columnProperties);\n    }\n    //Axis properties in client state\n    setFormattingForAxis(format, axisId) {\n        let axisProperties = this.getAxisProperties();\n        if (!axisProperties[axisId]) {\n            this._logger.error('To set formatting for axis, the axis must already exist');\n        }\n        axisProperties[axisId][CLIENT_STATE_KEYS.format] = format;\n        this.setAxisProperties(axisProperties);\n    }\n    getGroupedColumnsForAxis(axisId) {\n        return _.get(this.getAxisProperties(), `${axisId}.${CLIENT_STATE_KEYS.linkedColumns}`, []);\n    }\n    getAxisRange(axisId) {\n        return _.get(this.getAxisProperties(), `${axisId}.${CLIENT_STATE_KEYS.yAxisRange}`, undefined);\n    }\n    setAxisRange(axisId, range) {\n        let deleteRange = !range || (_.isUndefined(range.max) && _.isUndefined(range.min));\n        let axisProperties = this.getAxisProperties()[axisId];\n        if (!axisProperties) {\n            this._logger.error('If range is being set axis should already exist');\n        }\n        if (deleteRange) {\n            delete axisProperties.yAxisRange;\n        }\n        else {\n            axisProperties.yAxisRange = range;\n        }\n        // TODO(Jasmeet): Remove when are done with chart config migration\n        this.setUserData('yAxisRange', range);\n    }\n    groupAxis(fromAxisId, toAxisId) {\n        let axisProperties = this.getAxisProperties();\n        let fromLinkedColumns = axisProperties[fromAxisId][CLIENT_STATE_KEYS.linkedColumns];\n        let toLinkedColumns = axisProperties[toAxisId][CLIENT_STATE_KEYS.linkedColumns];\n        let newLinkedColumns = fromLinkedColumns.concat(toLinkedColumns);\n        //TODO::Need to figure out what happens to YAxisRange or any other property that gets\n        // affected\n        delete axisProperties[toAxisId];\n        axisProperties[fromAxisId][CLIENT_STATE_KEYS.linkedColumns] = newLinkedColumns;\n    }\n    ungroupAxis(axisId) {\n        const axisProperties = this.getAxisProperties();\n        if (!axisProperties[axisId]) {\n            this._logger.error('Axis must be present to ungroup it');\n        }\n        const columnIds = axisProperties[axisId].linkedColumns;\n        const axisPropertiesToInherit = _.omit(axisProperties[axisId], [\n            CLIENT_STATE_KEYS.name, CLIENT_STATE_KEYS.axisType, CLIENT_STATE_KEYS.linkedColumns\n        ]);\n        const isOpposite = axisProperties[axisId].isOpposite;\n        delete axisProperties[axisId];\n        columnIds.forEach((colId) => this.addColumnToNewYAxis(colId, axisPropertiesToInherit));\n    }\n    getAxes() {\n        return _.transform(this.getAxisProperties(), (axesByType, axis, axisId) => {\n            axesByType.push({\n                id: axisId,\n                properties: axis\n            });\n        }, []);\n    }\n    getXAxes() {\n        return this.getAxes().filter(axis => axis.properties.axisType === AXIS_TYPES.X);\n    }\n    getYAxes() {\n        return this.getAxes().filter(axis => axis.properties.axisType === AXIS_TYPES.Y);\n    }\n    hasUserMadeConfigChanges() {\n        let currentClientState = {};\n        let keys = [\n            CLIENT_STATE_KEYS.chartProperties,\n            CLIENT_STATE_KEYS.columnProperties,\n            CLIENT_STATE_KEYS.axisProperties\n        ];\n        keys.forEach((key) => {\n            if (this.getUserData(key)) {\n                currentClientState[key] = this.getUserData(key);\n            }\n        });\n        return !_.isEqual(this.originalClientState, currentClientState);\n    }\n    getLinkedColumnsForColumn(columnId) {\n        let axis = this.getYAxes()\n            .find(axis => axis.properties.linkedColumns.some(col => col === columnId));\n        if (!axis) {\n            // column does not belong in any Y axis\n            return [];\n        }\n        return axis.properties.linkedColumns;\n    }\n    addColumnToNewYAxis(columnId, properties) {\n        let axisProperties = this.getAxisProperties();\n        axisProperties[generateUUID()] = _.assign({\n            linkedColumns: [columnId],\n            axisType: AXIS_TYPES.Y\n        }, properties);\n        this.setAxisProperties(axisProperties);\n    }\n    removeColumnFromYAxis(columnId) {\n        let axisProperties = this.getAxisProperties();\n        let axisId = this.getAxisForColumn(columnId).id;\n        _.remove(axisProperties[axisId].linkedColumns, col => col === columnId);\n        if (!axisProperties[axisId].linkedColumns.length)\n            delete axisProperties[axisId];\n        this.setAxisProperties(axisProperties);\n    }\n    addColumnToXAxis(columnId) {\n        let axisProperties = this.getAxisProperties();\n        let axis = this.getXAxes()[0];\n        axisProperties[axis.id].linkedColumns = axisProperties[axis.id]\n            .linkedColumns\n            .concat(columnId);\n        this.setAxisProperties(axisProperties);\n    }\n    removeColumnFromXAxis(columnId) {\n        let axisProperties = this.getAxisProperties();\n        let axisId = this.getAxisForColumn(columnId).id;\n        _.remove(axisProperties[axisId].linkedColumns, col => col === columnId);\n        this.setAxisProperties(axisProperties);\n    }\n    getLabelForNumericAxis(value, axisId, allColumnValuesOnAxis, formattingOverrides) {\n        let column = this.getColumn(this.getGroupedColumnsForAxis(axisId)[0]);\n        if (flags.getValue(flags.BLINK_FLAGS.enableChartConfigV2.name)) {\n            let format = this.getFormattingForAxis(axisId);\n            if (format) {\n                let formattedValue = getValueFormattedByConfig(value, format);\n                return formattedValue;\n            }\n        }\n        return ChartModel_1.getLabelForNumericColumn(value, column, allColumnValuesOnAxis, formattingOverrides);\n    }\n    getLabelForNumericColumn(value, column, allColumnValuesOnAxis, formattingOverrides) {\n        let format = this.getFormattingForColumn(column.getId());\n        if (format) {\n            let formattedValue = getValueFormattedByConfig(value, format);\n            return formattedValue;\n        }\n        return ChartModel_1.getLabelForNumericColumn(value, column, allColumnValuesOnAxis, formattingOverrides);\n    }\n    setAxisName(axisId, name) {\n        let axisProperties = this.getAxisProperties();\n        if (!axisProperties[axisId]) {\n            this._logger.error('Axis must already exist to set name');\n        }\n        _.set(axisProperties, [axisId, 'name'], name);\n        this.setAxisProperties(axisProperties);\n    }\n    getAxisName(axisId) {\n        let axisProperties = this.getAxisProperties();\n        let axis = axisProperties[axisId];\n        return axis.name || axis\n            .linkedColumns\n            .map(colId => this\n            .getColumn(colId)\n            .getName())\n            .join(strings.axisname.concatenator.symbol);\n    }\n    setAxisPosition(axisId, isOpposite) {\n        const axisProperties = this.getAxisProperties();\n        if (!axisProperties[axisId]) {\n            this._logger.error('Axis must be present to set its position');\n        }\n        axisProperties[axisId].isOpposite = isOpposite;\n        this.setAxisProperties(axisProperties);\n    }\n    getAxisDefaultName(axisId) {\n        let axisProperties = this.getAxisProperties();\n        if (axisProperties[axisId]) {\n            return axisProperties[axisId].linkedColumns.map((col) => this.getColumn(col).getName())\n                .join(_.get(strings, 'axisname.concatenator.symbol'));\n        }\n        return null;\n    }\n    getAxisForColumn(columnId) {\n        return this.getAxes().find(axis => axis.properties.linkedColumns.some(col => col === columnId));\n    }\n    getUnvisualizedMustVisualizeColumns() {\n        return _.differenceBy(this.getMustVisualizeColumns(), this.getVisualizedColumns(), c => c.getId());\n    }\n    setChartProperty(key, value) {\n        let chartProperties = this.getChartProperties();\n        chartProperties[key] = value;\n        this.setChartProperties(chartProperties);\n    }\n    getChartProperty(key) {\n        return this.getChartProperties()[key];\n    }\n    getChartSpecificProperty(key) {\n        return this.getChartProperty(CLIENT_STATE_KEYS.chartSpecific)[key];\n    }\n    setChartSpecificProperty(key, value) {\n        let chartSpecificProperties = this.getChartProperty(CLIENT_STATE_KEYS.chartSpecific);\n        chartSpecificProperties[key] = value;\n        this.setChartProperty(CLIENT_STATE_KEYS.chartSpecific, chartSpecificProperties);\n    }\n    setColumnProperties(columnProperties) {\n        this.setUserData(CLIENT_STATE_KEYS.columnProperties, columnProperties);\n    }\n    getColumnProperties() {\n        return this.getUserData(CLIENT_STATE_KEYS.columnProperties);\n    }\n    setAxisProperties(axisProperties) {\n        this.setUserData(CLIENT_STATE_KEYS.axisProperties, axisProperties);\n    }\n    getAxisProperties() {\n        return this.getUserData(CLIENT_STATE_KEYS.axisProperties);\n    }\n    setChartProperties(chartProperties) {\n        this.setUserData(CLIENT_STATE_KEYS.chartProperties, chartProperties);\n    }\n    getChartProperties() {\n        return this.getUserData(CLIENT_STATE_KEYS.chartProperties);\n    }\n    getChartTypeWithNoDataErrors() {\n        let axisConfig = this.getCurrentAxisConfig();\n        let self = this;\n        let previousChartType = this.getChartType();\n        //TODO(Jasmeet):\n        // 1. More elaborated check for type ?\n        // 2. Capability to initialize New datamodel from raw data without incurring a\n        // network call.\n        let chartType = chartTypesInDisplayOrder.find(function (chartType) {\n            let isConfigValid = validateAxisConfig(chartType, axisConfig);\n            if (!isConfigValid) {\n                return false;\n            }\n            let dataError = getChartDataValidationError(self, chartType);\n            let isNewProviderCompatible = areProvidersEqual(previousChartType, chartType);\n            return !dataError && isNewProviderCompatible;\n        });\n        return chartType;\n    }\n    //endregion\n    parseDefinition(chartModel) {\n        let handleBackwardCompatibility = function () {\n            let estimatedCardinality = chartModel._xAxisColumns[0].getUniqueCount();\n            if (estimatedCardinality > -1 && estimatedCardinality < 12) {\n                chartModel.chartType = chartTypes.COLUMN;\n            }\n            else {\n                chartModel.chartType = chartTypes.LINE;\n            }\n            let axisConfig = new ChartAxisConfig(chartModel._xAxisColumns, chartModel._yAxisColumns, chartModel._legendColumns, chartModel._radialColumn);\n            setBackendConfiguration(chartModel, axisConfig);\n        };\n        // cleanup existing configs.\n        chartModel._xAxisColumns = [];\n        chartModel._yAxisColumns = [];\n        chartModel._legendColumns = [];\n        chartModel._radialColumn = null;\n        // This is possible in the cases like scatter plot with measures\n        // on x and y and the attribute is plotted, but this is not exposed in the axis config.\n        chartModel._columnsInChartDataNotOnAnyAxis = [];\n        let chartJson = chartModel.getJson();\n        if (!!chartJson.chartType) {\n            chartModel.chartType = chartJson.chartType;\n        }\n        let allColumns = chartModel.getColumns();\n        let backendConfigInfo = getBackendConfiguration(chartModel);\n        if (backendConfigInfo === false) {\n            chartModel._hasError = true;\n            return;\n        }\n        chartModel._xAxisColumns = backendConfigInfo.xAxisColumns;\n        chartModel._yAxisColumns = backendConfigInfo.yAxisColumns;\n        chartModel._legendColumns = backendConfigInfo.legendColumns;\n        chartModel._radialColumn = backendConfigInfo.radialColumn;\n        chartModel._columnsInChartDataNotOnAnyAxis =\n            backendConfigInfo.columnsInChartDataNotOnAnyAxis;\n        chartModel._columnEffectiveIdToColumn = backendConfigInfo.allColumns\n            .reduce((idToColumnMap, column) => {\n            idToColumnMap[column.getId()] = column;\n            let columnInMap = chartModel._allColumnsMap[column.getId()];\n            column.isMustVisualize = !!columnInMap && columnInMap.isMustVisualize;\n            return idToColumnMap;\n        }, {});\n        _.extend(chartModel._allColumnsMap, chartModel._columnEffectiveIdToColumn);\n        chartModel._queryDefinitions = backendConfigInfo.queryDefinitions;\n        // Update all columns provided by answer with the latest definitions.\n        allColumns.forEach((potentialMatchingColumn, index) => {\n            let matchingColumn = backendConfigInfo.allColumns.find(function (column) {\n                return potentialMatchingColumn.getId() ===\n                    column.getId();\n            });\n            if (!!matchingColumn) {\n                allColumns[index] = matchingColumn;\n            }\n        });\n        // NOTE:\n        // - This is added to support cases if there is any backend which does not\n        // have axis config client state.\n        // - This works as this is set before data is fetched due to liposuction.\n        // - If we need to support this for even without liposuction we need to come\n        // up with new code which computes axis config using all\n        // the provided columns given chart type.\n        // - We also check that this is only done when chart type is set because\n        // this is only needed in case of saved answer.\n        if (!!backendConfigInfo.shouldUpdateBackendConfig && !!chartModel.chartType) {\n            this._logger.warn('Backend Config found with no axis config info,' +\n                ' hence defaulting to basic chart');\n            handleBackwardCompatibility();\n        }\n    }\n    _init() {\n        this._hasError = false;\n        this._unsupportedDataError = null;\n        this.chartType = null;\n        // axis config columns\n        this._xAxisColumns = [];\n        this._yAxisColumns = [];\n        this._legendColumns = [];\n        this._radialColumn = null;\n        // This is possible in the cases like scatter plot with measures on x and y and\n        // the attribute is plotted, but this is not exposed in the axis config.\n        this._columnsInChartDataNotOnAnyAxis = [];\n        this._computedMetaInformation = {};\n        this._hasNoData = !this._vizData.data || this._vizData.data.length === 0;\n        this.parseDefinition(this);\n        this._computedMetaInformation = chartDataProcessor.computeMetaDataInformation(this);\n        if (this._computedMetaInformation === false) {\n            this._hasError = true;\n            return;\n        }\n        // If server doesnt report any chart type then compute defaults.\n        if (!this.chartType || this.hasUnvisualizedMustVisualizeColumns()) {\n            let axisConfigAndChartType = getAxisConfigWithMustVisualizeColumns(this);\n            if (!axisConfigAndChartType) {\n                axisConfigAndChartType = getDefaultAxisConfigAndChartType(this);\n            }\n            // also set this in definition\n            if (!!axisConfigAndChartType.chartType) {\n                this.chartType = axisConfigAndChartType.chartType;\n                this.getJson().chartType = axisConfigAndChartType.chartType;\n                this.allowChartTypeChangeOnDataLoad = true;\n                let newChartAxisConfig = new ChartAxisConfig(axisConfigAndChartType.axisConfig.xAxisColumns, axisConfigAndChartType.axisConfig.yAxisColumns, axisConfigAndChartType.axisConfig.legendColumns, axisConfigAndChartType.axisConfig.radialColumn);\n                this.updateAxisConfig(newChartAxisConfig);\n                this.clearVisibleSeriesIds();\n                // If blink needs to set the axis config then the data from the previous fetch\n                // need not be valid anymore so it is cleared to keep state consistent.\n                this._columnsInChartDataNotOnAnyAxis = [];\n                this._vizData.data = [];\n                this._hasNoData = true;\n                setBackendConfiguration(this, axisConfigAndChartType.axisConfig);\n                this.setAxisProperties(this.generateAxisPropertiesFromAxisConfig());\n            }\n        }\n        this._bestAxisColumnConfigForChartType = computeChartTypesToBestAxisConfigMap(this);\n        // this._xAxisColumns.length is checked for the cases where server sends data\n        // and client decides the chart is not needed and doesnt set the axis config and chart type.\n        if (!this.hasNoData() && this._xAxisColumns.length) {\n            this._dataModel = chartDataProcessor.getDataModel(this);\n            this._unsupportedDataError = getChartDataValidationError(this);\n        }\n        persistChartTypeAndAxisConfig(this);\n        this.upgradeClientState();\n        this.cleanClientState();\n    }\n    hasUnvisualizedMustVisualizeColumns() {\n        return this.getUnvisualizedMustVisualizeColumns().length > 0;\n    }\n    generateAxisPropertiesFromAxisConfig() {\n        let axisProperties = {};\n        let yAxisColumns = this.getYAxisColumns();\n        // If Y axis are shared, we put all axis as one at put columns linked in the state\n        yAxisColumns.forEach(col => {\n            axisProperties[generateUUID()] = {\n                linkedColumns: [col.getId()],\n                axisType: AXIS_TYPES.Y,\n                yAxisRange: this.getUserData(CLIENT_STATE_KEYS.yAxisRange)\n            };\n        });\n        let xAxisColumns = this.getXAxisColumns();\n        axisProperties[generateUUID()] = {\n            linkedColumns: xAxisColumns.map(col => col.getId()),\n            axisType: AXIS_TYPES.X,\n        };\n        return axisProperties;\n    }\n    _measureColumnsHaveComparableRange(col1, col2) {\n        // This is populated after data is processed\n        // so any call before that returns false by default.\n        if (!this._computedMetaInformation || !this._computedMetaInformation.columnIdToMax) {\n            return false;\n        }\n        let colId1 = col1.getId(), colId2 = col2.getId(), max1 = this._computedMetaInformation.columnIdToMax[colId1], min1 = this._computedMetaInformation.columnIdToMin[colId1], max2 = this._computedMetaInformation.columnIdToMax[colId2], min2 = this._computedMetaInformation.columnIdToMin[colId2];\n        return ChartModel_1.areComparableRanges(min1, max1, min2, max2);\n    }\n    cleanClientState() {\n        this.cleanClientStateForKey(jsonConstants.chartClientStateKeys.SERIES_COLORS);\n        this.cleanClientStateForKey(jsonConstants.chartClientStateKeys.MULTI_COLOR_SERIES_COLORS);\n        this.cleanClientStateForKey(jsonConstants.chartClientStateKeys.SYSTEM_SERIES_COLORS);\n        this.cleanClientStateForKey(jsonConstants.chartClientStateKeys\n            .SYSTEM_MULTI_COLOR_SERIES_COLORS);\n    }\n    cleanClientStateForKey(key) {\n        let userData = this.getUserData(key);\n        if (userData) {\n            let acc = Object.keys(userData).reduce((acc, key) => {\n                acc[key.toLowerCase()] = userData[key];\n                return acc;\n            }, {});\n            this.setUserData(key, acc);\n        }\n    }\n};\nChartModel.EFFECTIVE_ID_DEFINITION_SCHEMA_CHANGE_VERSION = '3.4';\nChartModel.extractCaptionTitleAndLink = (valueObjectOrArray) => {\n    /*\n      Possible types for valueObjectORArray are\n       a). string\n       b). object with key 'value'\n       c). array with first object having key 'value'\n\n      For all the possible types of incoming data following will handle the parsing of value\n     */\n    let value = valueObjectOrArray &&\n        _.get(_.castArray(valueObjectOrArray), '0.value', valueObjectOrArray);\n    let captionTitleAndLink = _.isString(value)\n        && value.match(blinkConstants.URL_CAPTION_REGEX);\n    if (captionTitleAndLink) {\n        return {\n            caption: captionTitleAndLink[1],\n            link: value.replace(captionTitleAndLink[0], '')\n        };\n    }\n};\nChartModel = ChartModel_1 = tslib_1.__decorate([\n    Provide('ChartModel')\n], ChartModel);\nexport { ChartModel };\n//# sourceMappingURL=chart-model.js.map","import * as protoRoot from '@thoughtspot/ts-proto';\nimport _ from 'lodash';\nimport { ngRequire } from '../../base/decorators';\nimport { strings } from '../../base/strings';\nimport { FILTER_MODEL_TYPES, FilterModelV3 } from './filter-model';\nlet util = ngRequire('util');\nexport class AttributeFilterModelV3 extends FilterModelV3 {\n    constructor(column, conditions, isCorrupt, id, answerModel) {\n        super(column, conditions, isCorrupt, id, answerModel);\n        this.filterValueCache = {};\n        this.allFilterValueCache = {};\n        this.filterItems = {};\n        this.allFilterItems = {};\n    }\n    getSelectedFilterItems() {\n        if (this.selectedItems !== void 0) {\n            return this.selectedItems;\n        }\n        let selectedFilterCondition = this.conditions\n            .find((filterCondition) => {\n            let operator = filterCondition.condition.op;\n            return !filterCondition.condition.isNegate\n                && (operator === protoRoot.sage.CompareTypeProto.E.EQ\n                    || operator === protoRoot.sage.CompareTypeProto.E.IN);\n        });\n        let selectedValues = !!selectedFilterCondition\n            ? selectedFilterCondition.condition.values\n            : [];\n        this.selectedItems = this.getValueMapFromFilterValues(selectedValues);\n        return this.selectedItems;\n    }\n    getExcludedFilterItems() {\n        if (this.excludedItems !== void 0) {\n            return this.excludedItems;\n        }\n        let excludedFilterCondition = this.conditions\n            .find((filterCondition) => {\n            let operator = filterCondition.condition.op;\n            return (operator === protoRoot.sage.CompareTypeProto.E.NE)\n                || (filterCondition.condition.isNegate\n                    && (operator === protoRoot.sage.CompareTypeProto.E.EQ\n                        || operator === protoRoot.sage.CompareTypeProto.E.IN));\n        });\n        let excludedValues = !!excludedFilterCondition\n            ? excludedFilterCondition.condition.values\n            : [];\n        this.excludedItems = this.getValueMapFromFilterValues(excludedValues);\n        return this.excludedItems;\n    }\n    getFilterDataCache(showAllValues) {\n        return showAllValues ? this.allFilterValueCache : this.filterValueCache;\n    }\n    putFilterDataCache(subString, knownMatches, showAllValues) {\n        let cacheToUpdate = showAllValues ? this.allFilterValueCache : this.filterValueCache;\n        cacheToUpdate[subString] = knownMatches;\n    }\n    getFilterDataCacheValue(subString, showAllValues) {\n        let cacheToUse = showAllValues ? this.allFilterValueCache : this.filterValueCache;\n        return cacheToUse[subString];\n    }\n    updateFilterValues(values, showAllValues) {\n        if (showAllValues) {\n            this.allFilterItems = {};\n        }\n        else {\n            this.filterItems = {};\n        }\n        let itemsToUpdate = showAllValues ? this.allFilterItems : this.filterItems;\n        values.forEach((val) => {\n            let key = util.isSpecialValue(val)\n                ? util.getSpecialFormatData(val)\n                : val;\n            let value = this.getSelectedFilterItems()[val] !== void 0\n                ? this.getSelectedFilterItems()[val]\n                : false;\n            itemsToUpdate[key] = value;\n        });\n    }\n    getFilterItems(showAllValues) {\n        return showAllValues ? this.allFilterItems : this.filterItems;\n    }\n    isSupportedByUI() {\n        if (!super.isSupportedByUI() || this.isFilterNonEditable()) {\n            return false;\n        }\n        let hasContainsFilter = this.conditions.some((filterCondition) => {\n            return filterCondition.condition.op === protoRoot.sage.CompareTypeProto.E.CONTAINS;\n        });\n        if (hasContainsFilter) {\n            return false;\n        }\n        return true;\n    }\n    getFilterValueSummary() {\n        let selectedItems = this.getSelectedFilterItems();\n        let selectedValues = Object.keys(selectedItems);\n        let excludedItems = this.getExcludedFilterItems();\n        let excludedValues = Object.keys(excludedItems);\n        if ((!selectedValues.length && !excludedValues.length)\n            || (selectedItems.length && excludedValues.length)) {\n            return '';\n        }\n        if (selectedValues.length) {\n            return selectedValues.join(', ');\n        }\n        else {\n            return strings.notin + ' ' + excludedValues.join(', ');\n        }\n    }\n    getType() {\n        return FILTER_MODEL_TYPES.ATTRIBUTE;\n    }\n    getValueMapFromFilterValues(values) {\n        let returnVal = {};\n        values.forEach((val) => {\n            let strVal;\n            if (val.isNull) {\n                strVal = strings.NULL_VALUE_PLACEHOLDER_LABEL;\n            }\n            else {\n                switch (val.type) {\n                    case protoRoot.bach.Value.Type.CHAR:\n                        strVal = val.stringValue.value;\n                        break;\n                    case protoRoot.bach.Value.Type.DOUBLE:\n                        strVal = val.doubleValue.toString();\n                        break;\n                    case protoRoot.bach.Value.Type.DATE:\n                        strVal = _.toNumber(val.intValue).toString();\n                        break;\n                    case protoRoot.bach.Value.Type.INT:\n                        strVal = _.toNumber(val.intValue).toString();\n                        break;\n                    case protoRoot.bach.Value.Type.BOOL:\n                        strVal = val.boolValue ? 'true' : 'false';\n                        break;\n                    default:\n                        strVal = null;\n                }\n                if (strVal === '') {\n                    strVal = strings.EMPTY_VALUE_PLACEHOLDER_LABEL;\n                }\n            }\n            returnVal[strVal] = true;\n        });\n        return returnVal;\n    }\n}\n//# sourceMappingURL=attribute-filter-model.js.map","import * as protoRoot from '@thoughtspot/ts-proto';\nimport _ from 'lodash';\nexport function getValue(val) {\n    switch (val.type) {\n        case protoRoot.bach.Value.Type.CHAR:\n            return val.stringValue.value;\n        case protoRoot.bach.Value.Type.DOUBLE:\n            return val.doubleValue;\n        case protoRoot.bach.Value.Type.DATE:\n            return _.toNumber(val.intValue);\n        case protoRoot.bach.Value.Type.INT:\n            return _.toNumber(val.intValue);\n        case protoRoot.bach.Value.Type.BOOL:\n            return val.boolValue;\n        default:\n            return null;\n    }\n}\n//# sourceMappingURL=bach-extensions.js.map","import * as protoRoot from '@thoughtspot/ts-proto';\nlet BETWEEN_OPS = [\n    protoRoot.sage.CompareTypeProto.E.BW,\n    protoRoot.sage.CompareTypeProto.E.BW_INC,\n    protoRoot.sage.CompareTypeProto.E.BW_INC_MAX,\n    protoRoot.sage.CompareTypeProto.E.BW_INC_MIN,\n];\nlet BINARY_OPS_TO_UNARY_OPS = {\n    [protoRoot.sage.CompareTypeProto.E.BW]: [\n        protoRoot.sage.CompareTypeProto.E.GT,\n        protoRoot.sage.CompareTypeProto.E.LT\n    ],\n    [protoRoot.sage.CompareTypeProto.E.BW_INC]: [\n        protoRoot.sage.CompareTypeProto.E.GE,\n        protoRoot.sage.CompareTypeProto.E.LE\n    ],\n    [protoRoot.sage.CompareTypeProto.E.BW_INC_MAX]: [\n        protoRoot.sage.CompareTypeProto.E.GT,\n        protoRoot.sage.CompareTypeProto.E.LE\n    ],\n    [protoRoot.sage.CompareTypeProto.E.BW_INC_MIN]: [\n        protoRoot.sage.CompareTypeProto.E.GE,\n        protoRoot.sage.CompareTypeProto.E.LT\n    ],\n};\nexport function isBetweenOperator(op) {\n    return BETWEEN_OPS.indexOf(op) > -1;\n}\nexport function getUnaryOpsFromBinaryOp(op) {\n    return BINARY_OPS_TO_UNARY_OPS[op];\n}\nexport function getFilterConditionSummary(operator, value) {\n    return getOperatorSymbol(operator) + ' ' + value;\n}\nexport function getOperatorSymbol(operator) {\n    switch (operator) {\n        case protoRoot.sage.CompareTypeProto.E.GT:\n            return '>';\n        case protoRoot.sage.CompareTypeProto.E.GE:\n            return '>=';\n        case protoRoot.sage.CompareTypeProto.E.LT:\n            return '<';\n        case protoRoot.sage.CompareTypeProto.E.LE:\n            return '<=';\n        case protoRoot.sage.CompareTypeProto.E.EQ:\n            return '=';\n        case protoRoot.sage.CompareTypeProto.E.NE:\n            return '!=';\n    }\n}\n//# sourceMappingURL=filter-model-util.js.map","import { dateFormatPresets, formatDate } from '@thoughtspot/date-format-util/date-util';\nimport * as protoRoot from '@thoughtspot/ts-proto';\nimport { strings } from '../../base/strings';\nimport { getValue } from '../../services/utilities/bach-extensions';\nimport { FILTER_MODEL_TYPES, FilterModelV3 } from './filter-model';\nimport { getFilterConditionSummary, getUnaryOpsFromBinaryOp, isBetweenOperator } from './filter-model-util';\nfunction getFormattedDateFromEpochInSeconds(epoch) {\n    if (!epoch) {\n        return null;\n    }\n    let epochInMs = parseInt(epoch, 10) * 1000;\n    // Note (sunny): We ignore custom calendar in formatting here\n    // because date range filter is not able to handle it.\n    return formatDate(epochInMs, dateFormatPresets.DATE_SHORT, true);\n}\nexport class DateFilterModelV3 extends FilterModelV3 {\n    constructor(column, conditions, isCorrupt, id, answerModel) {\n        super(column, conditions, isCorrupt, id, answerModel);\n        this.needsDataFromServer = false;\n    }\n    getFilterValueSummary() {\n        if (this.conditions.length === 0) {\n            return '';\n        }\n        if (this.conditions.length > 1) {\n            return strings.filtersMessages.valuePreview.CLICK_TO_SEE_FILTER;\n        }\n        let firstOperator = this.conditions[0].condition.op;\n        let firstRowValues = this.conditions[0].condition.values.map((val) => {\n            return getFormattedDateFromEpochInSeconds(getValue(val));\n        });\n        if (firstRowValues.length === 0) {\n            return '';\n        }\n        let validFilters = [\n            protoRoot.sage.CompareTypeProto.E.GT,\n            protoRoot.sage.CompareTypeProto.E.GE,\n            protoRoot.sage.CompareTypeProto.E.LT,\n            protoRoot.sage.CompareTypeProto.E.LE,\n            protoRoot.sage.CompareTypeProto.E.BW,\n            protoRoot.sage.CompareTypeProto.E.BW_INC,\n            protoRoot.sage.CompareTypeProto.E.BW_INC_MAX,\n            protoRoot.sage.CompareTypeProto.E.BW_INC_MIN,\n            protoRoot.sage.CompareTypeProto.E.EQ,\n            protoRoot.sage.CompareTypeProto.E.NE\n        ];\n        if (validFilters.indexOf(firstOperator) === -1) {\n            return strings.filtersMessages.valuePreview.CLICK_TO_SEE_FILTER;\n        }\n        let op1, op2, val1, val2;\n        if (isBetweenOperator(firstOperator)) {\n            op1 = getUnaryOpsFromBinaryOp(firstOperator)[0];\n            op2 = getUnaryOpsFromBinaryOp(firstOperator)[1];\n            val1 = firstRowValues[0];\n            val2 = firstRowValues[1];\n            if (this.conditions[0].condition.isNegate) {\n                let temp = op2;\n                op2 = op1;\n                op1 = temp;\n            }\n        }\n        else {\n            op1 = firstOperator;\n            val1 = firstRowValues[0];\n        }\n        if (this.conditions[0].condition.isNegate && op1 === protoRoot.sage.CompareTypeProto.E.EQ) {\n            op1 = protoRoot.sage.CompareTypeProto.E.NE;\n        }\n        else if (this.conditions[0].condition.isNegate\n            && op1 === protoRoot.sage.CompareTypeProto.E.NE) {\n            op1 = protoRoot.sage.CompareTypeProto.E.EQ;\n        }\n        if (this.conditions[0].condition.isNegate && op2 === protoRoot.sage.CompareTypeProto.E.EQ) {\n            op2 = protoRoot.sage.CompareTypeProto.E.NE;\n        }\n        else if (this.conditions[0].condition.isNegate\n            && op2 === protoRoot.sage.CompareTypeProto.E.NE) {\n            op2 = protoRoot.sage.CompareTypeProto.E.EQ;\n        }\n        let summary = getFilterConditionSummary(op1, val1);\n        if (op2 !== void 0) {\n            summary += ' ' + getFilterConditionSummary(op2, val2);\n        }\n        return summary;\n    }\n    getType() {\n        return FILTER_MODEL_TYPES.DATE;\n    }\n    isSupportedByUI() {\n        return this.conditions.length <= 1\n            && super.isSupportedByUI() &&\n            !this.isFilterNonEditable();\n    }\n}\n//# sourceMappingURL=date-filter-model.js.map","import { create } from '@thoughtspot/logger';\nexport class FilterCondition {\n    constructor(condition, column) {\n        this.logger = create('filter-condition');\n        this.condition = condition;\n        this.column = column;\n    }\n}\n//# sourceMappingURL=filter-condition.js.map","import * as protoRoot from '@thoughtspot/ts-proto';\nimport { strings } from '../../base/strings';\nimport { FILTER_MODEL_TYPES, FilterModelV3 } from './filter-model';\nimport { getFilterConditionSummary, getOperatorSymbol, getUnaryOpsFromBinaryOp, isBetweenOperator } from './filter-model-util';\nexport class MeasureFilterModelV3 extends FilterModelV3 {\n    constructor(column, conditions, isCorrupt, id, answerModel) {\n        super(column, conditions, isCorrupt, id, answerModel);\n        this.needsDataFromServer = false;\n    }\n    isSupportedByUI() {\n        /*Currently inline filter are not supported for answers but that will be added in future\n        * releases.\n        */\n        return !this.isFilterNonEditable();\n    }\n    getFilterValueSummary() {\n        if (this.conditions.length === 0 || this.conditions[0].condition.values.length === 0) {\n            return '';\n        }\n        if (this.conditions.length > 1) {\n            return strings.filtersMessages.valuePreview.CLICK_TO_SEE_FILTER;\n        }\n        let isNegate = this.conditions[0].condition.isNegate;\n        let firstOperator = this.conditions[0].condition.op;\n        let firstRowValues = this.conditions[0].condition.values.map(function (val) {\n            if (val.type === protoRoot.bach.Value.Type.INT) {\n                let value = val.hasOwnProperty('intValue')\n                    ? val.intValue.toString()\n                    : strings.NULL_VALUE_PLACEHOLDER_LABEL;\n                return value;\n            }\n            else if (val.type === protoRoot.bach.Value.Type.DOUBLE) {\n                let value = val.hasOwnProperty('doubleValue')\n                    ? val.doubleValue.toString()\n                    : strings.NULL_VALUE_PLACEHOLDER_LABEL;\n                return value;\n            }\n            else {\n                this.logger.error('range value not int or double');\n                return null;\n            }\n        });\n        let validFilters = [\n            protoRoot.sage.CompareTypeProto.E.GT,\n            protoRoot.sage.CompareTypeProto.E.GE,\n            protoRoot.sage.CompareTypeProto.E.LT,\n            protoRoot.sage.CompareTypeProto.E.LE,\n            protoRoot.sage.CompareTypeProto.E.BW,\n            protoRoot.sage.CompareTypeProto.E.BW_INC,\n            protoRoot.sage.CompareTypeProto.E.BW_INC_MAX,\n            protoRoot.sage.CompareTypeProto.E.BW_INC_MIN,\n            protoRoot.sage.CompareTypeProto.E.EQ,\n            protoRoot.sage.CompareTypeProto.E.NE,\n            protoRoot.sage.CompareTypeProto.E.IN\n        ];\n        if (validFilters.indexOf(firstOperator) === -1) {\n            return strings.filtersMessages.valuePreview.CLICK_TO_SEE_FILTER;\n        }\n        let op1, op2, val1, val2;\n        if (isBetweenOperator(firstOperator)) {\n            op1 = getUnaryOpsFromBinaryOp(firstOperator)[0];\n            op2 = getUnaryOpsFromBinaryOp(firstOperator)[1];\n            val1 = firstRowValues[0];\n            val2 = firstRowValues[1];\n        }\n        else {\n            op1 = firstOperator;\n            val1 = firstRowValues[0];\n        }\n        // We need special handling of != {null} case as callsoum sends isNegate = true & op = 0\n        // (case '=') instead of sending op = 1 (case '!=' )\n        if (firstOperator === protoRoot.sage.CompareTypeProto.E.EQ && isNegate) {\n            op1 = protoRoot.sage.CompareTypeProto.E.NE;\n        }\n        if (firstOperator === protoRoot.sage.CompareTypeProto.E.IN) {\n            op1 = isNegate\n                ? protoRoot.sage.CompareTypeProto.E.NE\n                : protoRoot.sage.CompareTypeProto.E.EQ;\n            return getOperatorSymbol(op1) + ' ' + firstRowValues.join(', ');\n        }\n        let summary = getFilterConditionSummary(op1, val1);\n        if (op2 !== void 0) {\n            summary += ' ' + getFilterConditionSummary(op2, val2);\n        }\n        return summary;\n    }\n    getType() {\n        return FILTER_MODEL_TYPES.MEASURE;\n    }\n}\n//# sourceMappingURL=measure-filter-model.js.map","import { formatDate } from '@thoughtspot/date-format-util/date-util';\nimport { formatDataValue } from '@thoughtspot/number-format-util/number-util';\nimport { ngRequire } from '../base/decorators';\nimport { getFilterModelForWorksheetPanel } from '../modules/viz-layout/viz/filter/filter-model-factory';\nimport { getDisplayString } from '../services/custom-calendar-service';\nlet util = ngRequire('util');\nexport function getAllFilterModels(worksheet) {\n    let allColumns = worksheet.columnGroup.reduce((acc, cG) => {\n        cG.worksheetColumn.forEach((column) => {\n            acc[column.header.guid] = column;\n        });\n        return acc;\n    }, {});\n    let filterModels = worksheet.filters.map((filter) => {\n        let column = allColumns[filter.column.columnId];\n        let filterModel = getFilterModelForWorksheetPanel(column, filter);\n        return filterModel;\n    });\n    return filterModels;\n}\nexport function formatWorksheetColumnValue(worksheetColumn, value) {\n    if (worksheetColumn.dataType === util.dataTypes.INT32\n        || worksheetColumn.dataType === util.dataTypes.INT64\n        || worksheetColumn.dataType === util.dataTypes.DOUBLE\n        || worksheetColumn.dataType === util.dataTypes.FLOAT) {\n        return formatDataValue(value, {\n            formatPattern: worksheetColumn.formatPattern\n        });\n    }\n    else if (worksheetColumn.dataType === util.dataTypes.DATE\n        || worksheetColumn.dataType === util.dataTypes.DATE_TIME\n        || worksheetColumn.dataType === util.dataTypes.TIME) {\n        return getDisplayString(value)\n            || formatDate(value * 1000, worksheetColumn.formatPattern, false);\n    }\n    else {\n        return value;\n    }\n}\nexport function getSelectedJoinPathLabelForWorksheetColumn(worksheetColumn) {\n    if (!worksheetColumn.canEditJoinPath\n        || !worksheetColumn.joinPath\n        || !worksheetColumn.joinPath.length) {\n        return '';\n    }\n    // The structure of joinPaths in WorksheetColumn is of the form\n    // [joinPath1, joinPath2, ...] where each joinPath contains an\n    // array of joins. We join the inner joins with ' -> ' after\n    // reversing the order since the default order follows left to root.\n    // We then join the different paths using ' | '\n    return worksheetColumn.joinPath.slice(0).map((pathToRoot) => {\n        return pathToRoot.join.slice(0).reverse().map(function (join) {\n            return join.id.name;\n        }).join(' -> ');\n    }).join(' | ');\n}\n//# sourceMappingURL=worksheet-extensions.js.map","import { create } from '@thoughtspot/logger';\nimport { formatWorksheetColumnValue } from '../../../bach-client/worksheet-extensions';\nimport { ngRequire } from '../../../base/decorators';\nimport { aggregateTypes } from '../../../base/enums/aggregateTypes';\nlet util = ngRequire('util');\nexport class WorksheetColumn {\n    constructor(column) {\n        this.column = column;\n        this.logger = create('Worksheet column');\n    }\n    isFilteringSupportedByUI() {\n        return true;\n    }\n    getId() {\n        return this.column.header.guid;\n    }\n    getName() {\n        return this.column.header.displayName;\n    }\n    getFormattedValue(value) {\n        return formatWorksheetColumnValue(this.column, value);\n    }\n    convertValueToSageValue(value) {\n        // this.logger.error('worksheet filter values need not be converted to sage value');\n        return null;\n    }\n    isAggregationApplied() {\n        return false;\n    }\n    getAggregateOverride() {\n        return aggregateTypes.NONE;\n    }\n    hasAggregateOverride() {\n        return false;\n    }\n    convertValueFromBackend(value) {\n        this.logger.error('We choose to keep the values carried over as server values' +\n            ' and handle translation in formatting.');\n        return value;\n    }\n    isDateTimeColumn() {\n        return this.isDateColumn();\n    }\n    isDateColumn() {\n        return this.column.dataType === util.dataTypes.DATE\n            || this.column.dataType === util.dataTypes.TIME\n            || this.column.dataType === util.dataTypes.DATE_TIME;\n    }\n    isMeasure() {\n        return !this.isDateColumn() && !this.isAttribute();\n    }\n    isAttribute() {\n        return this.column.dataType === util.dataTypes.VARCHAR\n            || this.column.dataType === util.dataTypes.BOOL;\n    }\n    isInteger() {\n        return this.column.dataType === util.dataTypes.INT32\n            || this.column.dataType === util.dataTypes.INT64;\n    }\n    getEffectiveDataType() {\n        return this.column.dataType;\n    }\n    getBaseLogicalColumnGuid() {\n        this.logger.error('method not supported');\n        return null;\n    }\n    getEffectiveAggregateType() {\n        this.logger.error('method not supported');\n        return null;\n    }\n    getReferencedTableIds() {\n        this.logger.error('method not supported');\n        return null;\n    }\n}\n//# sourceMappingURL=worksheet-column.js.map","import * as protoRoot from '@thoughtspot/ts-proto';\nexport function getSageCompareType(op) {\n    switch (op) {\n        case 'EQ':\n            return protoRoot.sage.CompareTypeProto.E.EQ;\n        case 'NE':\n            return protoRoot.sage.CompareTypeProto.E.NE;\n        case 'LT':\n            return protoRoot.sage.CompareTypeProto.E.LT;\n        case 'LE':\n            return protoRoot.sage.CompareTypeProto.E.LE;\n        case 'GT':\n            return protoRoot.sage.CompareTypeProto.E.GT;\n        case 'GE':\n            return protoRoot.sage.CompareTypeProto.E.GE;\n        case 'IN':\n            return protoRoot.sage.CompareTypeProto.E.IN;\n        case 'BW':\n            return protoRoot.sage.CompareTypeProto.E.BW;\n        case 'CONTAINS':\n            return protoRoot.sage.CompareTypeProto.E.CONTAINS;\n        case 'BEGINS_WITH':\n            return protoRoot.sage.CompareTypeProto.E.BEGINS_WITH;\n        case 'ENDS_WITH':\n            return protoRoot.sage.CompareTypeProto.E.ENDS_WITH;\n        case 'BW_INC':\n            return protoRoot.sage.CompareTypeProto.E.BW_INC;\n        case 'BW_INC_MIN':\n            return protoRoot.sage.CompareTypeProto.E.BW_INC_MIN;\n        case 'BW_INC_MAX':\n            return protoRoot.sage.CompareTypeProto.E.BW_INC_MAX;\n        case 'LIKE':\n            return protoRoot.sage.CompareTypeProto.E.LIKE;\n        default:\n            return null;\n    }\n}\n//# sourceMappingURL=enum-translators.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Exports different common types for filters.\n */\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport _ from 'lodash';\nimport { ngRequire } from '../../../../base/decorators';\nlet Logger = ngRequire('Logger');\nexport var FilterTypes;\n(function (FilterTypes) {\n    // Filter type for filters with one row.\n    FilterTypes[FilterTypes[\"SIMPLE\"] = 0] = \"SIMPLE\";\n    // Filter type for filters with more than one row\n    FilterTypes[FilterTypes[\"COMPOUND\"] = 1] = \"COMPOUND\";\n})(FilterTypes || (FilterTypes = {}));\nexport var FilterRowType;\n(function (FilterRowType) {\n    // Default filter row type.\n    FilterRowType[FilterRowType[\"SIMPLE\"] = 0] = \"SIMPLE\";\n    // Filter type when filters like near, farther are added.\n    FilterRowType[FilterRowType[\"GEO\"] = 1] = \"GEO\";\n})(FilterRowType || (FilterRowType = {}));\nexport class FilterValue {\n    constructor(filterValueJson) {\n        this.logger = Logger.create('filter-value');\n        if (!filterValueJson) {\n            this.logger.error('Filter Value initialized without json');\n            return;\n        }\n        if (!_.isBoolean(filterValueJson[jsonConstants.filter.filterValue.SELECTED])) {\n            this.logger.error('Filter Value initialized with non boolean selection state');\n        }\n        this.key = filterValueJson[jsonConstants.filter.filterValue.KEY];\n        this.selected = filterValueJson[jsonConstants.filter.filterValue.SELECTED];\n        this.keyNull = filterValueJson[jsonConstants.filter.filterValue.KEYNULL];\n    }\n    getKey() {\n        if (this.keyNull === true) {\n            return null;\n        }\n        return this.key;\n    }\n    isSelected() {\n        return this.selected;\n    }\n}\n//# sourceMappingURL=filter-types.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Base class to represent Filter row.\n */\nimport { ngRequire } from '../../../../base/decorators';\nimport { VisualizationColumnModel } from '../../../callosum/model/visualization-column';\nimport { FilterRowType } from './filter-types';\nlet Logger = ngRequire('Logger');\nexport class BaseFilterRow {\n    constructor(columnJson, filterRowType) {\n        this.logger = Logger.create('filter-row');\n        this.visualizationColumnModel = new VisualizationColumnModel(columnJson);\n        this.filterRowType = FilterRowType[filterRowType];\n    }\n    getColumn() {\n        return this.visualizationColumnModel;\n    }\n    getType() {\n        return this.filterRowType;\n    }\n    isEmpty() {\n        this.logger.error('concrete types should implement this');\n        return false;\n    }\n}\n//# sourceMappingURL=filter-row.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Represents the single operator filter row.\n */\nimport * as tslib_1 from \"tslib\";\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport * as protoRoot from '@thoughtspot/ts-proto';\nimport _ from 'lodash';\nimport { Provide } from '../../../../base/decorators';\nimport { FilterCondition } from '../../../../object-model/filter/filter-condition';\nimport { getSageCompareType } from '../../../../services/utilities/enum-translators';\nimport { BaseFilterRow } from './filter-row';\nimport { FilterValue } from './filter-types';\nlet SingleOperatorFilterRow = class SingleOperatorFilterRow extends BaseFilterRow {\n    constructor(filterRowJson) {\n        super(filterRowJson[jsonConstants.filter.COLUMN], filterRowJson[jsonConstants.TYPE_KEY]);\n        let op = filterRowJson[jsonConstants.filter.SINGLE_OPERATOR_KEY];\n        this.operator = getSageCompareType(op);\n        this.values = filterRowJson[jsonConstants.VALUES_KEY]\n            .map(filterValueJson => {\n            return new FilterValue(filterValueJson);\n        });\n        this.negation = !!filterRowJson[jsonConstants.filter.NEGATION];\n        this.isEditable = _.isUndefined(filterRowJson[jsonConstants.filter.IS_EDITABLE])\n            ? true\n            : filterRowJson[jsonConstants.filter.IS_EDITABLE];\n    }\n    getOperator() {\n        return this.operator;\n    }\n    getValues() {\n        return this.values;\n    }\n    isEmpty() {\n        return this.values.length === 0;\n    }\n    isNegation() {\n        return this.negation;\n    }\n    getFilterConditions() {\n        let condition = new protoRoot.bach.Filter();\n        condition.isNegate = !!this.negation;\n        condition.op = this.operator;\n        condition.isEditable = this.isEditable;\n        condition.values = this.getValues().map((value) => {\n            let val = new protoRoot.bach.Value();\n            val.isNull = _.isNull(value.getKey());\n            switch (this.getColumn().getEffectiveDataType()) {\n                case 'BOOL':\n                    val.type = protoRoot.bach.Value.Type.BOOL;\n                    if (!val.isNull) {\n                        val.boolValue = (value.getKey() === 'true');\n                    }\n                    break;\n                case 'CHAR':\n                    val.type = protoRoot.bach.Value.Type.CHAR;\n                    if (!val.isNull) {\n                        val.stringValue = new protoRoot.bach.Value.StringValue({\n                            value: value.getKey()\n                        });\n                    }\n                    break;\n                case 'VARCHAR':\n                    val.type = protoRoot.bach.Value.Type.CHAR;\n                    if (!val.isNull) {\n                        val.stringValue = new protoRoot.bach.Value.StringValue({\n                            value: value.getKey()\n                        });\n                    }\n                    break;\n                case 'DATE':\n                    val.type = protoRoot.bach.Value.Type.INT;\n                    if (!val.isNull) {\n                        val.intValue = !!value.getKey() ? _.toNumber(value.getKey()) : null;\n                    }\n                    break;\n                case 'DATE_TIME':\n                    val.type = protoRoot.bach.Value.Type.INT;\n                    if (!val.isNull) {\n                        val.intValue = !!value.getKey() ? _.toNumber(value.getKey()) : null;\n                    }\n                    break;\n                case 'TIME':\n                    val.type = protoRoot.bach.Value.Type.INT;\n                    if (!val.isNull) {\n                        val.intValue = !!value.getKey() ? _.toNumber(value.getKey()) : null;\n                    }\n                    break;\n                case 'DATE_NUM':\n                    val.type = protoRoot.bach.Value.Type.INT;\n                    if (!val.isNull) {\n                        val.intValue = !!value.getKey() ? _.toNumber(value.getKey()) : null;\n                    }\n                    break;\n                case 'INT32':\n                    val.type = protoRoot.bach.Value.Type.INT;\n                    if (!val.isNull) {\n                        val.intValue = !!value.getKey() ? _.toNumber(value.getKey()) : null;\n                    }\n                    break;\n                case 'INT64':\n                    val.type = protoRoot.bach.Value.Type.INT;\n                    if (!val.isNull) {\n                        val.intValue = !!value.getKey() ? _.toNumber(value.getKey()) : null;\n                    }\n                    break;\n                case 'DOUBLE':\n                    val.type = protoRoot.bach.Value.Type.DOUBLE;\n                    if (!val.isNull) {\n                        val.doubleValue = !!value.getKey() ? _.toNumber(value.getKey()) : null;\n                    }\n                    break;\n                case 'FLOAT':\n                    val.type = protoRoot.bach.Value.Type.DOUBLE;\n                    if (!val.isNull) {\n                        val.doubleValue = !!value.getKey() ? _.toNumber(value.getKey()) : null;\n                    }\n                    break;\n                default:\n                    this.logger.error('Unsupported column type');\n            }\n            return val;\n        });\n        let filterCondition = new FilterCondition(condition, this.getColumn());\n        return [filterCondition];\n    }\n};\nSingleOperatorFilterRow = tslib_1.__decorate([\n    Provide('SingleOperatorFilterRow')\n], SingleOperatorFilterRow);\nexport { SingleOperatorFilterRow };\n//# sourceMappingURL=single-operator-filter-row.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Class representing filter row with multiple operators.\n * This happens in cases like revenue 1992 1994, the row contains multiple\n * BW operators in this case.\n */\nimport * as tslib_1 from \"tslib\";\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport _ from 'lodash';\nimport { ngRequire, Provide } from '../../../../base/decorators';\nimport { getSageCompareType } from '../../../../services/utilities/enum-translators';\nimport { BaseFilterRow } from './filter-row';\nimport { FilterValue } from './filter-types';\nimport { SingleOperatorFilterRow } from './single-operator-filter-row';\nlet Logger = ngRequire('Logger');\nlet MultiOperatorFilterRow = class MultiOperatorFilterRow extends BaseFilterRow {\n    constructor(filterRowJson = {}) {\n        super(filterRowJson[jsonConstants.filter.COLUMN], filterRowJson[jsonConstants.TYPE_KEY]);\n        this.singleOperatorFilterRows = [];\n        this.operators = [];\n        this.valueSets = [];\n        this.logger = Logger.create('multi-operator-filter-row');\n        if (!_.isArray(filterRowJson[jsonConstants.filter.MULTIPLE_OPERATORS_KEY])) {\n            this.logger.error('Multi operator missing array of rows');\n        }\n        filterRowJson[jsonConstants.filter.MULTIPLE_OPERATORS_KEY]\n            .forEach((operatorRow, idx) => {\n            let operator = operatorRow[jsonConstants.filter.MULTIPLE_OPERATOR.OPERATOR];\n            this.operators[idx] = getSageCompareType(operator);\n            this.valueSets[idx] = operatorRow[jsonConstants.filter.MULTIPLE_OPERATOR.VALUES]\n                .map(filterValueJson => new FilterValue(filterValueJson));\n            let singleOperatorFilterRow = new SingleOperatorFilterRow({\n                [jsonConstants.filter.COLUMN]: filterRowJson[jsonConstants.filter.COLUMN],\n                [jsonConstants.TYPE_KEY]: filterRowJson[jsonConstants.TYPE_KEY],\n                [jsonConstants.filter.SINGLE_OPERATOR_KEY]: operator,\n                [jsonConstants.VALUES_KEY]: operatorRow[jsonConstants.filter.MULTIPLE_OPERATOR.VALUES],\n                [jsonConstants.filter.NEGATION]: operatorRow[jsonConstants.filter.NEGATION]\n            });\n            this.singleOperatorFilterRows.push(singleOperatorFilterRow);\n        });\n    }\n    isEmpty() {\n        return this.valueSets.every((valueSet) => {\n            return valueSet.length === 0;\n        });\n    }\n    getFilterConditions() {\n        return _.flatten(this.getSingleOperatorRows().map(row => row.getFilterConditions()));\n    }\n    getSingleOperatorRows() {\n        return this.singleOperatorFilterRows;\n    }\n};\nMultiOperatorFilterRow = tslib_1.__decorate([\n    Provide('MultiOperatorFilterRow')\n], MultiOperatorFilterRow);\nexport { MultiOperatorFilterRow };\n//# sourceMappingURL=multi-operator-filter-row.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Class to represent filter content.\n * In the current model we have a Filter Object which contains all the filter conditions\n * with the filter model containing links to it.\n * All this information is contained inside of this filter content object.\n */\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport _ from 'lodash';\nimport { ngRequire } from '../../../../base/decorators';\nimport { MultiOperatorFilterRow } from './multi-operator-filter-row';\nimport { SingleOperatorFilterRow } from './single-operator-filter-row';\nlet Logger = ngRequire('Logger');\nexport class FilterContent {\n    constructor(json) {\n        this.logger = Logger.create('filter-content');\n        if (!json) {\n            this.logger.error('No json passed for construction');\n            return;\n        }\n        if (!_.isArray(json[jsonConstants.filter.ROWS])) {\n            this.logger.error('Filter rows is not an array');\n            return;\n        }\n        this.rows = getFilterRows(json[jsonConstants.filter.ROWS]);\n        this.filterType = json[jsonConstants.TYPE_KEY];\n    }\n    getRows() {\n        return this.rows;\n    }\n    getRowAtIndex(index) {\n        return this.rows[index];\n    }\n}\nfunction getFilterRows(filterRowsJson = []) {\n    return filterRowsJson.map((filterRowJson) => {\n        let isMultiOp = filterRowJson.hasOwnProperty(jsonConstants.filter.MULTIPLE_OPERATORS_KEY);\n        if (isMultiOp) {\n            return new MultiOperatorFilterRow(filterRowJson);\n        }\n        else {\n            return new SingleOperatorFilterRow(filterRowJson);\n        }\n    });\n}\n//# sourceMappingURL=filter-content.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Client side class representing the Filter Object returned from callosum\n * as part of the Answersheet. This is the container of all the filter contitions.\n */\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport { ngRequire } from '../../../../base/decorators';\nimport { FilterContent } from './filter-content';\nlet Logger = ngRequire('Logger');\nexport class Filter {\n    constructor(json) {\n        this.logger = Logger.create('filter');\n        if (!json) {\n            this.logger.error('Undefined Json in construction');\n            return;\n        }\n        this.complete = json[jsonConstants.VIZ_COMPLETE_KEY];\n        this.filterContent = new FilterContent(json[jsonConstants.filter.FILTER_CONTENT]);\n        this.headers = json[jsonConstants.HEADER_KEY];\n        this.incompleteDetail = json[jsonConstants.INCOMPLETE_DETAIL];\n    }\n    isComplete() {\n        return this.complete;\n    }\n    getFilterContent() {\n        return this.filterContent;\n    }\n}\n//# sourceMappingURL=filter.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015-16\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Provides a service to create filter expressions\n */\n'use strict';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport { create } from '@thoughtspot/logger';\nimport { ngRequire, Provide } from '../../../../base/decorators';\nlet jsUtil = ngRequire('jsUtil');\nexport const filterOperators = {\n    CONTAINS: 'OP_CONTAINS',\n    IN: 'OP_IN',\n    EQUALS: 'OP_EQUALS'\n};\nlet _logger;\nexport class SimpleFilterExpression {\n    constructor(vizColumn, value, operator, columnType = jsonConstants.clientExpressionColumnType.VIZ_COLUMN) {\n        this.columnInfoNodeIndex = 0; // can we remove it ?\n        this.valueNodeIndex = 1;\n        if (!_logger) {\n            _logger = create('Filter-Expression');\n        }\n        if (!vizColumn) {\n            _logger.error('Cannot create filter expression, missing visualization column');\n            return;\n        }\n        if (!vizColumn.getId || !vizColumn.getId()) {\n            _logger.error('Cannot create filter expression, visualization column missing id');\n            return;\n        }\n        if (!value) {\n            _logger.error('Cannot create filter expression, missing value');\n            return;\n        }\n        if (!operator) {\n            _logger.error('Cannot create filter expression, missing operator');\n            return;\n        }\n        this.value = value;\n        this.operator = operator;\n        this.vizColumn = vizColumn;\n        this.columnType = columnType;\n    }\n    getJsonString() {\n        let jsonObjectMap = this.getJsonObject();\n        return JSON.stringify(jsonObjectMap);\n    }\n    getJsonObject() {\n        let jsonObjectMap = {\n            id: jsUtil.generateUUID(),\n            child: [\n                {\n                    id: this.vizColumn.getId(),\n                    /* eslint camelcase: 1*/\n                    column_type: this.columnType\n                },\n                {\n                    id: jsUtil.generateUUID()\n                }\n            ],\n            operator: this.operator\n        };\n        let valueArray = Array.isArray(this.value) ? this.value : [this.value];\n        jsonObjectMap.child[this.valueNodeIndex].value = valueArray.map((value) => {\n            return {\n                string_val: value\n            };\n        });\n        return jsonObjectMap;\n    }\n}\nProvide('filterExpressionService')({\n    filterOperators,\n    SimpleFilterExpression\n});\n//# sourceMappingURL=filter-expression.js.map","/**\n * Copyright: ThoughtSpot Inc. 2014\n * Author: Vibhor Nanavati (vibhor@thoughtspot.com)\n *\n * @fileoverview A common utility used by any component that wishes to show a filter ui.\n */\n'use strict';\nimport { dateFormatPresets, formatDate } from '@thoughtspot/date-format-util/date-util';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport { create } from '@thoughtspot/logger';\nimport { ngRequire, Provide } from '../../../../base/decorators';\nimport { events } from '../../../../base/events/events';\nimport { RequestTypes } from '../../../../base/proto/callosum-types';\nimport sage from '../../../../base/proto/sage-namespace-translator';\nimport { getSageAggrTypeForCallosumAggrType } from '../../../../base/translation-util/translation-util';\nimport { getValue } from '../../../../services/utilities/bach-extensions';\nimport { transformTable } from '../../../auto-complete/auto-complete-service';\nimport { filterOperators, SimpleFilterExpression } from './filter-expression';\nlet $rootScope = ngRequire('$rootScope');\nlet $q = ngRequire('$q');\nlet alertService = ngRequire('alertService');\nlet answerService = ngRequire('answerService');\nlet cancelableQueryContextService = ngRequire('cancelableQueryContextService');\nlet dataService = ngRequire('dataService');\nlet rangeOperatorUtil = ngRequire('rangeOperatorUtil');\nlet UserAction = ngRequire('UserAction');\nlet util = ngRequire('util');\nlet logger = create('filter-util');\nlet cancellationNamespace = 'filterQuery';\nlet filterTypeCssClasses = {\n    RANGE_FILTER: 'bk-range-filter-container',\n    DATE_FILTER: 'bk-date-filter-container',\n    CHECKBOX_FILTER: 'bk-checkbox-filter-container',\n    WAITING: 'bk-waiting-for-filter'\n};\nfunction triggerFilterCloseEvent() {\n    $rootScope.$broadcast(events.CLEAR_AND_HIDE_POPUP_MENU);\n}\nfunction clearLoadingIndicator($container) {\n    $container.removeClass(filterTypeCssClasses.WAITING);\n}\nfunction showNewFilterAsLoading($container) {\n    $container.addClass(filterTypeCssClasses.WAITING);\n}\nfunction showErrorLoadingFilter($container) {\n    $container.removeClass(filterTypeCssClasses.WAITING);\n    $container.append('<div class=\"bk-unsupported-filter-placeholder\">' +\n        'Oops! There was an error loading this filter.</div>');\n}\nfunction getFilterTokensByTransform(existingTokens, logicalColumn, vizColumn, aggr, filterOperator, addWildcards) {\n    let queryTransformation = [], transformationParams = {};\n    if (!!logicalColumn) {\n        transformationParams.columnGuid = logicalColumn.getGuid();\n    }\n    if (!!vizColumn) {\n        transformationParams.tokenOutputGuid = vizColumn.getId();\n    }\n    if (addWildcards) {\n        transformationParams.value1 = '{wildcard}';\n        transformationParams.value2 = '{wildcard}';\n    }\n    if (aggr !== sage.AggregationType.NONE) {\n        transformationParams.aggregation = aggr;\n        queryTransformation.push(sage.QueryTransform.createAddHavingFilterTransformation(transformationParams));\n    }\n    else {\n        if (!filterOperator) {\n            transformationParams.op = sage.CompareType.EQ;\n        }\n        else {\n            transformationParams.op = filterOperator;\n        }\n        queryTransformation.push(sage.QueryTransform.createAddPredicateFilterTransformation(transformationParams));\n    }\n    return queryTransformation;\n}\n/**\n * This method can only be used with a fully specified Visualization Column that has a\n * join path defined.\n * Given this assumption, this method will always return a promise of a filter model in\n * non-error cases.\n *\n * @param {VisualizationColumnModel} vizCol\n * @param {AnswerModel} answerModel\n * @param {AnswerSageClient} sageClient\n *\n * @returns {Promise | null}\n */\nfunction fetchNewFilterModel(vizCol, answerModel, sageClient) {\n    if (!vizCol) {\n        return null;\n    }\n    let sageAggrType = getSageAggrTypeForCallosumAggrType(vizCol.getEffectiveAggregateType());\n    let vizColumn = vizCol, aggr = sage.AggregationType[sageAggrType], existingTokens = answerModel.getRecognizedTokens();\n    let filterOperator;\n    if (vizCol.isDateColumn()) {\n        filterOperator = sage.CompareType.GE;\n    }\n    let filterTransformations = getFilterTokensByTransform(existingTokens, null, vizColumn, aggr, filterOperator, false);\n    let newFilterModelDeferred = $q.defer();\n    transformTable(sageClient.getContext(), sageClient.getCurrentIndex(), filterTransformations)\n        .then(function (sageResponse) {\n        let answerResponse = sageResponse.answerResponse;\n        let questionParams = {};\n        questionParams[jsonConstants.SAGE_CONTEXT_PROTO_KEY] = answerResponse.getContext();\n        questionParams[jsonConstants.SAGE_CONTEXT_INDEX_KEY] = sageClient.getCurrentIndex();\n        let tables = questionParams[jsonConstants.SAGE_CONTEXT_PROTO_KEY].getTables();\n        if (!tables[questionParams[jsonConstants.SAGE_CONTEXT_INDEX_KEY]].getQuery()) {\n            logger.error('Add filter transformation returned empty program', JSON.stringify(questionParams), JSON.stringify(filterTransformations), JSON.stringify(answerResponse));\n            newFilterModelDeferred.reject();\n            return;\n        }\n        let optionalParams = {\n            includeData: false,\n            requestType: RequestTypes.ANSWER_ADD_NEW_FILTER\n        };\n        let userAction = new UserAction(UserAction.FETCH_ANSWER_FILTER);\n        answerService.getAnswer(questionParams, optionalParams)\n            .then(function (response) {\n            let answerModel = response.data;\n            let newFilterModel = answerModel.getCurrentAnswerSheet()\n                .getFilterModelByColumn(vizCol);\n            if (!newFilterModel) {\n                newFilterModelDeferred.reject('Can not find a matching filter for this column');\n                return;\n            }\n            let ignoreDataFetch = !!newFilterModel &&\n                (!newFilterModel.needsDataFromServer || !newFilterModel.isSupportedByUI());\n            if (ignoreDataFetch) {\n                newFilterModelDeferred.resolve(newFilterModel);\n                return;\n            }\n            updateFilterModelWithValues(newFilterModel, '', true).then(function () {\n                newFilterModelDeferred.resolve(newFilterModel);\n            }, function (error) {\n                logger.error('filter data fetch failed', error);\n                newFilterModelDeferred.reject(error);\n            });\n        }, function (response) {\n            alertService.showUserActionFailureAlert(userAction, response);\n            logger.error('Callosum query execution failed for temp filter generation query', response, sageClient.getContext());\n            newFilterModelDeferred.reject(response.data);\n        });\n    }, function (error) {\n        logger.error('Add filter transformation failed', JSON.stringify(sageClient.getContext()), JSON.stringify(sageClient.getCurrentIndex), JSON.stringify(filterTransformations));\n        newFilterModelDeferred.reject(error);\n    });\n    return newFilterModelDeferred.promise;\n}\n// This function return data if it can be computed/returned without a network call\n/**\n *\n * @param {FilterModel} filterModel\n * @param {String} valueSearchQuery\n * @returns {*}\n */\nfunction getLocalDataForValueSearch(filterModel, valueSearchQuery, showRelevantValues) {\n    // cache check\n    let cacheResponse = filterModel.getFilterDataCacheValue(valueSearchQuery, !showRelevantValues);\n    if (!!cacheResponse) {\n        return cacheResponse;\n    }\n    let cache = filterModel.getFilterDataCache(!showRelevantValues);\n    let matchingKey;\n    util.iterateObject(cache, function (key) {\n        if (!!matchingKey) {\n            return;\n        }\n        if (valueSearchQuery.indexOf(key) > -1 &&\n            cache[key].length < filterModel.getBatchSize()) {\n            matchingKey = key;\n        }\n    });\n    // If a substring resulted in less than batch size results then use it locally.\n    if (!!matchingKey) {\n        let data = cache[matchingKey];\n        let newData = data.filter(function (value) {\n            // we want to handle the case of nulls here if the search value is ''\n            // then we want to include null values which show as {null} in UI.\n            if (!value) {\n                return valueSearchQuery === '';\n            }\n            return value.toString().toLowerCase().indexOf(valueSearchQuery.toLowerCase()) > -1;\n        });\n        return newData;\n    }\n    return null;\n}\n/**\n *\n * @param {FilterModel} filterModel\n * @param {String} valueSearchQuery\n * @param {Array.<*>} dataValues\n */\nfunction processFilterDataResponse(filterModel, valueSearchQuery, dataValues, showRelevantValues) {\n    filterModel.putFilterDataCache(valueSearchQuery, dataValues, !showRelevantValues);\n    filterModel.updateFilterValues(dataValues, !showRelevantValues);\n}\n/**\n *\n * @param {FilterModel} filterModel\n * @param {String} valueSearchQuery\n * @param {String} previousSearchQuery\n * @returns {Promise}\n */\nfunction updateFilterModelWithValues(filterModel, valueSearchQuery, showRelevantValues) {\n    cancelableQueryContextService.cancelPendingQueriesInNamespace(cancellationNamespace);\n    let localDataValues = getLocalDataForValueSearch(filterModel, valueSearchQuery, showRelevantValues);\n    if (!!localDataValues) {\n        processFilterDataResponse(filterModel, valueSearchQuery, localDataValues, showRelevantValues);\n        return $q.when();\n    }\n    let containsFilterExpression;\n    if (valueSearchQuery) {\n        containsFilterExpression = new SimpleFilterExpression(filterModel.getColumn(), valueSearchQuery, filterOperators.CONTAINS);\n    }\n    return dataService.getDataForViz(filterModel.getContainingAnswerModel(), filterModel, {\n        showAllValues: !showRelevantValues\n    }, true, containsFilterExpression, cancellationNamespace)\n        .then(function (response) {\n        let data = response.data;\n        if (!!data.data) {\n            let scalarDataValues = data.data.map(function (dataValueRow) {\n                if (dataValueRow.length !== 1) {\n                    logger.error('Single data values expected per row');\n                }\n                return dataValueRow[0];\n            });\n            processFilterDataResponse(filterModel, valueSearchQuery, scalarDataValues, showRelevantValues);\n        }\n    });\n}\n/**\n * filters values that exist in system for the column used to filter.\n * @param {FilterModel} filterModel\n * @param {Array[*]} values\n * @returns {Array[*]}\n */\nfunction filterValuesMatchingFilterColumnValues(filterModel, values) {\n    if (!filterModel) {\n        logger.error('filterValuesMatchingFilterColumnValues called with empty filter model');\n        return;\n    }\n    if (!values) {\n        logger.error('filterValuesMatchingFilterColumnValues called with empty values');\n        return;\n    }\n    if (!values.length) {\n        return $q.when([]);\n    }\n    let filterExpression = new SimpleFilterExpression(filterModel.getColumn(), values, filterOperators.IN);\n    let userAction = new UserAction(UserAction.FETCH_FILTER_DATA);\n    return dataService.getDataForViz(filterModel.getContainingAnswerModel(), filterModel, null, true, filterExpression).\n        then(function (response) {\n        let vizData = response.data;\n        let dataArray = vizData.data.\n            reduce(function (a, b) {\n            return a.concat(b);\n        }, []);\n        let processedDataArray = dataArray.\n            map(function (value) {\n            return (typeof value === 'string') ? value.toLowerCase().trim() : value;\n        });\n        return processedDataArray;\n    });\n}\n/**\n * Searches for a column value that exactly matches valueSearchQuery (ignoring case), and returns\n * that value if it is found (properly cased)\n *\n * @param {FilterModel} filterModel\n * @param {String} valueSearchQuery\n *\n * @returns {Promise} resolves to the exact value (properly cased), or null\n */\nfunction filterColumnGetExactValue(filterModel, valueSearchQuery, showRelevantValues) {\n    let equalsFilterExpression;\n    // TODO(Jasmeet): SCAL-13458 Handling of empty filter values and nulls in UI\n    // Update the implementation when we have resolution on the ticket.\n    if (!valueSearchQuery) {\n        return $q.when(null);\n    }\n    equalsFilterExpression = new SimpleFilterExpression(filterModel.getColumn(), valueSearchQuery, filterOperators.EQUALS);\n    return dataService.getDataForViz(filterModel.getContainingAnswerModel(), filterModel, {\n        showAllValues: !showRelevantValues\n    }, true, equalsFilterExpression)\n        .then((response) => {\n        let data = response.data;\n        if (data && data.data && data.data.length === 1) {\n            return data.data[0][0];\n        }\n        else {\n            return null;\n        }\n    });\n}\n/**\n * Checks if a column value exists that exactly matches valueSearchQuery (ignoring case)\n *\n * @param {FilterModel} filterModel\n * @param {String} valueSearchQuery\n *\n * @returns {Promise} resolves to a boolean indicating whether an exact match was found\n */\nfunction filterColumnContainsValue(filterModel, valueSearchQuery, showRelevantValues) {\n    return filterColumnGetExactValue(filterModel, valueSearchQuery, showRelevantValues)\n        .then(value => {\n        return (value !== null);\n    });\n}\n/**\n *\n * @param {VisualizationColumnModel} columnModel\n * @param {VisualizationModel} vizModel\n * @param {AnswerSageClient} sageClient\n * @returns {Promise}\n */\nfunction getMatchingFilterModel(columnModel, vizModel, sageClient) {\n    let filterModel = vizModel.getMatchingFilterModel(columnModel);\n    if (!filterModel) {\n        logger.debug('No filter model in answer corresponding to column: ', columnModel.getId());\n        // make async call and resolve the promise when done.\n        return fetchNewFilterModel(columnModel, vizModel.getContainingAnswerModel(), sageClient);\n    }\n    else {\n        return $q.when(filterModel);\n    }\n}\nfunction getRangeDefinitionFromModel(filterModel) {\n    let rangeDefinition = new rangeOperatorUtil.RangeDefinitionInLeafOperators();\n    if (filterModel.getConditions().length !== 1) {\n        logger.error('Only one filter row expected in case of range definition');\n        return;\n    }\n    let filterRow = filterModel.getConditions()[0];\n    let firstOperator = filterRow.condition.op, filterValues = filterRow.condition.values.map(function (filterValue) {\n        return getValue(filterValue);\n    });\n    if (firstOperator === void 0) {\n        logger.error('Insufficient information to show a filter', JSON.stringify(filterRow.condition));\n        return;\n    }\n    let isBetweenOperator = rangeOperatorUtil.isBetweenOperator(firstOperator);\n    if (isBetweenOperator && filterValues.length !== 2) {\n        logger.error('Incorrect filter state passed, between op should have 2 operands');\n        return;\n    }\n    if (isBetweenOperator) {\n        rangeDefinition = rangeOperatorUtil.mapBetweenToLeafOperators(firstOperator, filterValues);\n    }\n    else {\n        rangeDefinition.setFirstOperator(firstOperator);\n        if (filterValues && filterValues.length > 0) {\n            rangeDefinition.setFirstOperand(filterValues[0]);\n        }\n    }\n    let filterColumn = filterModel.getColumn();\n    if (filterColumn.isDateColumn()) {\n        if (!!rangeDefinition.firstOperand) {\n            rangeDefinition.firstOperand =\n                getFormattedDateFromEpochInSeconds(rangeDefinition.firstOperand);\n        }\n        if (!!rangeDefinition.secondOperand) {\n            rangeDefinition.secondOperand =\n                getFormattedDateFromEpochInSeconds(rangeDefinition.secondOperand);\n        }\n    }\n    return rangeDefinition;\n}\nfunction findMatchingFilterModel(logicalColumn, aggr, filterModels) {\n    let columnId = logicalColumn.getGuid();\n    let matchingFilterModel = filterModels.find(function (filterModel) {\n        let formulaIdMatch = true;\n        let filterColumn = filterModel.getColumn();\n        let filterColumnGuid = filterColumn.getBaseLogicalColumnGuid();\n        let filterColumnAggr = filterColumn.getEffectiveAggregateType();\n        let filterSageAggr = sage.AggregationType[filterColumnAggr];\n        if (filterColumn.isInAnswerFormula()) {\n            if (!logicalColumn.isFormula()) {\n                formulaIdMatch = false;\n            }\n            else {\n                formulaIdMatch =\n                    filterColumn.getBaseFormulaId() === logicalColumn.getFormulaId();\n            }\n        }\n        return columnId === filterColumnGuid\n            && filterSageAggr === aggr\n            && formulaIdMatch;\n    });\n    return matchingFilterModel;\n}\nfunction getFormattedDateFromEpochInSeconds(epoch) {\n    if (!epoch) {\n        return null;\n    }\n    let epochInMs = parseInt(epoch, 10) * 1000;\n    // Note (sunny): We ignore custom calendar in formatting here\n    // because date range filter is not able to handle it.\n    return formatDate(epochInMs, dateFormatPresets.DATE_SHORT, true);\n}\nfunction isCompoundFilter(filterContentJson) {\n    return filterContentJson.hasOwnProperty(jsonConstants.COMPOUND_INDICES_KEY) &&\n        filterContentJson[jsonConstants.COMPOUND_INDICES_KEY].length > 0;\n}\nexport { triggerFilterCloseEvent, clearLoadingIndicator, showNewFilterAsLoading, showErrorLoadingFilter, getFilterTokensByTransform, fetchNewFilterModel, updateFilterModelWithValues, filterValuesMatchingFilterColumnValues, filterColumnGetExactValue, filterColumnContainsValue, getMatchingFilterModel, getRangeDefinitionFromModel, findMatchingFilterModel, isCompoundFilter };\nProvide('filterUtil')({\n    triggerFilterCloseEvent,\n    clearLoadingIndicator,\n    showNewFilterAsLoading,\n    showErrorLoadingFilter,\n    getFilterTokensByTransform,\n    fetchNewFilterModel,\n    updateFilterModelWithValues,\n    filterValuesMatchingFilterColumnValues,\n    filterColumnGetExactValue,\n    filterColumnContainsValue,\n    getMatchingFilterModel,\n    getRangeDefinitionFromModel,\n    findMatchingFilterModel,\n    isCompoundFilter\n});\n//# sourceMappingURL=filter-util.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview\n */\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport _ from 'lodash';\nimport { Provide } from '../../../../base/decorators';\nimport { AttributeFilterModelV3 } from '../../../../object-model/filter/attribute-filter-model';\nimport { DateFilterModelV3 } from '../../../../object-model/filter/date-filter-model';\nimport { FilterCondition } from '../../../../object-model/filter/filter-condition';\nimport { MeasureFilterModelV3 } from '../../../../object-model/filter/measure-filter-model';\nimport { WorksheetColumn } from '../../../worksheet/models/worksheet-column';\nimport { Filter } from './filter';\nimport * as filterUtil from './filter-util';\nexport function getFilterModelFromAnswerJson(vizJson, filterJson, answermodel) {\n    let id = vizJson[jsonConstants.HEADER_KEY][jsonConstants.ID_KEY];\n    let vizContent = vizJson[jsonConstants.VIZ_CONTENT_KEY];\n    let isCorrupt = vizJson[jsonConstants.VIZ_COMPLETE_KEY];\n    let filter = new Filter(filterJson);\n    let filterRowIndex = filterUtil.isCompoundFilter(vizContent)\n        ? vizContent[jsonConstants.COMPOUND_INDICES_KEY][0]\n        : vizContent[jsonConstants.filter.ROW_INDEX];\n    let filterRow = filter.getFilterContent().getRowAtIndex(filterRowIndex);\n    let filterRows;\n    if (filterUtil.isCompoundFilter(vizContent)) {\n        filterRows = vizContent[jsonConstants.COMPOUND_INDICES_KEY].map((idx) => {\n            return filter.getFilterContent().getRowAtIndex(idx);\n        });\n    }\n    else {\n        filterRows = [filterRow];\n    }\n    let vizColumn = filterRow.getColumn();\n    // let filterColumn = new AnswerFilterVisualizationColumn(vizColumn);\n    let allConditions = filterRows.map(row => row.getFilterConditions());\n    let filterConditions = _.flatten(allConditions);\n    if (vizColumn.isDateColumn()) {\n        return new DateFilterModelV3(vizColumn, filterConditions, isCorrupt, id, answermodel);\n    }\n    else if (vizColumn.isAttribute()) {\n        return new AttributeFilterModelV3(vizColumn, filterConditions, isCorrupt, id, answermodel);\n    }\n    else {\n        return new MeasureFilterModelV3(vizColumn, filterConditions, isCorrupt, id, answermodel);\n    }\n}\nexport function getFilterModelForWorksheetPanel(worksheetColumn, filter) {\n    let column = new WorksheetColumn(worksheetColumn);\n    let filterConditions = [\n        new FilterCondition(filter, column)\n    ];\n    let isCorrupt;\n    let id = filter.filterId;\n    let answermodel = null;\n    if (column.isDateColumn()) {\n        return new DateFilterModelV3(column, filterConditions, isCorrupt, id, answermodel);\n    }\n    else if (column.isAttribute()) {\n        return new AttributeFilterModelV3(column, filterConditions, isCorrupt, id, answermodel);\n    }\n    else {\n        return new MeasureFilterModelV3(column, filterConditions, isCorrupt, id, answermodel);\n    }\n}\nProvide('FilterModelFactory')({\n    getFilterModelFromAnswerJson\n});\n//# sourceMappingURL=filter-model-factory.js.map","/**\n * Copyright: ThoughtSpot Inc. 2017\n * Author: Manoj Ghosh(manoj.ghosh@thoughtspot.com)\n *\n * @fileoverview Component to display Image powered visualization.\n * customer will provide a R script with custom analysis of a visualization.\n * Sage will create a pinboard having a visualization of type ImageViz with the\n * R script as its content.\n *\n * When displaying the visualization, the data of the visualization will be analysed\n * using the R script and a dynamic PNG will be generated. The image will be sent to blink\n * as base64 encoded img data for display.\n *\n * Example: <img src='data:image/png;base64,iVBORw0KGgoAAA\n * ANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4\n * //8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU\n * 5ErkJggg==' alt='Red dot' />\n *\n * data:[<mime type>][;charset=<charset>][;base64],<encoded data>\n */\nimport * as tslib_1 from \"tslib\";\nimport _ from 'lodash';\nimport { ngRequire, Provide } from '../../../../base/decorators';\nimport { strings } from '../../../../base/strings';\nimport { VisualizationColumnModel } from '../../../callosum/model/visualization-column';\nimport { collectEvent } from '../../../metrics/event-collector';\nimport { VisualizationModel } from '../visualization-model';\nlet csvParserService = ngRequire('csvParserService');\nlet UserAction = ngRequire('UserAction');\nlet VizRdataModel = class VizRdataModel extends VisualizationModel {\n    constructor(params) {\n        super(params);\n        this.alternateText = strings.a3.rdataRenderingFailed;\n        this.isReady = false;\n        this.media = 'data';\n        this.mimeType = 'image';\n        this.mimeSubType = 'png';\n        this.dataType = 'base64';\n        this._vizData = params.vizData;\n        if (!!this._vizData) {\n            this.updateData(this._vizData);\n        }\n        this._init();\n    }\n    getAutoTitle() {\n        let columns = this._visualizationColumns;\n        let [groupingColumns, valueColumns] = _.partition(columns, (column) => {\n            return column['aggrApplied'];\n        });\n        let getColumnName = (column) => { return column['baseColumnName']; };\n        return _([\n            groupingColumns.map(getColumnName).join(', '),\n            valueColumns.map(getColumnName).join(', ')\n        ]).compact().join(` ${strings.BY} `);\n    }\n    getQuestionText() {\n        return '';\n    }\n    getVizColumns() {\n        return [];\n    }\n    /**\n     * This method is called after data of the visualization is fetched\n     * from backend. On receiving the new data, we parse the data and update the\n     * display models to show the image visualization in blink.\n     * @param newVizData\n     */\n    updateData(newVizData) {\n        super.updateData(newVizData);\n        // update image display models like img data etc.\n        this.updateDisplayModel();\n    }\n    getMimeSubtype() {\n        if (!!this.mimeSubType) {\n            return this.mimeSubType;\n        }\n        else {\n            return '';\n        }\n    }\n    getTableModel() {\n        return this.tableModel;\n    }\n    getImageData() {\n        return this.formattedImageData;\n    }\n    getAlternateText() {\n        return this.alternateText;\n    }\n    getRScript() {\n        return this._rScript;\n    }\n    getRTemplateJson() {\n        return this._rTemplateJson;\n    }\n    getColumnBindings() {\n        return this._columnBindings;\n    }\n    getStdErr() {\n        return this.stdErr;\n    }\n    getStdOut() {\n        return this.stdOut;\n    }\n    getException() {\n        return this.exception;\n    }\n    postEventProperties() {\n        let userAction = new UserAction(UserAction.OPEN_CUSTOM_R_VISUALIZATION);\n        let eventProps = {};\n        eventProps['failureSummaryMessage'] = this.stdErr;\n        eventProps['failureMessage'] = this.exception;\n        eventProps['objectSubType'] = this.mimeSubType;\n        eventProps['objectId'] = this._rTemplateJson ? this._rTemplateJson.header.id : '';\n        eventProps['rColBindingCount'] = this._columnBindings.length;\n        let failed = !!this.stdErr || !!this.exception;\n        eventProps['insightStatus'] = failed ? 'FAILED' : 'SUCCESS';\n        collectEvent(userAction, eventProps);\n    }\n    _init() {\n        this.setRenderReady(true);\n        this.parseDefinition(this);\n    }\n    parseDefinition(vizRModel) {\n        let vizRJson = vizRModel.getJson();\n        if (!vizRJson) {\n            return;\n        }\n        vizRModel._rScript = vizRJson.rScript;\n        vizRModel._rTemplateJson = vizRJson.rTemplate;\n        vizRModel._columnBindings = vizRJson.columnBindings;\n        vizRModel._visualizationColumns = vizRJson.visualizationColumns;\n        vizRModel.mimeSubType = vizRJson.outputType;\n        if (!!this._vizData) {\n            this._visualizationColumns = vizRJson.visualizationColumns.map((c, idx) => {\n                // let colData = this.getColumnData(idx);\n                return new VisualizationColumnModel(c, idx, null);\n            });\n        }\n    }\n    updateDisplayModel() {\n        this.parseVizData();\n    }\n    parseVizData() {\n        if (!!this._vizData && !!this._vizData) {\n            let rdata = this._vizData;\n            this.mimeSubType = rdata.dataType;\n            this.dataContent = rdata.data;\n            this.stdErr = rdata.stdErr;\n            this.stdOut = rdata.stdOut;\n            this.exception = rdata.exception;\n        }\n        if (this.mimeSubType === strings.a3.CSV) {\n            let csv = csvParserService.parse(this.dataContent);\n            let columns = [];\n            let j = 0;\n            if (!csv.data || !csv.data[0]) {\n                this.tableModel = {\n                    data: [],\n                    columns: []\n                };\n                return;\n            }\n            csv.data[0].forEach(function (value) {\n                columns.push({\n                    name: value,\n                    field: 'f' + j,\n                    minWidth: 150,\n                    id: 'f' + j\n                });\n                j++;\n            });\n            let data = [];\n            for (let i = 1; i < csv.data.length; i++) {\n                if (csv.data[i].length !== columns.length) {\n                    continue;\n                }\n                let rowData = {};\n                for (let k = 0; k < csv.data[i].length; k++) {\n                    rowData['f' + k] = csv.data[i][k];\n                }\n                data.push(rowData);\n            }\n            this.tableModel = {\n                data: data,\n                columns: columns\n            };\n        }\n        else if (this.mimeSubType === strings.a3.PNG) {\n            // Build data:[<mime type>][;charset=<charset>][;base64],<encoded data>\n            let uri = `${this.media}:${this.mimeType}/${this.mimeSubType}`;\n            let data = `;${this.dataType},${this.dataContent}`;\n            this.formattedImageData = `${uri}${data}`;\n        }\n        this.isReady = true;\n        this.setSecondaryRenderReady(true);\n    }\n};\nVizRdataModel = tslib_1.__decorate([\n    Provide('VizRdataModel')\n], VizRdataModel);\nexport { VizRdataModel };\n//# sourceMappingURL=viz-rdata-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2013\n * Author: Vibhor Nanavati (vibhor@thoughtspot.com)\n * Francois Chabbey (francois.chabbey@thoughtspot.com)\n *\n * @fileoverview Model for encapsulating table visualization details.\n */\n'use strict';\nimport * as tslib_1 from \"tslib\";\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport { create, ProfileMessages } from '@thoughtspot/logger';\nimport { ngRequire, Provide } from '../../../../base/decorators';\nimport { strings } from '../../../../base/strings';\nimport { QueryData } from '../../../callosum/model/query-data';\nimport { VisualizationModel } from '../visualization-model';\nlet tableUtil = ngRequire('tableUtil');\nlet SimpleTableModel = class SimpleTableModel extends VisualizationModel {\n    constructor(params) {\n        super(params);\n        this._vizColumnsMap = this.getVizColumns().reduce((acc, col) => {\n            acc[col.getId()] = col;\n            return acc;\n        }, {});\n        this.parseData();\n    }\n    updateData(vizContent) {\n        super.updateData(vizContent);\n        this.parseData();\n    }\n    allowsFormulaAddition() {\n        return !this.isPinboardViz();\n    }\n    hasError() {\n        return this._hasError;\n    }\n    /**\n     * @param {string} effectiveColId\n     * @return {VisualizationColumnModel}\n     */\n    getColumn(effectiveColId) {\n        return this._vizColumnsMap[effectiveColId];\n    }\n    getData() {\n        if (!this._vizData || !this._vizData.data) {\n            return null;\n        }\n        return this._vizData.data;\n    }\n    hasNoData() {\n        let data = this.getData();\n        return !data || data.length === 0;\n    }\n    isColumnReorderingAllowed() {\n        return !this.isPinboardViz() && !this.getIsPBDDViz();\n    }\n    getDataArray() {\n        if (this._vizData) {\n            let dataArray = new QueryData(Array.isArray(this._vizData)\n                ? this._vizData[0] : this._vizData);\n            return [dataArray];\n        }\n        return [];\n    }\n    get gridClientState() {\n        return this.getUserData(jsonConstants.gridConfig.WIDGET_STATE);\n    }\n    set gridClientState(state) {\n        this.setUserData(jsonConstants.gridConfig.WIDGET_STATE, state);\n    }\n    get gridColumnWidthState() {\n        return this.getUserData(jsonConstants.gridConfig.WIDTH_STATE);\n    }\n    set gridColumnWidthState(state) {\n        this.setUserData(jsonConstants.gridConfig.WIDTH_STATE, state);\n    }\n    get showGridSummaries() {\n        return this.getUserData(jsonConstants.gridConfig.SHOW_GRID_SUMMARY);\n    }\n    set showGridSummaries(state) {\n        this.setUserData(jsonConstants.gridConfig.SHOW_GRID_SUMMARY, state);\n    }\n    get wrapTableHeader() {\n        return this.getUserData(jsonConstants.gridConfig.WRAP_TABLE_HEADER);\n    }\n    set wrapTableHeader(state) {\n        this.setUserData(jsonConstants.gridConfig.WRAP_TABLE_HEADER, state);\n    }\n    get gridColumnOrder() {\n        return this.getUserData(jsonConstants.ORDERED_COLUMN_IDS);\n    }\n    set gridColumnOrder(orderedColumnIds) {\n        this.setUserData(jsonConstants.ORDERED_COLUMN_IDS, orderedColumnIds);\n    }\n    hasMetrics() {\n        return this.getVizColumns().some(column => column.getMetricsDefinition() !== null);\n    }\n    getAutoTitle() {\n        let columns = this.getVizColumns();\n        let groupingColumns = [];\n        let valueColumns = [];\n        columns.forEach((column) => {\n            if (column.isGroupingColumn()) {\n                groupingColumns.push(column);\n            }\n            else {\n                valueColumns.push(column);\n            }\n        });\n        let valueColumnNames = valueColumns.map(function (column) { return column.getName(); })\n            .join(', ');\n        let groupingColumnNames = groupingColumns.map(function (column) { return column.getName(); })\n            .join(', ');\n        if (valueColumnNames && groupingColumnNames) {\n            return valueColumnNames + ' ' + strings.BY + ' ' + groupingColumnNames;\n        }\n        else if (valueColumnNames) {\n            return valueColumnNames;\n        }\n        else if (groupingColumnNames) {\n            return groupingColumnNames;\n        }\n        else {\n            return '';\n        }\n    }\n    toSlickgridTableInfo() {\n        return new SlickgridTableModel(this);\n    }\n    isColAttribute(column) {\n        return column.isEffectivelyNonNumeric() || column.isGroupingColumn();\n    }\n    parseData() {\n        let vizContent = this.getJson();\n        let processingProfileMsg = `${ProfileMessages.TABLE_VIZ_PROCESSING_PREAMBLE}\\'${this.getName()}\\'`;\n        this._logger.time(processingProfileMsg);\n        if (!this._vizData\n            || !vizContent\n            || !vizContent.columns) {\n            this._hasError = true;\n            return;\n        }\n        this._hasError = false;\n        this.getVizColumns().forEach((vizCol) => {\n            let dataRowIndex = vizCol.getDataRowIndex();\n            let colData = this.getColumnData(dataRowIndex);\n            vizCol.setData(colData);\n        });\n        this._logger.timeEnd(processingProfileMsg);\n    }\n};\nSimpleTableModel = tslib_1.__decorate([\n    Provide('SimpleTableModel')\n], SimpleTableModel);\nexport { SimpleTableModel };\n/**\n * Converts tableModel to basic slick grid model and configuration.\n * This is needed for leaf level data.\n * @param tableModel\n * @private\n * @constructor\n */\nclass SlickgridTableModel {\n    constructor(parentTableModel) {\n        this.parentTableModel = parentTableModel;\n        this._logger = create('SlickGridTableLogger');\n        if (!parentTableModel) {\n            this._logger.error('Constructing slickgrid table model without underlying model');\n            return;\n        }\n        let parentColumns = parentTableModel.getVizColumns(), dataFormatter = angular.bind(this, this.dataFormatter), getTooltipForColumnHeader = angular.bind(this, this.getTooltipForColumnHeader), columns = parentColumns.map((vizCol, i) => {\n            return {\n                id: vizCol.getId(),\n                name: vizCol.getName(),\n                headerCssClass: vizCol.isNumeric() ? 'bk-numeric-column-header' : '',\n                cssClass: vizCol.isNumeric() ? 'bk-numeric-column' : '',\n                field: `f${i}`,\n                formatter: dataFormatter,\n                toolTip: '',\n                getTooltipForColumnHeader: getTooltipForColumnHeader\n            };\n        });\n        let data = parentTableModel.getData().map((row) => {\n            let rowWithField = {};\n            row.forEach((val, i) => {\n                rowWithField[`f${i}`] = val;\n            });\n            return rowWithField;\n        });\n        this.model = {\n            columns: columns,\n            data: data\n        };\n        this.config = {};\n    }\n    dataFormatter(row, cell, value, columnDef) {\n        let column = this.parentTableModel.getColumn(columnDef.id);\n        if (!column) {\n            return null;\n        }\n        return tableUtil.getFormattedValue(column, value);\n    }\n    getTooltipForColumnHeader(columnDef) {\n        let column = this.parentTableModel.getColumn(columnDef.id);\n        if (!column) {\n            return '';\n        }\n        return column.getSourcesTooltip();\n    }\n}\n//# sourceMappingURL=simple-table-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2017\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Visualization model for the viz cluster.\n */\nimport * as tslib_1 from \"tslib\";\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport { Provide } from '../../../../base/decorators';\nimport { VisualizationModel } from '../visualization-model';\nlet VizClusterModel = class VizClusterModel extends VisualizationModel {\n    constructor(params) {\n        super(params);\n        this.clusteredVisualizations = [];\n        this.vizJson = params.vizJson;\n    }\n    resolveMembers(vizMap) {\n        this.vizJson[jsonConstants.VIZ_CONTENT_KEY][jsonConstants.REF_VIZ_IDS_KEY].forEach((id) => {\n            this.addVisualization(vizMap[id]);\n        });\n        this._isRenderReady = true;\n        this._isSecondaryRenderReady = true;\n    }\n    getQuestionText() {\n        return '';\n    }\n    getVizColumns() {\n        return [];\n    }\n    getReferencedVizIds() {\n        return this.clusteredVisualizations.map((viz) => {\n            return viz.getId();\n        });\n    }\n    addVisualization(visualizationModel) {\n        this.clusteredVisualizations.push(visualizationModel);\n    }\n};\nVizClusterModel = tslib_1.__decorate([\n    Provide('VizClusterModel')\n], VizClusterModel);\nexport { VizClusterModel };\n//# sourceMappingURL=viz-cluster-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2016\n * Author: Shashank Singh (sunny@thoughtspot.com)\n *\n * @fileoverview Data model for headline visualization column.\n */\nimport * as tslib_1 from \"tslib\";\nimport { Provide } from '../../../../base/decorators';\nimport { VisualizationColumnModel } from '../../../callosum/model/visualization-column';\nimport { isDimensionlessAggregationType } from '../../../callosum/model/visualization-column-util';\nlet HeadlineColumnModel = class HeadlineColumnModel extends VisualizationColumnModel {\n    constructor(columnDefinition, dataRowIndex, columnData, aggrs, possibleAggrs) {\n        super(columnDefinition, dataRowIndex, columnData);\n        this.aggrs = aggrs;\n        this.possibleAggrs = possibleAggrs;\n    }\n    isEffectivelyPercent() {\n        if (!VisualizationColumnModel.prototype.isEffectivelyPercent.call(this)) {\n            return false;\n        }\n        const aggrType = this.aggrs[0];\n        return !isDimensionlessAggregationType(aggrType);\n    }\n};\nHeadlineColumnModel = tslib_1.__decorate([\n    Provide('HeadlineColumnModel')\n], HeadlineColumnModel);\nexport { HeadlineColumnModel };\n//# sourceMappingURL=headline-column-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2013\n * Author: Vibhor Nanavati (vibhor@thoughtspot.com)\n *\n * @fileoverview Model for encapsulating headline visualization details.\n */\n'use strict';\nimport * as tslib_1 from \"tslib\";\nimport { create } from '@thoughtspot/logger';\nimport _ from 'lodash';\nimport { Provide } from '../../../../base/decorators';\nimport { flags } from '../../../../base/flags';\nimport { getAggregateLabel } from '../../../callosum/model/visualization-column-util';\nimport { VisualizationModel } from '../visualization-model';\nimport { HeadlineColumnModel } from './headline-column-model';\nconst _logger = create('headline-model');\nlet HeadlineModel = class HeadlineModel extends VisualizationModel {\n    constructor(params) {\n        super(params);\n        this.params = params;\n        this._answerModel = params.answerModel || null;\n        this._columns = this.getJson().columns.map((col) => {\n            return col.column;\n        });\n        this.init();\n    }\n    static hasError() {\n        return false;\n    }\n    getVisualizedColumns() {\n        return [this.getVizColumns()[0]];\n    }\n    hasNoData() {\n        return !this._vizData || !this._vizData.data || !this._vizData.data.length;\n    }\n    updateData(vizData) {\n        super.updateData(vizData);\n        this.init();\n    }\n    getColumns() {\n        return this._columns;\n    }\n    getColumn() {\n        return this._column;\n    }\n    getColumnName() {\n        return this._column.getName();\n    }\n    getHeadlineTeslaTitle() {\n        return this._column.getName(false);\n    }\n    getSupportedSummaryTypes() {\n        return this._column.getSupportedAggregationTypes();\n    }\n    getAggregateSize() {\n        let vizJson = this.getJson();\n        if (!vizJson.columns.length) {\n            return 0;\n        }\n        if (this._doesAggrExists) {\n            return vizJson.columns[0].aggrs.length;\n        }\n        return 0;\n    }\n    getAggregateLabel(index) {\n        let type = this.getAggregateType(index);\n        if (_.isNull(type)) {\n            return '';\n        }\n        return getAggregateLabel(type);\n    }\n    addAggregate(aggrType) {\n        let vizJson = this.getJson();\n        if (this._doesAggrExists) {\n            vizJson.columns[0].aggrs.push(aggrType);\n        }\n    }\n    getAggregateType(index = 0) {\n        if (this.getAggregateSize() <= 0) {\n            return null;\n        }\n        let vizJson = this.getJson();\n        if (this._doesAggrExists && vizJson.columns[0].aggrs.length) {\n            return vizJson.columns[0].aggrs[index];\n        }\n    }\n    setAggregateType(index = 0, type, expandIfNeeded) {\n        if (this.getAggregateSize() <= index) {\n            if (!expandIfNeeded) {\n                _logger.error('Can not set aggregate type for out of bound index', index);\n                return;\n            }\n            this.addAggregate(type);\n            return;\n        }\n        let vizJson = this.getJson();\n        if (this._doesAggrExists && vizJson.columns[0].aggrs.length) {\n            vizJson.columns[0].aggrs[index] = type;\n        }\n    }\n    removeAggregate(index) {\n        let vizJson = this.getJson();\n        if (this._doesAggrExists && index >= 0 && index < vizJson.columns[0].aggrs.length) {\n            vizJson.columns[0].aggrs.splice(index, 1);\n        }\n        let data = this._vizData.data;\n        if (data && data.length && index >= 0 && index < data.length) {\n            return data.splice(index, 1);\n        }\n    }\n    getAggregates() {\n        let vizJson = this.getJson();\n        if (this._doesAggrExists) {\n            return vizJson.columns[0].aggrs;\n        }\n        return [];\n    }\n    getPossibleAggregates(index) {\n        let vizJson = this.getJson();\n        return vizJson.columns && vizJson.columns[index] && vizJson.columns[index].possibleAggrs\n            ? vizJson.columns[index].possibleAggrs\n            : [];\n    }\n    createVizColumns() {\n        let vizModel = this;\n        let aggregates = this.getAggregates();\n        return this.getColumns().map(function (c, idx) {\n            let colData = vizModel.getColumnData(idx);\n            let possibleAggrs = vizModel.getPossibleAggregates(idx);\n            return new HeadlineColumnModel(c, idx, colData, aggregates, possibleAggrs);\n        });\n    }\n    getDataValueUnformatted(dataValueIndex) {\n        if (!this.getColumns()) {\n            return null;\n        }\n        let data = this._vizData.data;\n        dataValueIndex = dataValueIndex || 0;\n        if (data && data.length && data[dataValueIndex] && data[dataValueIndex].length) {\n            return data[dataValueIndex][this._column.getDataRowIndex()];\n        }\n        return null;\n    }\n    isTableSummary() {\n        let vizJson = this.getJson();\n        if (!vizJson.columns.length) {\n            return false;\n        }\n        if (vizJson.columns && vizJson.columns.length) {\n            return vizJson.columns[0].tableSummary;\n        }\n        return false;\n    }\n    shouldShowSummaryAggregates() {\n        if (this.getColumn().isDateColumn() || this.getColumn().isTimeColumn()) {\n            return false;\n        }\n        return !!this.getJson().showSummaryAggrs;\n    }\n    getTitle() {\n        if (!this.isPinboardViz()) {\n            let skipPrefix = !this.isTableSummary();\n            return this.getColumn().getName(skipPrefix);\n        }\n        return super.getTitle();\n    }\n    isAggregationSame(headlineModel) {\n        if (!headlineModel\n            || this.getAggregateSize() !== headlineModel.getAggregateSize()) {\n            return false;\n        }\n        for (let i = 0; i < this.getAggregateSize(); ++i) {\n            if (this.getAggregateLabel(i) !== headlineModel.getAggregateLabel(i)) {\n                return false;\n            }\n        }\n    }\n    isDataNodeEmpty() {\n        // Callosum models headline such that multiple column aggregations\n        // can be sent into a single headline. That is not the case currently however and\n        // so we always look at the first summary.\n        let totalSummaries = this.getAggregateSize();\n        // Furthermore, for the same column,\n        // callosum can send multiple summaries (one for each aggregation type).\n        for (let i = 0; i < totalSummaries; ++i) {\n            let value = this.getDataValueUnformatted(i);\n            if (_.isUndefined(value) || _.isNull(value)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    shouldBeSuppressedInUI() {\n        if (!flags.getValue(flags.BLINK_FLAGS.suppressNaHeadlines.name)) {\n            return false;\n        }\n        return this.isDataNodeEmpty();\n    }\n    getDataValueFormatted(dataValueIndex) {\n        let dataValue = this.getColumn().convertValueFromBackend(this.getDataValueUnformatted(dataValueIndex), this.getAggregateType(dataValueIndex));\n        if (_.isNull(dataValue)) {\n            return null;\n        }\n        // we don't use the decimal precision of column for headline columns as it\n        // does not make sense for 1 or 2 data points as in headline data\n        return '' + this._column.getDataFormatter(this.getAggregateType(dataValueIndex))(dataValue);\n    }\n    init() {\n        if (!this.getColumns() || !this.getColumns().length) {\n            throw new Error('Column definition missing in headline viz');\n        }\n        this._column = this.getVizColumns()[0];\n        this._column.setData(this._vizData && this._vizData.data ? this._vizData.data[0] : []);\n        this._doesAggrExists = this.getJson().columns &&\n            this.getJson().columns.length && this.getJson().columns[0].aggrs;\n        if (this.getAggregateSize() > 0 && !this.hasNoData() &&\n            (this._vizData.data.length !== this.getAggregateSize())) {\n            throw new Error('Number of headline data values doesn\\'t match number of aggregates');\n        }\n    }\n};\nHeadlineModel = tslib_1.__decorate([\n    Provide('HeadlineModel')\n], HeadlineModel);\nexport { HeadlineModel };\n//# sourceMappingURL=headline-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2013\n * Author: Joy Dutta (joy@thoughtspot.com),\n * Stephane Kiss (stephane@thoughtspot.com),\n * Vibhor Nanavati (vibhor@thoughtspot.com)\n *\n * @fileoverview Data model for answer (report book)\n * AnswerSheetModel encapsulates the details of an answer sheet data returned\n * from Callosum and exposes model methods to\n * access Visualization models.\n */\n'use strict';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport { create } from '@thoughtspot/logger';\nimport { sage as sageTypes } from '@thoughtspot/ts-proto';\nimport _ from 'lodash';\nimport { ngRequire } from '../../../base/decorators';\nimport sage from '../../../base/proto/sage-namespace-translator';\nimport { QuestionModel } from '../../../modules/callosum/model/question-model';\nimport * as pinboardAnswerSheetUtil from '../../../modules/document-model/answer-model/pinboard-answer-sheet-util';\nimport { AnswerDisplayMode } from '../../../modules/search-pages/base-answer';\nimport { ChartModel } from '../../../modules/viz-layout/viz/chart/chart-model';\nimport { getFilterModelFromAnswerJson } from '../../../modules/viz-layout/viz/filter/filter-model-factory';\nimport { PinboardVizModel } from '../../../modules/viz-layout/viz/pinboard-viz-model';\nimport { VizRdataModel } from '../../../modules/viz-layout/viz/rdata/viz-rdata-model';\nimport { SimpleTableModel } from '../../../modules/viz-layout/viz/table-v2/simple-table-model';\nimport { VizClusterModel } from '../../../modules/viz-layout/viz/viz-cluster/viz-cluster-model';\nimport { VisualizationColumnModel } from '../../callosum/model/visualization-column';\nimport { HeadlineModel } from '../../viz-layout/viz/headline/headline-model';\nimport { VisualizationModel } from '../../viz-layout/viz/visualization-model';\nlet appClientStateService = ngRequire('appClientStateService');\nlet util = ngRequire('util');\nlet _logger = create('answer-sheet-model');\nconst referencableVizTypes = [\n    'CHART',\n    'TABLE'\n];\n/**\n * @constructor\n * @param {Object} params See the comment for the VisualizationModel constructor.\n */\nexport class AnswerSheetModel {\n    constructor(params) {\n        let sheetJson = params.sheetJson, sheetData = params.sheetData, objectResolver = params.objectResolver, answerModel = params.answerModel;\n        if (!sheetJson) {\n            throw new Error('Answer sheet Json expected in AnswerSheetModel constructor');\n        }\n        this.stabilizeReferencableVizIds(sheetJson, sheetData);\n        /**\n         * @type {Object}\n         * @private\n         */\n        this._sheetJson = sheetJson;\n        /**\n         * @type {Object}\n         * @private\n         */\n        this._sheetData = sheetData;\n        /**\n         * @type {Object}\n         * @private\n         */\n        this._objectResolver = objectResolver;\n        /**\n         *\n         * @type {AnswerModel}\n         * @private\n         */\n        this._answerModel = answerModel;\n        /**\n         * @type {string}\n         * @private\n         */\n        this._sheetGuid = this.getSheetGuid(sheetJson);\n        this._errorPreamble = 'Answer sheet ' + this._sheetGuid;\n        if (!sheetJson[jsonConstants.SHEETCONTENT_KEY]) {\n            throw new Error(this._errorPreamble + ' is missing sheet content');\n        }\n        /**\n         * An object hash storing vizContent+header json by their guids.\n         * @type {Object}\n         * @private\n         */\n        this._visualizationsMap = {};\n        this._visualizationsArray = [];\n        /**\n         * A map from filter column effective id -> corresponding filter model.\n         * Only to be used within context of a single answer and not cross the\n         * callosum boundary i.e. do not use\n         * a sage token id to lookup the filter.\n         *\n         * @type {Map.<string, Object>}\n         * @private\n         */\n        this._colEffectiveIdToFilterModels = {};\n        this._parseVisualizations();\n    }\n    /**\n     * @return {string} GUID referring to this answer sheet.\n     */\n    getId() {\n        return this._sheetGuid;\n    }\n    /**\n     * @param GUID to be set. Note that this method is only used by test and should not\n     * be used otherwise.\n     */\n    setId(id) {\n        this._sheetGuid = id;\n    }\n    /**\n     * @return {string}setD\n     * Returns the type of answer sheet (one of QUESTION_ANSWER or PINBOARD).\n     * On error it returns ''.\n     */\n    getSheetType() {\n        if (!this._sheetJson || !this._sheetJson[jsonConstants.SHEETCONTENT_KEY] ||\n            !this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.SHEET_CONTENT_TYPE_KEY]) {\n            return '';\n        }\n        return this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.SHEET_CONTENT_TYPE_KEY];\n    }\n    hasDataForViz(vizId) {\n        return this._sheetData\n            && this._sheetData[jsonConstants.VIZ_DATA_KEY]\n            && this._sheetData[jsonConstants.VIZ_DATA_KEY].hasOwnProperty(vizId);\n    }\n    setDataForViz(vizId, vizType, vizData) {\n        if (!this._sheetData) {\n            this._sheetData = {};\n        }\n        if (!this._sheetData[jsonConstants.VIZ_DATA_KEY]) {\n            this._sheetData[jsonConstants.VIZ_DATA_KEY] = {};\n        }\n        let vizDataNode = this._sheetData[jsonConstants.VIZ_DATA_KEY][vizId] = {};\n        if (vizType.toLowerCase() === jsonConstants.VIZ_TYPE_CHART) {\n            vizDataNode[jsonConstants.CHART_DATA_KEY] = vizData;\n        }\n        else {\n            vizDataNode[jsonConstants.DATA_SETS_KEY] = {};\n            vizDataNode[jsonConstants.DATA_SETS_KEY][vizType] = vizData;\n        }\n    }\n    clearDataForViz(vizId) {\n        if (!this._sheetData || !this._sheetData[jsonConstants.VIZ_DATA_KEY]) {\n            return;\n        }\n        delete this._sheetData[jsonConstants.VIZ_DATA_KEY][vizId];\n    }\n    getSheetData() {\n        return this._sheetData;\n    }\n    updateVizData(sheetData) {\n        this._sheetData = this._sheetData || {};\n        this._sheetData[jsonConstants.VIZ_DATA_KEY] = sheetData[jsonConstants.VIZ_DATA_KEY];\n        this._parseVisualizations();\n    }\n    /**\n     * Gets the question object from the json\n     */\n    getQuestionInfo() {\n        let questionJson = this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.QUESTION_KEY];\n        return new QuestionModel(questionJson);\n    }\n    /**\n     * @return {string}\n     * Returns the answer sheet name\n     */\n    getName() {\n        return this._sheetJson[jsonConstants.HEADER_KEY][jsonConstants.NAME_KEY];\n    }\n    _needsVizIdStabilization() {\n        return this.getSheetType() === 'QUESTION';\n    }\n    _trackVizId(vizType, vizId) {\n        return;\n        if (!referencableVizTypes.includes(vizType) || !this._needsVizIdStabilization()) {\n            return;\n        }\n        let clientState = appClientStateService.getClientState(this.getId()), trackedVizIds;\n        if (!clientState.trackedVizIds) {\n            clientState.trackedVizIds = {};\n        }\n        trackedVizIds = clientState.trackedVizIds;\n        // If there are more than one viz of same type, we use the last one.\n        // This is okay because we only do this in\n        // answer and only for chart and table viz types.\n        trackedVizIds[vizType] = vizId;\n    }\n    _addToColumnGuidToFilterModelMap(filterModel) {\n        let filterColumn = filterModel.getColumn();\n        let self = this;\n        // Put the output guids with the same logcial key.\n        filterColumn.getOutputIdsWithMatchingLogicalKey().forEach(function (id) {\n            self._colEffectiveIdToFilterModels[id] = filterModel;\n        });\n        // Putting the outputGuid of the column itself to the map as well.\n        self._colEffectiveIdToFilterModels[filterModel.getColumn().getId()] = filterModel;\n    }\n    _addVisualization(visualizationModel) {\n        this._visualizationsMap[visualizationModel.getId()] = visualizationModel;\n        this._visualizationsArray = _.values(this._visualizationsMap);\n    }\n    /**\n     * Parses the visualizations list in the sheet json into VisualizationModel\n     * object and populates the guid based hash\n     * of visualization objects.\n     * @private\n     */\n    _parseVisualizations() {\n        // TODO(Jasmeet): Move the logic of object creation to a VisualizationModelFactory.\n        let visualizations = this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.VISUALIZATIONS_KEY];\n        if (!visualizations) {\n            _logger.warn(this._errorPreamble + ' is missing visualizations spec');\n            return;\n        }\n        if (!this._sheetData || !this._sheetData[jsonConstants.VIZ_DATA_KEY]) {\n            _logger.warn(this._errorPreamble + ' is missing sheet vizData spec');\n            return;\n        }\n        let answerModel = this._answerModel, vizs = visualizations.map(function (vizJson) {\n            return new VisualizationModel({\n                vizJson: vizJson,\n                answerModel: answerModel\n            });\n        }), vizDataContainer = this._sheetData[jsonConstants.VIZ_DATA_KEY], vizDataSets = vizs.map(function (viz) {\n            if (viz.isCorrupted()) {\n                return null;\n            }\n            // If the viz is configured to load data lazily, allow the answer\n            // sheet to build the visualization model\n            // to include some partial info (like filter title).\n            if (viz.isDataOnDemand()) {\n                return null;\n            }\n            if (!vizDataContainer.hasOwnProperty(viz.getId())) {\n                return null;\n            }\n            let vizType = viz.getVizType();\n            if (vizType.toLowerCase() === jsonConstants.VIZ_TYPE_CHART) {\n                return vizDataContainer[viz.getId()][jsonConstants.CHART_DATA_KEY] || null;\n            }\n            let dataSets = vizDataContainer[viz.getId()][jsonConstants.DATA_SETS_KEY] || null;\n            if (!dataSets) {\n                return null;\n            }\n            return dataSets[viz.getVizType()];\n        });\n        let mustVisualizeColumns;\n        if ((this.getSageContext())) {\n            mustVisualizeColumns = this.getSageContext()\n                .getTables()[this.getSageContextIndex()]\n                .getMustVisualizeColumnGuids();\n        }\n        // make one pass over all the visualization data, creating\n        // Visualizations and collating columns information\n        // from all the visualizations. we need to do this as at\n        // this moment no single visualization has info about\n        // all the columns. For example, table does not have the\n        // filter columns but only table has cardinality information\n        let allColumnsByEffectiveId = {}, vizTypesForColumnId = {};\n        vizs.forEach((viz, vizIndex) => {\n            if (viz.isCorrupted()) {\n                return;\n            }\n            let cols = viz.getColumns();\n            //viz does not have columns info\n            if (!cols) {\n                return;\n            }\n            let vizData = vizDataSets && vizDataSets[vizIndex], vizType = viz.getVizType();\n            cols.forEach(function (colJson, colIndex) {\n                if (!colJson) {\n                    return;\n                }\n                //the structure of colJson is different for headline compared to table\n                // We ignore columns from headlines as they are supposed to be copies\n                // of table columns.\n                if (vizType === 'HEADLINE') {\n                    return;\n                }\n                let vizCol = new VisualizationColumnModel(colJson, -1), effectiveId = vizCol.getId();\n                vizCol.isMustVisualize = mustVisualizeColumns\n                    && mustVisualizeColumns.has(effectiveId);\n                if (!_.has(vizTypesForColumnId, effectiveId)) {\n                    vizTypesForColumnId[effectiveId] = [];\n                }\n                vizTypesForColumnId[effectiveId].push(vizType);\n                if (!_.has(allColumnsByEffectiveId, effectiveId)) {\n                    allColumnsByEffectiveId[effectiveId] = vizCol;\n                }\n            });\n        });\n        let allColumns = Object.values(allColumnsByEffectiveId);\n        Object.keys(allColumnsByEffectiveId).forEach(function (colId) {\n            let sourceVizTypes = vizTypesForColumnId[colId];\n            //a column is a \"filter column\" iff its only source is a filter viz\n            if (sourceVizTypes.length === 1 && sourceVizTypes[0] === 'FILTER') {\n                let col = allColumnsByEffectiveId[colId];\n                col.setIsFilterColumn(true);\n            }\n        });\n        let resolvedObjects = pinboardAnswerSheetUtil.getVisualizationAnswerModels(this._objectResolver, this._answerModel);\n        let colorIndex = 0;\n        let clusterVizs = [];\n        for (let i = 0; i < vizs.length; ++i) {\n            let viz = vizs[i], vizJson = visualizations[i];\n            let data = vizDataSets && vizDataSets[i];\n            switch (viz.getVizType()) {\n                case jsonConstants.VIZ_TYPE_CHART.toUpperCase():\n                    try {\n                        let chartModel = new ChartModel({\n                            vizJson: vizJson,\n                            answerModel: this._answerModel,\n                            allColumns: allColumns\n                        });\n                        chartModel.updateData(data);\n                        this._addVisualization(chartModel);\n                        this._trackVizId('CHART', viz.getId());\n                    }\n                    catch (e) {\n                        _logger.error('error in creating a chart model', e);\n                    }\n                    break;\n                case jsonConstants.VIZ_TYPE_TABLE.toUpperCase():\n                    try {\n                        let tableModel = new SimpleTableModel({\n                            vizJson: vizJson,\n                            vizData: data,\n                            answerModel: this._answerModel\n                        });\n                        this._addVisualization(tableModel);\n                        this._trackVizId('TABLE', viz.getId());\n                    }\n                    catch (e) {\n                        _logger.error('error in creating a table model', e);\n                    }\n                    break;\n                case jsonConstants.VIZ_TYPE_R_ANALYSIS.toUpperCase():\n                    try {\n                        let rdataModel = new VizRdataModel({\n                            vizJson: vizJson,\n                            vizData: data,\n                            answerModel: this._answerModel\n                        });\n                        this._addVisualization(rdataModel);\n                        this._trackVizId('R_ANALYSIS_VIZ', viz.getId());\n                    }\n                    catch (e) {\n                        _logger.error('error in creating a image model', e);\n                    }\n                    break;\n                case jsonConstants.VIZ_TYPE_HEADLINE.toUpperCase():\n                    try {\n                        let hModel = new HeadlineModel({\n                            vizJson: vizJson,\n                            vizData: data,\n                            answerModel: this._answerModel\n                        });\n                        this._trackVizId('HEADLINE', viz.getId());\n                        this._addVisualization(hModel);\n                    }\n                    catch (e) {\n                        _logger.error('error in creating a headline model', e);\n                    }\n                    break;\n                case jsonConstants.VIZ_TYPE_FILTER.toUpperCase():\n                    try {\n                        let filterModel = getFilterModelFromAnswerJson(vizJson, _.get(this._sheetJson, 'sheetContent.filter', null), this._answerModel);\n                        this._addVisualization(filterModel);\n                        this._addToColumnGuidToFilterModelMap(filterModel);\n                    }\n                    catch (e) {\n                        _logger.error('error in creating a filter model', e);\n                    }\n                    break;\n                case jsonConstants.VIZ_TYPE_PINBOARD.toUpperCase():\n                    try {\n                        let referencedAnswerModel = resolvedObjects[vizJson.vizContent.refVizId];\n                        let pinboardViz = new PinboardVizModel({\n                            vizJson: vizJson,\n                            pinboardModel: this._answerModel,\n                            referencedAnswerModel: referencedAnswerModel,\n                            refVizId: vizJson.vizContent.refVizId\n                        });\n                        let referencedViz = pinboardViz.getReferencedVisualization();\n                        if (!referencedViz) {\n                            _logger.error('Referenced viz not found in pinboard viz', pinboardViz);\n                            break;\n                        }\n                        if (referencedViz.getVizType() === 'CHART') {\n                            referencedViz.setContextOptions({\n                                colorIndex: colorIndex++\n                            });\n                        }\n                        this._addVisualization(pinboardViz);\n                    }\n                    catch (e) {\n                        _logger.error('error in creating a pinboard viz model', e);\n                    }\n                    break;\n                case jsonConstants.VIZ_TYPE_GENERIC.toUpperCase():\n                    try {\n                        let referencedGenericViz = pinboardAnswerSheetUtil\n                            .resolveReferencedGenericVisualization(viz.getVizSubtype(), vizJson, this._answerModel);\n                        let pinboardVizGeneric = new PinboardVizModel({\n                            vizJson: vizJson,\n                            pinboardModel: this._answerModel,\n                            referencedModel: referencedGenericViz\n                        });\n                        if (!!pinboardVizGeneric) {\n                            let referencedVizGeneric = pinboardVizGeneric\n                                .getReferencedVisualization();\n                            if (!referencedVizGeneric) {\n                                if (!viz.isCorrupted()) {\n                                    _logger.error('A valid pinboard visualization found ' +\n                                        'without a referenced visualization', vizJson);\n                                    return;\n                                }\n                            }\n                            this._addVisualization(pinboardVizGeneric);\n                        }\n                    }\n                    catch (e) {\n                        _logger.error('error in creating a pinboard viz model', e);\n                    }\n                    break;\n                case jsonConstants.VIZ_TYPE_CLUSTER:\n                    let clusterViz = new VizClusterModel({\n                        vizJson: vizJson,\n                        vizMap: this._visualizationsMap,\n                        answerModel: this._answerModel\n                    });\n                    let pbViz = new PinboardVizModel({\n                        vizJson: vizJson,\n                        referencedAnswerModel: this._answerModel,\n                        referencedModel: clusterViz\n                    });\n                    this._addVisualization(pbViz);\n                    clusterVizs.push(clusterViz);\n                default:\n                    break;\n            }\n        }\n        // As part of the viz model parsing, we may have combined 2\n        // into one and marked the other to be removed.\n        this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.VISUALIZATIONS_KEY] =\n            visualizations.filter(function (v) {\n                return v !== null;\n            });\n        // Allow cluster visualizations to resolve the referenced vizs.\n        let vizMap = this._visualizationsMap;\n        clusterVizs.forEach(function (clusterViz) {\n            clusterViz.resolveMembers(vizMap);\n        });\n    }\n    /**\n     *\n     * @param {Object} vizJson\n     */\n    addVisualization(vizJson) {\n        this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.VISUALIZATIONS_KEY].push(vizJson);\n    }\n    removeVisualization(vizModel) {\n        let vizIdToRemove = vizModel.getId();\n        this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.VISUALIZATIONS_KEY] =\n            this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.VISUALIZATIONS_KEY].filter(function (viz) {\n                return viz.header.id !== vizIdToRemove;\n            });\n        delete this._visualizationsMap[vizIdToRemove];\n        _.remove(this._visualizationsArray, function (vM) {\n            return vM.getId() === vizIdToRemove;\n        });\n    }\n    hasFilter() {\n        return this._sheetJson[jsonConstants.SHEETCONTENT_KEY] &&\n            this._sheetJson[jsonConstants.SHEETCONTENT_KEY].filter &&\n            this._sheetJson[jsonConstants.SHEETCONTENT_KEY].filter.header;\n    }\n    /**\n     *\n     * @param {Visualization.Column} column\n     * @param {Object=} newFilterGuid\n     * @return {number} Total number of filter rows after this addition. -1 in case of errors.\n     *\n     */\n    addFilter(column, newFilterGuid) {\n        let sheetContent = this._sheetJson[jsonConstants.SHEETCONTENT_KEY];\n        if (!sheetContent) {\n            _logger.error('Can not add filter to empty answer sheet', this._sheetJson);\n            return -1;\n        }\n        if (!sheetContent.filter) {\n            if (newFilterGuid === null) {\n                _logger.error('Can not add a new filter without a valid guid');\n                return -1;\n            }\n            sheetContent.filter = {\n                filterContent: {\n                    type: 'SIMPLE',\n                    rows: []\n                },\n                header: {\n                    id: newFilterGuid,\n                    name: 'User added filter',\n                    owner: this.getId()\n                }\n            };\n        }\n        if (!sheetContent.filter.filterContent || !sheetContent.filter.filterContent.rows) {\n            _logger.error('Invalid filter spec in the answer sheet', this._sheetJson);\n            return -1;\n        }\n        let oper = 'IN';\n        if (column.isMeasure() || column.isDateColumn()) {\n            oper = 'GE';\n        }\n        sheetContent.filter.filterContent.rows.push({\n            column: column.getJson(),\n            oper: oper\n        });\n        return sheetContent.filter.filterContent.rows.length;\n    }\n    /**\n     *\n     * @param {number} filterRow\n     * @return {Object} removed filter definition\n     *\n     */\n    removeFilter(filterRow) {\n        let sheetContent = this._sheetJson[jsonConstants.SHEETCONTENT_KEY];\n        if (!sheetContent || !sheetContent.filter || !sheetContent.filter.filterContent ||\n            !sheetContent.filter.filterContent.rows ||\n            sheetContent.filter.filterContent.rows.length <= filterRow) {\n            _logger.error('Answer sheet is empty or does not contain the specified filter row', this._sheetJson, filterRow);\n            return null;\n        }\n        let removedFilter = sheetContent.filter.filterContent.rows.splice(filterRow, 1);\n        if (sheetContent.filter.filterContent.rows.length <= 0) {\n            delete sheetContent.filter;\n        }\n        this._visualizationsArray.forEach(function (viz) {\n            if (viz.getVizType() !== 'FILTER' || viz.getJson().rowIndex === filterRow) {\n                return;\n            }\n            viz.updateRowIndexAfterRemoving(filterRow);\n        });\n        return removedFilter;\n    }\n    /**\n     * @return {Object} An object containing the visualizations for the answer sheet\n     * TODO(mahesh) Rename getVisualizations() to getVisualizationsMap() in next commit\n     * for clarity and consistency also just use getVisualizationsArray() at places\n     * where we are just using the first element using vizMap[Obejct.keys[0]].\n     */\n    getVisualizations() {\n        return this._visualizationsMap;\n    }\n    getVisualizationsArray() {\n        return this._visualizationsArray;\n    }\n    /**\n     * @param {string} type - if null or empty, then return all visualizations\n     * @returns {Array} An array containing the visualizations for\n     * the given type for the answer sheet\n     */\n    getVisualizationsArrayOfType(type) {\n        return this._visualizationsArray.filter(function (viz) {\n            return viz.getVizType() === type;\n        });\n    }\n    /**\n     * @param {string} type - if null or empty, then return all visualizations\n     * @returns {Array} An array containing the pinboard visualizations\n     * for the given type for the answer sheet\n     */\n    getPinboardVisualizationsArrayOfType(type) {\n        return this._visualizationsArray.filter(function (viz) {\n            return viz.getReferencedVisualization().getVizType() === type;\n        });\n    }\n    /**\n     * @param {string} type - if null or empty, then return all visualizations\n     * @returns {Object} An object containing the visualizations for the\n     * given type for the answer sheet\n     * TODO (mahesh) rename this function to getVisualizationsMapOfType in next commit for clarity.\n     */\n    getVisualizationsOfType(type) {\n        let vizsOfType = this.getVisualizationsArrayOfType(type);\n        let map = vizsOfType.reduce(function (map, viz) {\n            map[viz.getId()] = viz;\n            return map;\n        }, {});\n        return map;\n    }\n    /**\n     * @returns {Array.<TableModel>}\n     * TODO (mahesh) rename this to getTableVisualizationsArray() in next commit.\n     */\n    getTableVisualizations() {\n        return this.getVisualizationsArrayOfType(jsonConstants.vizType.TABLE);\n    }\n    /**\n     * @returns {Array.<VizRdataModel>}\n     */\n    getRAnalysisVisualizations() {\n        return this.getVisualizationsArrayOfType(jsonConstants.vizType.R_ANALYSIS);\n    }\n    /**\n     * @returns {Array.<FilterModel>}\n     * TODO (mahesh) rename this to getFilterVisualizationsArray() in next commit.\n     */\n    getFilterVisualizations() {\n        return this.getVisualizationsArrayOfType(jsonConstants.vizType.FILTER);\n    }\n    /**\n     * @returns {Array.<ChartModel>}\n     * TODO (mahesh) rename this to getChartVisualizationsArray() in next commit.\n     */\n    getChartVisualizations() {\n        return this.getVisualizationsArrayOfType(jsonConstants.vizType.CHART);\n    }\n    getHeadlineVisualizations() {\n        return this.getVisualizationsArrayOfType(jsonConstants.vizType.HEADLINE);\n    }\n    getReferencedVisualizationsArrayOfType(type) {\n        return this._visualizationsArray.filter(function (viz) {\n            let vizType = viz.getVizType();\n            if (vizType === jsonConstants.vizType.PINBOARD_VIZ) {\n                vizType = viz.getReferencedVisualization().getVizType();\n            }\n            return vizType === type;\n        });\n    }\n    getReferencedTableVisualizationsArray() {\n        return this.getReferencedVisualizationsArrayOfType(jsonConstants.vizType.TABLE);\n    }\n    getReferencedFilterVisualizationsArray() {\n        return this.getReferencedVisualizationsArrayOfType(jsonConstants.vizType.FILTER);\n    }\n    /**\n     * Returns whether the answer sheet is empty\n     *\n     * @return {boolean}  True if the answer sheet contains no visualizations\n     */\n    isEmpty() {\n        return this._visualizationsArray.length === 0;\n    }\n    /**\n     * @return {Array} An array of objects containing for each viz its id, and optionnaly\n     * position and size information\n     */\n    getLayoutTiles(flattenClusters, applyInsightsStyle, defaultTileSize) {\n        if (this._sheetJson.sheetContent && !this._sheetJson.sheetContent.layout) {\n            this._sheetJson.sheetContent.layout = {};\n        }\n        if (!this._sheetJson.sheetContent.layout.tiles) {\n            this._sheetJson.sheetContent.layout.tiles = [];\n        }\n        this._sheetJson.sheetContent.layout.tiles = pinboardAnswerSheetUtil.getPinboardLayout(this._sheetJson.sheetContent.layout.tiles, this._visualizationsMap, this._visualizationsArray, flattenClusters, applyInsightsStyle, defaultTileSize);\n        return _.sortBy(this._sheetJson.sheetContent.layout.tiles, 'order');\n    }\n    getLayoutTemplate() {\n        if (this._sheetJson.sheetContent && this._sheetJson.sheetContent.layout &&\n            this._sheetJson.sheetContent.layout.layoutTemplate) {\n            return this._sheetJson.sheetContent.layout.layoutTemplate;\n        }\n        return '';\n    }\n    setLayoutTemplate(layoutTemplate) {\n        if (!this._sheetJson.sheetContent.layout) {\n            this._sheetJson.sheetContent.layout = {};\n        }\n        this._sheetJson.sheetContent.layout.layoutTemplate = layoutTemplate;\n    }\n    getLayoutMode() {\n        if (this._sheetJson.sheetContent && this._sheetJson.sheetContent.layout &&\n            this._sheetJson.sheetContent.layout.layoutMode) {\n            return this._sheetJson.sheetContent.layout.layoutMode;\n        }\n        return '';\n    }\n    setLayoutMode(layoutMode) {\n        if (!this._sheetJson.sheetContent.layout) {\n            this._sheetJson.sheetContent.layout = {};\n        }\n        this._sheetJson.sheetContent.layout.layoutMode = layoutMode;\n    }\n    /**\n     * @param {string} id The guid of the visualization for which model is requested.\n     * @return {Object} The vizContent+header json for a given guid.\n     */\n    getVisualization(id) {\n        return this._visualizationsMap[id] || null;\n    }\n    getJson() {\n        return this._sheetJson;\n    }\n    /**\n     * Returns the description of this answersheet.\n     * @return {string}\n     */\n    getDescription() {\n        return this._sheetJson[jsonConstants.HEADER_KEY][jsonConstants.DESCRIPTION_KEY];\n    }\n    /**\n     * Sets the name of this answersheet to name.\n     * @param {string} name\n     */\n    setName(name) {\n        this._sheetJson[jsonConstants.HEADER_KEY][jsonConstants.NAME_KEY] = name;\n    }\n    /**\n     * Sets the description of this answersheet to desc.\n     * @param {string} desc\n     */\n    setDescription(desc) {\n        this._sheetJson[jsonConstants.HEADER_KEY][jsonConstants.DESCRIPTION_KEY] = desc;\n    }\n    /**\n     * @returns {sage.ACContext}\n     */\n    getSageContext() {\n        try {\n            let questionInfo = this.getQuestionInfo();\n            if (!questionInfo) {\n                return null;\n            }\n            return questionInfo[jsonConstants.SAGE_CONTEXT_PROTO_KEY];\n        }\n        catch (error) {\n            _logger.warn('error in deserializing context', error);\n            return null;\n        }\n    }\n    /**\n     * @returns {int}\n     */\n    getSageContextIndex() {\n        let questionInfo = this.getQuestionInfo();\n        if (!questionInfo) {\n            return null;\n        }\n        return questionInfo[jsonConstants.SAGE_CONTEXT_INDEX_KEY];\n    }\n    /**\n     * @param {sage.ACContext} context\n     * @param {index} index\n     */\n    setSageContext(context, index) {\n        let questionJson = this._sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.QUESTION_KEY];\n        questionJson[jsonConstants.SAGE_CONTEXT_PROTO_KEY] = sage.serialize(context);\n        questionJson[jsonConstants.SAGE_CONTEXT_INDEX_KEY] = index;\n    }\n    /**\n     * Parses the json string form of list of recognized tokens stored in the answer-sheet\n     * and converts each json object into a first class RecognizedToken.\n     *\n     * @return {Array.<sage.RecognizedToken>}\n     */\n    getRecognizedTokens() {\n        let sageContext = this.getSageContext();\n        let index = this.getSageContextIndex();\n        if (!sageContext) {\n            _logger.error('Undefined sage context');\n            return void 0;\n        }\n        if (index < 0) {\n            // NOTE: The getters should have already addressed backward compatibility.\n            _logger.error('Index cannot be less that 0', index);\n            return void 0;\n        }\n        let table = sageContext.getTables()[index];\n        return table.getTokens();\n    }\n    /**\n     * Returns the mode chart, table that this answer model was saved in.\n     * @return {string}\n     */\n    getVizSelectionAnswerMode() {\n        let clientState = this._sheetJson[jsonConstants.HEADER_KEY][jsonConstants.CLIENT_STATE_KEY];\n        if (!clientState) {\n            return null;\n        }\n        return clientState[jsonConstants.CLIENT_STATE_VIZ_SELECTION_ANSWER_MODE_KEY];\n    }\n    getPrimaryDisplayedViz() {\n        let answerVizType = this.getVizSelectionAnswerMode();\n        let vizModel;\n        if (answerVizType === AnswerDisplayMode.TABLE) {\n            vizModel = this.getTableVisualizations()[0];\n        }\n        else if (answerVizType === AnswerDisplayMode.R_ANALYSIS) {\n            vizModel = this.getRAnalysisVisualizations()[0];\n            if (!vizModel) {\n                // default to table model if there is no existing R analysis viz.\n                vizModel = this.getTableVisualizations()[0];\n            }\n        }\n        else {\n            vizModel = this.getChartVisualizations()[0];\n        }\n        return vizModel;\n    }\n    /**\n     * Sets the mode chart, table that this answer model is in.\n     * @param {string} mode\n     */\n    setVizSelectionAnswerMode(mode) {\n        let clientState = this._sheetJson[jsonConstants.HEADER_KEY][jsonConstants.CLIENT_STATE_KEY];\n        if (!clientState) {\n            // client state may not exist; create new\n            clientState = {};\n            this._sheetJson[jsonConstants.HEADER_KEY][jsonConstants.CLIENT_STATE_KEY] = clientState;\n        }\n        clientState[jsonConstants.CLIENT_STATE_VIZ_SELECTION_ANSWER_MODE_KEY] = mode;\n    }\n    /**\n     * Returns if leaf data is allowed on the answer.\n     * @returns {boolean}\n     */\n    canGenerateLeafData() {\n        return !!this._sheetJson.sheetContent.canGenerateLeafData;\n    }\n    /**\n     *\n     * @param {VisualizationColumnModel} column\n     * @return {FilterModel|null}\n     */\n    getFilterModelByColumn(column) {\n        return this._colEffectiveIdToFilterModels[column.getId()] || null;\n    }\n    hasFilterForColumn(column) {\n        return !!this._colEffectiveIdToFilterModels[column.getId()];\n    }\n    getTableColumns() {\n        let tableModels = this.getTableVisualizations();\n        if (tableModels.length !== 1) {\n            _logger\n                .error('answer sheet model should be having one and onle one table visualization');\n        }\n        let tableModel = tableModels[0];\n        return tableModel.getVizColumns();\n    }\n    getFilterAnswerIds() {\n        let content = this._sheetJson && this._sheetJson[jsonConstants.SHEETCONTENT_KEY];\n        let ids = util.prop(content, 'pinboardFilterDetails.pinboardFiltersAnswerIds');\n        return ids || [];\n    }\n    getFilterDataSources() {\n        let content = this._sheetJson && this._sheetJson[jsonConstants.SHEETCONTENT_KEY];\n        let ids = util.prop(content, 'pinboardFilterDetails.filterLogicalTableIds');\n        return ids || [];\n    }\n    getVizIdToRemoveInObjectResolver(vizModel) {\n        let vizIdToRemove = vizModel.getId();\n        let refVizIdToDelete = this._visualizationsMap[vizIdToRemove][jsonConstants.REF_VIZ_ID_KEY];\n        return refVizIdToDelete;\n    }\n    removeVizInObjectResolver(vizId) {\n        delete this._objectResolver[vizId];\n    }\n    replaceVizInObjectResolver(oldVizId, newVizId, newModel) {\n        delete this._objectResolver[oldVizId];\n        this._objectResolver[newVizId] = newModel;\n        this._parseVisualizations();\n    }\n    containsVisualization(vizId) {\n        return this._visualizationsMap[vizId] !== void 0;\n    }\n    getA3Request() {\n        let serializedA3Requst = _.get(this._sheetJson, [\n            jsonConstants.SHEETCONTENT_KEY,\n            jsonConstants.PINBOARD_A3_DETAILS_KEY,\n            jsonConstants.A3_REQUEST_PROTO_KEY\n        ]);\n        return !!serializedA3Requst\n            ? sage.deserialize(serializedA3Requst, sageTypes.A3Request)\n            : null;\n    }\n    getA3AnalysisFacts() {\n        let serializedAnalysisFacts = _.get(this._sheetJson, [\n            jsonConstants.SHEETCONTENT_KEY,\n            jsonConstants.PINBOARD_A3_DETAILS_KEY,\n            jsonConstants.A3_ANALYSIS_FACTS_PROTO_KEY\n        ]);\n        return !!serializedAnalysisFacts\n            ? sage.deserialize(serializedAnalysisFacts, sageTypes.AnalysisFacts)\n            : null;\n    }\n    stabilizeReferencableVizIds(sheetJson, sheetData) {\n        return;\n        if (!sheetJson || !sheetJson.header || !sheetJson.header.id) {\n            _logger\n                .info('No viz id stabilization can be performed without answer sheet clientState');\n            return;\n        }\n        let trackedVizIds = appClientStateService\n            .getClientState(sheetJson.header.id).trackedVizIds;\n        if (!trackedVizIds || _.keys(trackedVizIds).length <= 0) {\n            return;\n        }\n        let stableIds = util.mapArrayToBooleanHash(Object.values(trackedVizIds));\n        // Walk through the json and look for the vizs that are candidates for stabilization fix.\n        let vizsToFix = [];\n        let visualizations = sheetJson[jsonConstants.SHEETCONTENT_KEY][jsonConstants.VISUALIZATIONS_KEY];\n        if (!visualizations) {\n            return;\n        }\n        if (!sheetData || !sheetData[jsonConstants.VIZ_DATA_KEY]) {\n            return;\n        }\n        for (let i = 0; i < visualizations.length; ++i) {\n            let vizJson = visualizations[i];\n            // If we already found a viz id that matches, do nothing and return.\n            if (stableIds.hasOwnProperty(vizJson.header.id)) {\n                continue;\n            }\n            else if (trackedVizIds.hasOwnProperty(vizJson.vizContent.vizType)) {\n                vizsToFix.push(vizJson);\n            }\n        }\n        if (!vizsToFix.length) {\n            _logger.info('Found no candidate vizs to fix up.');\n            return;\n        }\n        let vizDataContainer = sheetData[jsonConstants.VIZ_DATA_KEY];\n        vizsToFix.forEach(function (vizToFix) {\n            let candidateId = vizToFix.header.id;\n            if (!vizDataContainer.hasOwnProperty(candidateId)) {\n                _logger.debug('Found no data node for viz %s in sheet data %o', candidateId, vizDataContainer);\n                return;\n            }\n            vizToFix.header.id = trackedVizIds[vizToFix.vizContent.vizType];\n            vizDataContainer[vizToFix.header.id] = vizDataContainer[candidateId];\n            delete vizDataContainer[candidateId];\n        });\n    }\n    getSheetGuid(sheetJson) {\n        let sheetHeader = sheetJson[jsonConstants.HEADER_KEY];\n        if (!sheetHeader || !sheetHeader[jsonConstants.ID_KEY]) {\n            throw new Error('Can not find guid for the answersheet');\n        }\n        return sheetHeader[jsonConstants.ID_KEY];\n    }\n}\n//# sourceMappingURL=answer-sheet-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2013\n * Author: Joy Dutta (joy@thoughtspot.com),\n * Stephane Kiss (stephane@thoughtspot.com),\n * Vibhor Nanavati (vibhor@thoughtspot.com)\n * Francois Chabbey (francois.chabbey@thoughtspot.com)\n *\n * @fileoverview Data model for answers\n */\nimport * as tslib_1 from \"tslib\";\nvar AnswerModel_1;\n'use strict';\nimport * as Logger from '@thoughtspot/logger';\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport _ from 'lodash';\nimport { Provide } from '../../../base/decorators';\nimport { embraceConstants } from '../../embrace/constants';\nimport { tokensToQuery } from '../../sage-v2/sage-util/sage-util';\nimport { CLIENT_STATE_KEYS } from '../../viz-layout/viz/chart/client-state';\nimport { DocumentModel } from '../document-model';\nimport { AnswerSheetModel } from './answer-sheet-model';\n/**\n * AnswerModel encapsulates the detail of an answer data returned by Callosum. An answer is usually\n * composed of one or more answer sheet(s) (AnswerSheetModel) which itself is composed of\n * one or more visualizations and their layout information.\n */\nlet AnswerModel = AnswerModel_1 = class AnswerModel extends DocumentModel {\n    constructor(_answerJson) {\n        super(_answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.HEADER_KEY]);\n        this._answerJson = _answerJson;\n        this._metadataType = jsonConstants.metadataType.QUESTION_ANSWER_BOOK;\n        /**\n         * A list of containing answer sheets in this answer book.\n         * @type {Array.<AnswerSheetModel>}\n         */\n        this._answerSheets = [];\n        // Flag that is set to true when callosum returns a NO_DATA error (i.e. when answer is empty)\n        this._hasNoData = false;\n        this._accessibleTables = null;\n        this._hasUserDefinedName = false;\n        this._hasUserDefinedDescription = false;\n        this._isAggregatedWorksheet = false;\n        // SCAL-11624: blink needs to ignore incomplete details if the complete flag is set to true\n        let isComplete = !!_answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.COMPLETE];\n        if (!isComplete) {\n            this._isCorrupted = true;\n            let incompletionDetails = _answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.INCOMPLETE_DETAIL];\n            if (!!incompletionDetails && !!incompletionDetails.length) {\n                this._incompletionDetails = incompletionDetails;\n            }\n        }\n        this._logger.time(Logger.ProfileMessages.ANSWER_MODEL_PARSING);\n        this.parseAnswerSheets();\n        this._logger.timeEnd(Logger.ProfileMessages.ANSWER_MODEL_PARSING);\n        if (!!this.getCurrentAnswerSheet()) {\n            let type = this.getCurrentAnswerSheet().getSheetType() + '_ANSWER_BOOK';\n            //this._docPermission = DocumentPermissionFactory.createPermissiveInstance(type);\n        }\n    }\n    /**\n     * Returns the raw json\n     * @return {Object}     The AnswerBook json\n     */\n    getJson() {\n        return this._answerJson;\n    }\n    /**\n     * Returns the AnswerBook metadata\n     * @return {Object}     The metadata object\n     */\n    getMetadata() {\n        return this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY];\n    }\n    /**\n     * Will return true if callosum has returned a JSON that doesn't have a data property\n     * @return {boolean}     Whether the answer is empty\n     */\n    hasNoData() {\n        return this._hasNoData;\n    }\n    /**\n     * Returns the json corresponding to the report book meta data.\n     * @return {Object}\n     */\n    getReportBookJson() {\n        return this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY] || null;\n    }\n    /**\n     * This clears the unwanted state is answer model before sent to callosum to get answers.\n     */\n    cleanStateForAnswerQuery() {\n        let answerSheet = this.getCurrentAnswerSheet();\n        if (!answerSheet) {\n            return;\n        }\n        answerSheet.setVizSelectionAnswerMode(null);\n        answerSheet.getChartVisualizations().forEach((chartModel) => {\n            chartModel.clearSystemDecidedColors();\n        });\n    }\n    /**\n     * Returns an object containing the metadata and data for a visualization\n     * @param {string} id\n     * @param {number=} sheetIndex\n     * @return {Object}\n     */\n    getVizById(id, sheetIndex) {\n        sheetIndex = sheetIndex || 0;\n        return this.getAnswerSheet(sheetIndex).getVisualization(id);\n    }\n    getChartVisualization() {\n        let answerSheet = this.getCurrentAnswerSheet();\n        let chartVizs = answerSheet.getChartVisualizations();\n        return chartVizs[0];\n    }\n    /**\n     * @param {number} sheetIndex Index in a list of answer sheet in an answer book.\n     * @return {AnswerSheetModel} The answer sheet corresponding to sheetIndex\n     */\n    getAnswerSheet(sheetIndex) {\n        if (sheetIndex >= this._answerSheets.length || sheetIndex < 0) {\n            return null;\n        }\n        return this._answerSheets[sheetIndex];\n    }\n    /**\n     * @return {AnswerSheetModel} The answer sheet that is being shown.\n     */\n    getCurrentAnswerSheet() {\n        // Note that we currently only have one sheet per answer, so the first\n        // sheet is the current sheet. This may change in future.\n        return this.getAnswerSheet(0);\n    }\n    /**\n     * Returns the name of this answerbook.\n     * @return {string}\n     * @override\n     */\n    getName() {\n        return this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.HEADER_KEY][jsonConstants.NAME_KEY];\n    }\n    /**\n     * Returns the description of this answerbook.\n     * @return {string}\n     * @override\n     */\n    getDescription(stripHTMLTags = true) {\n        let description = this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.HEADER_KEY][jsonConstants.DESCRIPTION_KEY];\n        if (stripHTMLTags && description) {\n            description = description.stripTags();\n        }\n        return description;\n    }\n    /**\n     * Sets the name of this answerbook (and current answer sheet's name) to name.\n     * @param {string} name\n     * @override\n     */\n    setName(name) {\n        this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.HEADER_KEY][jsonConstants.NAME_KEY] = name;\n        let answerSheet = this.getCurrentAnswerSheet();\n        // TODO(vibhor/shikhar): Clean up the sheet name/description if not needed.\n        answerSheet.setName(name);\n        if (answerSheet.getSheetType() !== 'QUESTION') {\n            return;\n        }\n        let vizs = _.assign({}, answerSheet.getVisualizationsOfType('TABLE'), answerSheet.getVisualizationsOfType('CHART'));\n        _.values(vizs).forEach((viz) => {\n            viz.setAutoTitle(name);\n        });\n    }\n    hasUserDefinedName() {\n        return this._hasUserDefinedName;\n    }\n    setHasUserDefinedName(hasUserDefinedName) {\n        this._hasUserDefinedName = hasUserDefinedName;\n    }\n    /**\n     * Sets the description of this answerbook (and current answer sheet's description) to desc.\n     * @param {string} desc\n     * @override\n     */\n    setDescription(desc) {\n        this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.HEADER_KEY][jsonConstants.DESCRIPTION_KEY] = desc;\n        this.getCurrentAnswerSheet().setDescription(desc);\n    }\n    hasUserDefinedDescription() {\n        return this._hasUserDefinedDescription;\n    }\n    setHasUserDefinedDescription(hasUserDefinedDescription) {\n        this._hasUserDefinedDescription = hasUserDefinedDescription;\n    }\n    /**\n     * Gets the question object from the json of the current answer sheet\n     * @return {Object}\n     * @override\n     */\n    getQuestionInfo() {\n        return this.getCurrentAnswerSheet().getQuestionInfo();\n    }\n    isChasmTrapQuery() {\n        let questionModel = this.getQuestionInfo();\n        return questionModel.getIsChasmTrapQuery();\n    }\n    /**\n     * Gets the sage question text\n     *\n     * @return {string}\n     */\n    getQuestionText() {\n        return this.getQuestionInfo().getText();\n    }\n    /**\n     * See AnswerSheetModel.getRecognizedTokens.\n     * @return {Array.<sage.RecognizedToken>}\n     * @override\n     */\n    getRecognizedTokens() {\n        return this.getCurrentAnswerSheet().getRecognizedTokens();\n    }\n    getQueryTextFromTokens() {\n        let tokens = this.getRecognizedTokens();\n        return tokensToQuery(tokens);\n    }\n    shouldSetScopeBasedOnTokens() {\n        // In case of a single auto disambiguated token,\n        // We do not set the scope because we want suggestions\n        // from the universe.\n        return this.hasOnlySingleAutoDisambiguatedToken();\n    }\n    /**\n     * Return the natural query object for the answer\n     *\n     * @return {Object}  The natural query object\n     */\n    getNaturalQuery() {\n        if (!this._answerJson.naturalQuery || !Object.keys(this._answerJson.naturalQuery).length) {\n            return null;\n        }\n        let naturalQueryKeys = Object.keys(this._answerJson.naturalQuery);\n        return this._answerJson.naturalQuery[naturalQueryKeys[0]];\n    }\n    /**\n     *\n     * @return {number}\n     */\n    getCompletionRatio() {\n        return this._answerJson.completionRatio;\n    }\n    /**\n     *\n     * @param {number} completionRatio\n     */\n    setCompletionRatio(completionRatio) {\n        this._answerJson.completionRatio = completionRatio;\n    }\n    /**\n     *\n     * @return {string}\n     * @override\n     */\n    getMetadataType() {\n        return this._metadataType;\n    }\n    /**\n     *\n     * @return {string}\n     * @override\n     */\n    getMetadataSubType() {\n        if (this.isAggregatedWorksheet()) {\n            return jsonConstants.metadataType.subType.VIEW;\n        }\n        return void 0;\n    }\n    /**\n     *\n     * @return {Object}\n     * @override\n     */\n    getMetadataJson() {\n        return this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY];\n    }\n    /**\n     * Returns if leaf data is allowed on the answer.\n     * @returns {boolean}\n     */\n    canGenerateLeafData() {\n        return this.getCurrentAnswerSheet().canGenerateLeafData();\n    }\n    /**\n     *\n     * @param {Object} json\n     * @override\n     */\n    fromMetadataJson(json) {\n        let answerJson = _.cloneDeep(this._answerJson);\n        answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY] = json;\n        let answerModel = new AnswerModel_1(answerJson);\n        answerModel.inheritNonJsonProperties(this);\n        return answerModel;\n    }\n    /**\n     * @returns {sage.ACContext}\n     */\n    getSageContext() {\n        let currentAnswerSheet = this.getCurrentAnswerSheet();\n        if (!currentAnswerSheet) {\n            return null;\n        }\n        return currentAnswerSheet.getSageContext();\n    }\n    /**\n     * @returns {int}\n     */\n    getSageContextIndex() {\n        return this.getCurrentAnswerSheet().getSageContextIndex();\n    }\n    getNLQuery() {\n        let context = this.getSageContext();\n        return context.getNLQuery(this.getSageContextIndex());\n    }\n    isSearchIQAnswer() {\n        let context = this.getSageContext();\n        return context.isNLSourced();\n    }\n    getNLQueryMappings() {\n        let context = this.getSageContext();\n        return context.getNLQueryMapping();\n    }\n    /**\n     *\n     * @returns {string}\n     */\n    getCurrentQueryHashKey() {\n        let context = this.getSageContext();\n        if (!context) {\n            return null;\n        }\n        let index = this.getSageContextIndex() || 0;\n        // NOTE: Callosum migrates legacy queries to wrap in a dummy context\n        // where the index is set to -1\n        index = index > -1 ? index : 0;\n        let currentTable = context.getTables()[index];\n        return currentTable.getHashKey();\n    }\n    /**\n     * @param {sage.ACContext} context\n     * @param {int} index\n     */\n    setSageContext(context, index) {\n        this.getCurrentAnswerSheet().setSageContext(context, index);\n    }\n    containsChangesFromStateStoredOnServer(referenceMetadataJson) {\n        let hasVisualizationsWithUserMadeChanges = false;\n        this._answerSheets.forEach((answerSheet) => {\n            let chartVizs = answerSheet.getVisualizationsArrayOfType(jsonConstants.vizType.CHART);\n            let userModifiedChartViz = chartVizs.some((chartModel) => {\n                return chartModel.hasUserMadeConfigChanges();\n            });\n            if (userModifiedChartViz) {\n                hasVisualizationsWithUserMadeChanges = true;\n            }\n        });\n        return hasVisualizationsWithUserMadeChanges\n            || this.hasBeenModified(referenceMetadataJson)\n            || this.hasVizSelectionChanged(referenceMetadataJson, this.getMetadataJson());\n    }\n    hasVizSelectionChanged(model1, model2) {\n        let content1 = !!model1 ? model1.reportContent : null;\n        let sheets1 = !!content1 ? content1.sheets : null;\n        let content2 = !!model2 ? model2.reportContent : null;\n        let sheets2 = !!content2 ? content2.sheets : null;\n        let didVizSelectionChanged = false;\n        sheets1.forEach((sheet, index) => {\n            if (!sheets2[index]) {\n                didVizSelectionChanged = true;\n                return false;\n            }\n            let clientState1 = sheet.header.clientState;\n            let clientState2 = sheets2[index].header.clientState;\n            let vizSelection1 = !!clientState1 ?\n                clientState1[jsonConstants.CLIENT_STATE_VIZ_SELECTION_ANSWER_MODE_KEY] : null;\n            let vizSelection2 = !!clientState2 ?\n                clientState2[jsonConstants.CLIENT_STATE_VIZ_SELECTION_ANSWER_MODE_KEY] : null;\n            // In older version of json we didn't have a node for viz-selection.\n            // When processed by a new version of our code we automatically add such a\n            // node. If this is the only change, since it's automatic, we don't want\n            // to prompt the user for saving this change.\n            // SCAL-12388, SCAL-11306, SCAL-12607\n            let hasVizSelectionBeenIntroduced = (!vizSelection1) && vizSelection2 !== null;\n            if (!hasVizSelectionBeenIntroduced && vizSelection1 !== vizSelection2) {\n                didVizSelectionChanged = true;\n                return false;\n            }\n        });\n        return didVizSelectionChanged;\n    }\n    metadataEquals(model1, model2) {\n        // it's 5-10x faster to use native JSON.stringify to compare two models\n        // than to copy them using angular.copy and then compare. since in most\n        // cases the comparison will result in an early termination it saves\n        // CPU to do this check early.\n        if (JSON.stringify(model1) === JSON.stringify(model2)) {\n            return true;\n        }\n        model1 = _.cloneDeep(model1);\n        model2 = _.cloneDeep(model2);\n        //remove the transient state in the json that does not affect comparison of JSONs\n        [model1, model2].forEach((model) => {\n            delete model.debugInfo;\n            if (model.reportContent && model.reportContent.sheets) {\n                model.reportContent.sheets.forEach((sheet) => {\n                    let clientState = sheet.header.clientState;\n                    // CHART answer mode is set as a default. in case of older answers this\n                    // field is not set causing spurious warnings about change. Deleting\n                    // only the default value ensures that if the value is set to anything\n                    // other than the default value\n                    // changes are still detected (non-default-valid-value != undefined)\n                    if (!!clientState) {\n                        delete clientState[jsonConstants.CLIENT_STATE_VIZ_SELECTION_ANSWER_MODE_KEY];\n                        if (_.size(clientState) === 0) {\n                            delete sheet.header.clientState;\n                        }\n                    }\n                    if (sheet.sheetContent.layout) {\n                        //tiles info is ignored in auto layout mode\n                        if (sheet.sheetContent.layout.layoutMode === void 0\n                            || sheet.sheetContent.layout.layoutMode === 'auto') {\n                            delete sheet.sheetContent.layout;\n                        }\n                        else if (sheet.sheetContent.layout.tiles) {\n                            //even in custom layout, a newly added viz can be auto positioned\n                            //we don't want to worry about such tiles' positions\n                            sheet.sheetContent.layout.tiles = [];\n                        }\n                    }\n                    if (sheet.sheetContent.visualizations) {\n                        //for chart viz, there is a default value for visibleSeriesNames\n                        // in clientState that is automatically set and\n                        // should be ignored while looking for user's changes\n                        sheet.sheetContent.visualizations.forEach((viz) => {\n                            delete viz.vizContent.title;\n                            let vizType = viz.vizContent.vizType;\n                            if (vizType === 'FILTER') {\n                                delete viz.vizContent.dataOnDemand;\n                            }\n                            if (viz.header) {\n                                delete viz.header.name;\n                                delete viz.header.description;\n                                this.trimModelClientStateForDiff(viz.header, false);\n                            }\n                        });\n                    }\n                });\n            }\n            //an old save viz once loaded will have an empty client state in tables\n            // because of a recent change\n            if (model.header && model.header.resolvedObjects) {\n                Object.keys(model.header.resolvedObjects).forEach((refVizId) => {\n                    let refViz = model.header.resolvedObjects[refVizId];\n                    if (refViz && refViz.header && refViz.header.clientState) {\n                        this.trimModelClientStateForDiff(refViz.header, true);\n                    }\n                });\n            }\n            if (model.header.resolvedObjects) {\n                Object.keys(model.header.resolvedObjects).forEach((vizId) => {\n                    delete model.header.resolvedObjects[vizId].vizContent.locked;\n                });\n            }\n        });\n        //Note(chab) we do not use _.eq, as it rely on === comparison\n        return _.isEqualWith(model1, model2, (val1, val2) => {\n            if ((_.isNil(val1) && !_.isNil(val2)) || (!_.isNil(val1) && _.isNil(val2))) {\n                return false;\n            }\n            if (_.isNil(val1) && _.isNil(val2)) {\n                return true;\n            }\n            if (Object.keys(val1).length !== Object.keys(val2).length) {\n                if ((_.isArray(val1)) || (_.isArray(val2))) {\n                    return false;\n                }\n                else {\n                    return (_.isMatch(val1, val2) || _.isMatch(val2, val1));\n                }\n            }\n            else {\n                return void 0;\n            }\n        });\n    }\n    setUserData(key, value) {\n        let clientState = this.getClientState();\n        clientState[key] = value;\n    }\n    getUserData(key) {\n        let clientState = this.getClientState();\n        if (clientState) {\n            return clientState[key];\n        }\n    }\n    clearUserData(key) {\n        let clientState = this.getClientState();\n        if (clientState) {\n            delete clientState[key];\n        }\n    }\n    hasUserData(key) {\n        let clientState = this.getClientState();\n        return clientState && _.has(clientState, key);\n    }\n    clone() {\n        return new AnswerModel_1(JSON.parse(JSON.stringify(this._answerJson)));\n    }\n    setIsAggregatedWorksheet(isAggregatedWorksheet) {\n        this._isAggregatedWorksheet = !!isAggregatedWorksheet;\n    }\n    isAggregatedWorksheet() {\n        return this._isAggregatedWorksheet;\n    }\n    getTableColumns() {\n        return this.getCurrentAnswerSheet().getTableColumns();\n    }\n    setAccessibleTables(accessibleTables) {\n        this._accessibleTables = accessibleTables;\n    }\n    getAccessibleTables() {\n        return this._accessibleTables;\n    }\n    shouldAlwaysShowAxisLabels() {\n        return false;\n    }\n    getDefaultQuerableSource() {\n        const queryState = this.getUserData('queryState');\n        if (queryState) {\n            return queryState;\n        }\n        const answerSheet = this.getCurrentAnswerSheet();\n        if (!answerSheet) {\n            return null;\n        }\n        return answerSheet['_sheetJson'][jsonConstants.SHEETCONTENT_KEY].defaultQueryableSource;\n    }\n    getQuerableSources() {\n        const answerSheet = this.getCurrentAnswerSheet();\n        if (!answerSheet) {\n            return null;\n        }\n        return answerSheet['_sheetJson'][jsonConstants.SHEETCONTENT_KEY].querableSources;\n    }\n    /**\n     * Checks if the source is external, i.e. if source was either cached in Falcon\n     * from external sources or is fetched from external sources. Snowflake, Redshift, etc\n     * are external sources.\n     *\n     * @returns {boolean}\n     */\n    isExternalSource() {\n        const querableSources = this.getQuerableSources();\n        const defaultQuerableSources = this.getDefaultQuerableSource();\n        if (querableSources.length > 1) {\n            return true;\n        }\n        return querableSources[0] === embraceConstants.QUERYABLE_SOURCES.LIVE;\n    }\n    /**\n     * TODO(define what is client state)\n     *\n     * @returns {any}\n     */\n    getClientState() {\n        if (!this.getJson()) {\n            return null;\n        }\n        let clientState = this.getHeaderJson().clientState;\n        if (!clientState) {\n            clientState = this.getHeaderJson().clientState = {};\n        }\n        return clientState;\n    }\n    /**\n     * @param {Object} sheetJson\n     * @private\n     */\n    getSheetData(sheetJson) {\n        if (!sheetJson || !sheetJson[jsonConstants.HEADER_KEY]) {\n            return null;\n        }\n        let sheetName = sheetJson[jsonConstants.HEADER_KEY][jsonConstants.ID_KEY] || null;\n        if (!sheetName) {\n            return null;\n        }\n        if (!this._answerJson[jsonConstants.REPORT_BOOK_DATA_KEY]) {\n            return null;\n        }\n        let pageData = this._answerJson[jsonConstants.REPORT_BOOK_DATA_KEY][sheetName];\n        return pageData || null;\n    }\n    /**\n     * Parses the answer json sent by callosum and creates a model for each containing\n     * answer sheets.\n     */\n    parseAnswerSheets() {\n        if (!this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY] ||\n            !this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.REPORT_BOOK_CONTENT_KEY] ||\n            !this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.REPORT_BOOK_CONTENT_KEY][jsonConstants.SHEETS_KEY]) {\n            throw new Error('No answer sheet json specified.');\n        }\n        // If the json doesn't have a data property, set the _hasNoData flag to true\n        if (!this._answerJson[jsonConstants.REPORT_BOOK_DATA_KEY]) {\n            this._hasNoData = true;\n        }\n        let sheets = this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.REPORT_BOOK_CONTENT_KEY][jsonConstants.SHEETS_KEY];\n        sheets.forEach(sheet => this._answerSheets.push(new AnswerSheetModel({\n            sheetJson: sheet,\n            sheetData: this.getSheetData(sheet),\n            objectResolver: this.getObjectResolver(),\n            answerModel: this\n        })));\n    }\n    getObjectResolver() {\n        if (!this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY] ||\n            !this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.HEADER_KEY]) {\n            return null;\n        }\n        return this._answerJson[jsonConstants.REPORT_BOOK_METADATA_KEY][jsonConstants.HEADER_KEY][jsonConstants.REPORT_BOOK_RESOLVED_OBJECTS_KEY] || null;\n    }\n    trimModelClientStateForDiff(header, isPinboardRefViz) {\n        if (!_.isPlainObject(header.clientState)) {\n            return;\n        }\n        // we allow the user to play with the chart by changing\n        // the legend selection and zooming in/out but since\n        // the changes can't (currently) be directly persisted\n        // via pinboards we ignore such changes when comparing\n        if (isPinboardRefViz) {\n            delete header.clientState.visibleSeriesNames;\n            delete header.clientState.axisExtremes;\n            delete header.clientState.multiColorSeriesColors;\n            delete header.clientState.systemMultiColorSeriesColors;\n            delete header.clientState.seriesColors;\n            delete header.clientState.systemSeriesColors;\n            delete header.clientState.mapViewport;\n        }\n        //we ignore any dataOffset changes. i.e navigating a chart's pages in pinboard is ignored\n        delete header.clientState.dataOffset;\n        if (header.clientState.axisExtremes) {\n            Object.keys(header.clientState.axisExtremes).forEach((axisType) => {\n                //userMin, userMax, dataMin, dataMax can be dynamically updated by highcharts\n                //we have stopped saving these props (SCAL-4711) but we need to keep this logic\n                //here for saved answers/pinboards from before the change\n                header.clientState.axisExtremes[axisType].forEach(function (axisExtremes) {\n                    delete axisExtremes.userMin;\n                    delete axisExtremes.userMax;\n                    delete axisExtremes.dataMin;\n                    delete axisExtremes.dataMax;\n                });\n            });\n        }\n        // Since ordered column ids field can change due to changes in effective id computation,\n        // we do not want to diff on it unless the user has explicitly changed the order.\n        // Note that one side effect of change in effective id is that we can also not preserve\n        // a previously saved column order but our current product philosophy is to\n        // ignore such rare events.\n        /* eslint camelcase: 1 */\n        if (header.clientState.ordered_column_ids) {\n            delete header.clientState.ordered_column_ids;\n        }\n        if (header.clientState.systemSeriesColors) {\n            delete header.clientState.systemSeriesColors;\n        }\n        if (header.clientState.systemMultiColorSeriesColors) {\n            delete header.clientState.systemMultiColorSeriesColors;\n        }\n        delete header.clientState[CLIENT_STATE_KEYS.columnProperties];\n        delete header.clientState[CLIENT_STATE_KEYS.chartProperties];\n        delete header.clientState[CLIENT_STATE_KEYS.axisProperties];\n        if (header.clientState.widgetState) {\n            delete header.clientState.widgetState.pageIndex;\n        }\n        if (_.size(header.clientState) === 0) {\n            //an old save viz once loaded will have an empty client state in tables\n            // because of a recent change\n            delete header.clientState;\n        }\n    }\n    hasOnlySingleAutoDisambiguatedToken() {\n        let recognizdTokens = this.getRecognizedTokens();\n        return recognizdTokens.length === 1\n            && recognizdTokens[0].isAutoDisambiguated;\n    }\n};\nAnswerModel = AnswerModel_1 = tslib_1.__decorate([\n    Provide('AnswerModel')\n], AnswerModel);\nexport { AnswerModel };\n//# sourceMappingURL=answer-model.js.map","/**\n * Copyright: ThoughtSpot Inc. 2012-2017\n * Author: Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n *\n * @fileoverview Utility to provide helpers specific to angular framework.\n */\nimport { ngRequire, Provide } from './decorators';\n/**\n * NOTE: $compile dependancy has to be retrieved only after the app is fully\n * built with all directives from the legacy system loaded. If not, $compile\n * will not be able to find and compile legacy directives used in templates\n * provided as arguments to functions on this file.\n * As of now, ngRequire seems to be the only way to get the dependancy. Getting\n * it through getDependancy from decorators does not seem to give us the desired\n * results.\n */\nfunction getCompileDependancy() {\n    return ngRequire('$compile');\n}\nfunction getCompiledElement(template, scope) {\n    let $compile = getCompileDependancy();\n    let $elem = $compile(template)(scope);\n    scope.$on('$destroy', () => {\n        $elem.remove();\n        // NOTE: This is extra cautious check to ensure marking object of GC.\n        $elem = null;\n    });\n    return $elem;\n}\nfunction getCompiledElementAsync($node, childScope) {\n    let $compile = getCompileDependancy();\n    $node.attr('blink-manual-compile', 'true');\n    childScope.$on('$destroy', () => {\n        $node.remove();\n    });\n    return new Promise((resolve) => {\n        childScope.onLinked = resolve;\n        $compile($node)(childScope);\n    });\n}\nexport { getCompiledElement, getCompiledElementAsync };\nProvide('angularUtil')({\n    getCompiledElement,\n    getCompiledElementAsync\n});\n//# sourceMappingURL=angular-util.js.map","import { Provide } from '../../../../../base/decorators';\nimport { flags } from '../../../../../base/flags';\nconst AXIS_CONTAINER_CLASS = '.bk-axis-label-container', AXIS_ORIENTATION_CLASS = {\n    VERTICAL: 'bk-vertical-axis',\n    HORIZONTAL: 'bk-horizontal-axis'\n};\nexport function bindEvents(scope, element) {\n    if (scope.dataVizComponentConfig.disableTransformations) {\n        return;\n    }\n    $(element).find(AXIS_CONTAINER_CLASS)\n        .on('click', '.bk-axis-label-control, .bk-sort-indicator', function (el) {\n        let axisId = el.delegateTarget.id;\n        scope.currentColumnController = scope.axisIdsToControllers[axisId];\n        if (this.className === 'bk-axis-label-control') {\n            scope.currentColumnController.setOnCloseCallback(() => {\n                scope.currentColumnController.onClose();\n            });\n            scope.currentColumnController.closeColumnControl = () => {\n                scope.currentColumnController.hide();\n            };\n            scope.currentColumnController.repositionMenu = () => {\n                scope.currentColumnController.reposition();\n            };\n            scope.currentColumnController.hide();\n            // trigger re-linking (as we are out of angular digestion)\n            scope.forceRender();\n            // defer rendering in next event loop, we are just doing DOM manipulation, so\n            // we do not need to go into angular loop\n            setTimeout(() => {\n                scope.currentColumnController.show(this);\n            }, 0);\n        }\n        else {\n            scope.currentColumnController.onSortClick();\n        }\n    });\n}\nexport function getAxisTemplate(axisId, chartModel, columns, isVertical, disableTransformations) {\n    let permission = chartModel.getContainingAnswerModel().getPermission();\n    let hasPermsToEdit = !!permission ? !permission.isMissingUnderlyingAccess() : false;\n    let canEdit = !disableTransformations && hasPermsToEdit;\n    let answerSheet = chartModel.getContainingAnswerModel().getCurrentAnswerSheet();\n    if (flags.getValue(flags.BLINK_FLAGS.enableChartConfigV2.name)) {\n        const combinedAxisName = chartModel.getAxisName(axisId) ||\n            chartModel.getAxisDefaultName(axisId);\n        let directionClass;\n        const sortColumn = columns.find((col) => col.isSortKey());\n        if (sortColumn) {\n            directionClass = getDirectionClass(sortColumn);\n        }\n        let showIconArrow = columns.some((col) => hasAvailableInteraction(col, canEdit, answerSheet)), showSortIndicator = showIconArrow && columns.some((col) => isSortedByColumn(col, canEdit)), tooltip = columns.map((col) => col.getTooltipInformationModel().getText()).join('\\n\\n');\n        return getAxisHTML(combinedAxisName, axisId, showIconArrow, showSortIndicator, directionClass, isVertical, tooltip);\n    }\n    return columns.reduce((acc, column) => {\n        let directionClass = getDirectionClass(column), showIconArrow = hasAvailableInteraction(column, canEdit, answerSheet), showSortIndicator = showIconArrow && isSortedByColumn(column, canEdit);\n        return acc + getAxisHTML(column.getName(), column.getId(), showIconArrow, showSortIndicator, directionClass, isVertical, column.getTooltipInformationModel().getText());\n    }, '');\n}\nexport function unbindAxisEvents(element) {\n    $(element).find(AXIS_CONTAINER_CLASS).off('click.axis');\n}\nfunction getAxisHTML(columnName, id, showIcon = true, showSortDirection = true, directionClass, isVertical, tooltip) {\n    let axisClass = isVertical ?\n        AXIS_ORIENTATION_CLASS.VERTICAL : AXIS_ORIENTATION_CLASS.HORIZONTAL;\n    let actionIcon = showIcon ? '<div class=\"bk-icon-arrow-down\"></div>' : '';\n    let sortIcon = showSortDirection ?\n        `<div class=\"bk-sort-indicator ${directionClass}\"></div> ` : '';\n    let cursorClass = showIcon ? 'bk-cursor' : 'bk-no-cursor';\n    return `<div id=\"${id}\" title=\"${tooltip}\" class=\"bk-axis-label-container\">\n                <div class=\"bk-axis-label ${cursorClass} ${axisClass}\">\n                    <div class=\"bk-axis-label-control\">\n                        <div class=\"bk-axis-label-title\">\n                            ${columnName}\n                        </div>\n                        ${actionIcon}\n                    </div>\n                    ${sortIcon}\n                </div>\n            </div>`;\n}\nfunction getDirectionClass(col) {\n    if (col.isSortKey()) {\n        if (col.isAscendingSort()) {\n            return 'up';\n        }\n        else {\n            return 'down';\n        }\n    }\n}\nfunction isSortedByColumn(vizColumn, isEditable) {\n    return vizColumn.isSortKey() && isEditable;\n}\nfunction hasAvailableInteraction(vizColumn, isEditable, answerSheet) {\n    return (vizColumn.isEffectivelyNumeric() && isEditable) ||\n        (isEditable || answerSheet.hasFilterForColumn(vizColumn)) ||\n        (vizColumn.supportsAggregationChange() && isEditable) ||\n        (vizColumn.supportsDateBucketizationChange() && isEditable);\n}\nProvide('axisRenderer')({\n    bindEvents,\n    getAxisTemplate\n});\n//# sourceMappingURL=highchart-axis-renderer.js.map","/**\n * Copyright: ThoughtSpot Inc. 2017\n * Francois Chabbey(francois.chabbey@thoughtspot.com)\n *\n * @fileoverview This file contains the different chart-renderers and shared functionnality\n *\n */\nimport { jsonConstants } from '@thoughtspot/json-constants/json-constants';\nimport * as Logger from '@thoughtspot/logger';\nimport _ from 'lodash';\nimport { getCompiledElement, getCompiledElementAsync } from '../../../../base/angular-util';\nimport { ngRequire, Provide } from '../../../../base/decorators';\nimport { flags } from '../../../../base/flags';\nimport GeoConfig from '../../../document-model/table-model/geo-config';\nimport * as chartTypeSpecificationService from './chart-type-specification-service';\nimport { unbindAxisEvents } from './highcharts/highchart-axis-renderer';\nimport { chartUIRenderHighchart } from './highcharts/highchart-chart-util';\nlet util = ngRequire('util');\nlet logger;\nexport { chartUIRemoveCurrentChart, chartUIRender, chartUIRenderGeoMap, getGeoChartData, closeContextMenu, handleSingularSelection, onChartRendered };\nProvide('ChartUIUtils')({\n    render: chartUIRender,\n    removeCurrentChart: chartUIRemoveCurrentChart,\n    closeContextMenu: closeContextMenu,\n    handleSingularSelection: handleSingularSelection\n});\nasync function chartUIRender(chartVizComponent, $chartContent, optSupportAnimation, maximized) {\n    // We compile the chart elements on a child scope of the chart scope.\n    // The motivation here is that we could have a single chart scope that\n    // will be reused across different chart renderings on various interactions\n    // like change chart type or config.\n    // The downside of original design to directly compile in the chart scope\n    // is that we depend on the container chart to be destroyed for all the\n    // scope based cleanups to happen.\n    // Now in the is model, every time this util is used to render a new chart it\n    // destroy the scope of the previous rendered chart.\n    chartVizComponent.createChartScope();\n    logger = logger || Logger.create('chart-ui-utils');\n    if (!chartVizComponent.getChartModel()) {\n        return;\n    }\n    optSupportAnimation = flags.getValue(flags.BLINK_FLAGS.chartAnimations.name)\n        && (optSupportAnimation);\n    let renderProfileMsg = Logger.ProfileMessages.CHART_VIZ_RENDER_PREAMBLE + ' \\'' +\n        chartVizComponent.getChartModel().getName() + '\\'';\n    logger.time(renderProfileMsg);\n    if (!chartVizComponent.isDataNotSupported() && !chartVizComponent.isChartHidden()) {\n        chartVizComponent.prevWidth = void 0;\n        chartVizComponent.prevHeight = void 0;\n        let chartProvider = chartTypeSpecificationService\n            .getChartProvider(chartVizComponent.getChartModel().getChartType());\n        chartUIRemoveCurrentChart(chartVizComponent);\n        let chartRenderer = getChartRendererForProvider(chartProvider);\n        await chartRenderer(chartVizComponent, $chartContent, optSupportAnimation);\n        if (maximized && chartVizComponent.chart &&\n            chartVizComponent.chart.supportsFullScreenMode()) {\n            util.launchIntoFullScreen($chartContent);\n        }\n    }\n    logger.timeEnd(renderProfileMsg);\n    onChartRendered(chartVizComponent, chartVizComponent.getChartModel());\n}\nfunction getChartRendererForProvider(chartProvider) {\n    switch (chartProvider) {\n        case chartTypeSpecificationService.chartProviders.HIGHCHART:\n            return chartUIRenderHighchart;\n        case chartTypeSpecificationService.chartProviders.GEO_MAP:\n            return chartUIRenderGeoMap;\n        case chartTypeSpecificationService.chartProviders.GRID_TABLE:\n        case chartTypeSpecificationService.chartProviders.PIVOT_TABLE:\n            return chartUIRenderDXComponent;\n        case chartTypeSpecificationService.chartProviders.NETWORK:\n            return chartUIRenderSankey;\n    }\n}\nfunction onChartRendered(scope, chartModel) {\n    // FIXME\n    scope.onRenderCompleteCallback(chartModel, true);\n    // TODO(Rifdhan): this additional call to chartUISecondaryRender causes two total calls to\n    // onRenderComplete() during the initial rendering of the chart in the expanded pinboard card,\n    // which in turn causes 2 network calls when it should really only be 1. However I can't remove\n    // this call easily or else it breaks chart config in the answer page (related to data labels\n    // and rounded numbers toggles). Ideally onRenderComplete() should only be called once per full\n    // render of any given chart viz.\n    //TODO(chab) we need to distinguish between case when the chart will update itself\n    // and when we need to reload a whole new chart\n    if (chartModel.isSecondaryRenderReady() &&\n        (!scope.isDataNotSupported() && !scope.isChartHidden())) {\n        scope.chartUISecondaryRender();\n    }\n}\nfunction chartUIRenderDXComponent(chartVizComponent, $chartContent) {\n    //renderDXComponent(chartVizComponent, $chartContent);\n}\nasync function chartUIRenderSankey(chartVizComponent, $chartContent) {\n    let { SankeyChartComponent } = await import('./networks/sankey-component');\n    chartVizComponent.chartCompilationScope.ctrl =\n        chartVizComponent.chart = new SankeyChartComponent(chartVizComponent, () => {\n            chartVizComponent.dataVizComponentConfig\n                .onRenderComplete(chartVizComponent.getChartModel());\n        }, chartVizComponent.dataVizComponentConfig.sageClient, chartVizComponent.chartDimensions.width, chartVizComponent.chartDimensions.height);\n    chartVizComponent.emitNewChart(chartVizComponent.chart);\n    //TODO(Ashish): Add all renderer types as components and use ng-switch in tpl.\n    let $sankey = getCompiledElement('<bk-sankey-chart ' +\n        'class=\"bk-sankey-chart-container\" ' +\n        'bk-ctrl=\"ctrl\">', chartVizComponent.chartCompilationScope);\n    $chartContent.innerHTML = '';\n    $chartContent.appendChild($sankey[0]);\n}\nasync function chartUIRenderGeoMap(chartVizComponent, $chartContent) {\n    let [{ GeoMapComponent }, { GeoUtils }] = await Promise.all([\n        import('./geomap/2d/blink-geo-map'),\n        import('./geomap/base/geo-utils')\n    ]);\n    let chartModel = chartVizComponent.dataVizComponentConfig.vizModel;\n    let geoMapConfig = {\n        chartVizComponent: chartVizComponent,\n        onRightClick: ($event) => onSeriesClick(chartVizComponent, $chartContent, $event)\n    };\n    chartVizComponent.chartCompilationScope.ctrl =\n        chartVizComponent.chart = new GeoMapComponent(geoMapConfig);\n    chartVizComponent.chart.setData(getGeoChartData(chartModel));\n    let $geoMap = $('<bk-geo-map bk-ctrl=\"ctrl\" class=\"bk-geo-map-container\"></bk-geo-map>');\n    $chartContent.innerHTML = '';\n    $chartContent.appendChild($geoMap[0]);\n    GeoUtils.updateRenderedGeoMapColorsInModel(chartModel, chartVizComponent.chartCompilationScope.ctrl);\n    chartVizComponent.emitNewChart(chartVizComponent.chart);\n    return getCompiledElementAsync($geoMap, chartVizComponent.chartCompilationScope)\n        .then(() => {\n        util.executeInNextEventLoop(() => {\n            chartVizComponent.reflow();\n            chartVizComponent.hideLoading();\n        });\n    });\n}\nfunction chartUIRemoveCurrentChart(scope) {\n    if (!scope.chart) {\n        return;\n    }\n    // SCAL-6200: Highcharts does not focus the chart when a click on a point\n    // happens. This can lead to a situtation where sage still retains focus,\n    // the user changes the query and the underlying chart goes away leaving\n    // the context menu hanging. The ideal fix will be to make sure sage bar\n    // loses focus when context menu is opened but that doesn't seem to work\n    // This is a temp fix.\n    closeContextMenu(scope);\n    $(scope.chart).unbind('selection');\n    unbindAxisEvents(scope.chart.renderTo);\n    if (_.isFunction(scope.chart.destroy)) {\n        scope.chart.destroy();\n    }\n    scope.chart = null;\n    // SHOULD WE DO THAT, WE'RE GOING TO EMIT A LOT OF THOSE EVENTS\n    scope.emitNewChart(scope.chart);\n}\nfunction getGeoChartData(chartModel) {\n    let geoConfig, xAxisColumns = chartModel.getXAxisColumns();\n    if (logger === void 0) {\n        logger = Logger.create('chart-ui-utils');\n    }\n    // TODO (sunny): get callosum to support composite POINT type\n    // and remove this conditional logic\n    switch (xAxisColumns.length) {\n        case 1:\n            geoConfig = xAxisColumns[0].getGeoConfig();\n            break;\n        case 2:\n            geoConfig = new GeoConfig({\n                type: jsonConstants.geoConfigType.POINT\n            });\n            break;\n        default:\n            logger.error('<=2 x-axis columns expected for geo charts');\n            return;\n    }\n    let series = chartModel.getSeries();\n    let yAxisColumns = chartModel.getYAxisColumns();\n    let multipleYAxes = yAxisColumns.length > 1 && !chartModel.isYAxisShared();\n    yAxisColumns.forEach((yAxisColumn, columnIndex) => {\n        let metricDefinition = yAxisColumn.getMetricsDefinition();\n        if (!metricDefinition) {\n            return;\n        }\n        let serie = multipleYAxes ? series[columnIndex] : series[0];\n        // TODO (sunny): handle shared y-axes with conflicting metrics\n        serie.data.forEach((dataRow) => {\n            let color = metricDefinition.getColorForValue(dataRow.y);\n            if (color !== null) {\n                dataRow.color = color;\n            }\n            else {\n                delete dataRow.color;\n            }\n        });\n    });\n    let geoObjects = chartModel.getGeoObjects();\n    return {\n        geoConfig: geoConfig,\n        series: series,\n        geoObjects: geoObjects,\n        labelFormatters: {\n            x: (xValue, seriesIndex) => {\n                return {\n                    name: chartModel.getXAxisColumns().map(col => col.getName()).join(', '),\n                    value: chartModel.getXAxisLabelAt(xValue, void 0, void 0)\n                };\n            },\n            y: (yValue, seriesIndex) => {\n                let yAxisColumns = chartModel.getYAxisColumns(), yAxisColumn;\n                yAxisColumn = yAxisColumns[seriesIndex] || yAxisColumns[0];\n                let formattedValue = null;\n                if (yAxisColumn.isEffectivelyNumeric()) {\n                    formattedValue = chartModel.getLabelForNumericColumn(yValue, yAxisColumn);\n                }\n                else {\n                    formattedValue = chartModel.getYAxisLabelForAttribute(yAxisColumn, yValue);\n                }\n                return {\n                    name: yAxisColumn.getName(),\n                    value: formattedValue\n                };\n            },\n            z: (zValue, seriesIndex) => {\n                let radialColumn = chartModel.getRadialColumn();\n                if (!radialColumn) {\n                    return null;\n                }\n                return {\n                    name: radialColumn.getName(),\n                    value: radialColumn.getDataFormatter()(zValue)\n                };\n            }\n        }\n    };\n}\nfunction closeContextMenu(scope) {\n    if (scope.contextMenuCtrl) {\n        scope.contextMenuCtrl.hide();\n    }\n}\nfunction showSubMenuItems(scope, subMenuId) {\n    if (scope.contextMenuCtrl) {\n        scope.contextMenuCtrl.showSubMenuItems(subMenuId);\n    }\n}\nfunction resetContextMenu(scope) {\n    if (scope.contextMenuCtrl) {\n        scope.contextMenuCtrl.reset();\n    }\n}\n/**\n * The implementation of the series filtered click for context menu.\n * @param scope\n * @param $chartContainer\n * @param evt\n */\nexport function onSeriesClick(scope, $chartContainer, evt) {\n    // Point close is used here as some of the call below can modify the values\n    // and break context menu down scenarios.\n    let pointClone = cloneHighchartsPoint(evt.point);\n    let selectedPoints = (!!scope.chart.getSelectedPoints ? scope.chart.getSelectedPoints() : [])\n        .map(cloneHighchartsPoint);\n    // let contextMenuInput = getInputForChartContextMenu(\n    //     scope.chartModel,\n    //     undefined,\n    //     pointClone,\n    //     selectedPoints,\n    //     () => closeContextMenu(scope),\n    //     (subMenuId: string) => showSubMenuItems(scope, subMenuId),\n    //     () => resetContextMenu(scope)\n    // );\n    let rect = $chartContainer.getBoundingClientRect();\n    let offset = {\n        top: rect.top + document.body.scrollTop,\n        left: rect.left + document.body.scrollLeft\n    };\n    let contextMenuConfig = {\n        clickedPosition: {\n            left: evt.chartX + offset.left,\n            top: evt.chartY + offset.top\n        },\n    };\n    selectChartPoint($(evt.target), pointClone, scope.getChartType());\n    console.log(contextMenuConfig);\n}\nfunction selectChartPoint($svgPoint, point, chartType) {\n    if (!point.select) {\n        return;\n    }\n    let selectionColor = util.lightenDarkenColor(point.series.color || '#777', -30);\n    switch (chartType) {\n        case chartTypeSpecificationService.chartTypes.LINE:\n        case chartTypeSpecificationService.chartTypes.AREA:\n        case chartTypeSpecificationService.chartTypes.PARETO:\n            point.select(true);\n            break;\n        case chartTypeSpecificationService.chartTypes.BUBBLE:\n            let d = $svgPoint.attr('d');\n            point.select(true);\n            $svgPoint.attr('stroke-width', 0).attr('d', d).attr('fill', selectionColor);\n            break;\n        default:\n            point.select(true);\n            $svgPoint.attr('stroke-width', '1').attr('fill', selectionColor);\n    }\n}\nfunction cloneHighchartsPoint(point) {\n    let pointClone = {\n        x: point.x,\n        y: point.y,\n        z: point.z,\n        categoryName: point.categoryName,\n        series: point.series\n    };\n    return pointClone;\n}\nfunction handleSingularSelection(chart, vizModel, serieName) {\n    let series = vizModel.getSeries();\n    if (!series) {\n        logger.error('No series found when trying to toggle', serieName);\n        return;\n    }\n    let shouldDoSingularSelection = !vizModel.isOnlySelectedSeries(serieName);\n    if (chartTypeSpecificationService.getChartProvider(vizModel.getChartType()) === 'highchart') {\n        chart.onSingularSerieSelection(serieName);\n        chart.redraw(true); // see below\n        // TODO(chab) not ideal,  we should do it the other way, but we cannot\n        // because if highcharts starts\n        // with only one serie, then we add another, at that point, this particular serie\n        // has no min/max values populated, good way would be to leverage chartModel\n        if (!vizModel.hasUserDefinedYAxisRange() && !vizModel.isZoomedIn()) {\n            chart.correctYAxisRange();\n        }\n    }\n    else {\n        series.forEach((s, i) => {\n            let visible = shouldDoSingularSelection ? s.name === serieName : true;\n            let redraw = i === series.length - 1;\n            // dont redraw until we render the last serie\n            chart.setSeriesVisibility(s, visible, redraw);\n        });\n        chart.redraw();\n    }\n}\n//# sourceMappingURL=chart-ui-utils.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015-2016\n * Author: Francois Chabbey (francois.chabbey@thoughtspot.com)\n *\n * @fileoverview Service that check if stack column labels are overlapping\n * with other labels\n *\n */\nimport _ from 'lodash';\nlet paddingBetweenLabels = 5;\nexport function postProcessHighchartDataLabels(chart) {\n    if (!chart.isDataLabelsEnabled()\n        && !chart.isStackLabelsEnabled()) {\n        return;\n    }\n    let visibleStackLabels = [];\n    chart.yAxis.forEach((yAxis) => {\n        let columns = yAxis.stacks.column || yAxis.stacks.area || {};\n        _.forIn(columns, (point) => {\n            if (!point.label || point.label.visibility === 'hidden') {\n                return;\n            }\n            let overlap = false;\n            visibleStackLabels.forEach((visibleStackLabel) => {\n                if (isLabelOnLabel(point.label, visibleStackLabel, paddingBetweenLabels)) {\n                    overlap = true;\n                }\n            });\n            if (overlap) {\n                point.label.hide();\n            }\n            else {\n                point.label.element.style.opacity = 1;\n                visibleStackLabels.push(point.label);\n            }\n        });\n    });\n    visibleStackLabels.forEach((visibleStackLabel) => {\n        chart.series.forEach((series) => {\n            if (series && series.points) {\n                series.points.forEach((point) => {\n                    if (!point.dataLabel) {\n                        return;\n                    }\n                    if (isLabelOnLabel(visibleStackLabel, point.dataLabel, paddingBetweenLabels)) {\n                        point.dataLabel.hide();\n                    }\n                });\n            }\n        });\n    });\n}\nfunction isLabelOnLabel(label1, label2, padding = 0) {\n    if (label1.visibility === 'hidden' || label2.visibility === 'hidden') {\n        return false;\n    }\n    let a = computeBBoxForHighchartLabel(label1), b = computeBBoxForHighchartLabel(label2);\n    return !(b.left > a.right + padding\n        || b.right < a.left - padding\n        || b.top > a.bottom + padding\n        || b.bottom < a.top - padding);\n}\nfunction computeBBoxForHighchartLabel(label) {\n    // we try to reuse what highchart has already computed\n    let parentX = label.parentGroup.translateX;\n    let parentY = label.parentGroup.translateY;\n    let labelX = label.alignAttr.x + (label.xCorr ? label.xCorr : 0);\n    let labelY = label.alignAttr.y + (label.yCorr ? label.yCorr : 0);\n    let width = label.width ? label.width : label.element.scrollWidth;\n    let height = label.height ? label.height : label.element.scrollHeight;\n    return {\n        top: parentY + labelY,\n        left: parentX + labelX,\n        right: parentX + labelX + width,\n        bottom: parentY + labelY + height,\n    };\n}\n//# sourceMappingURL=highcharts-label-processor-service.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015\n * Author: Shashank Singh (sunny@thoughtspot.com)\n *\n */\n'use strict';\nimport _ from 'lodash';\nimport { blinkConstants } from '@thoughtspot/blink-constants/blink-constants';\nimport { extendClass } from '@thoughtspot/typed';\nimport { browserInfo } from '../../../../../base/browser/browser';\nimport { BaseChart } from '../base-chart';\nimport { offGridline, onGridline } from '../chart-theme-service';\nimport { getScrollEnabledMinMaxConfig } from '../highcharts/blink-highchart-config-util';\nimport { Highcharts } from '../highcharts/highchart-init';\nimport { bindEvents } from './highchart-axis-renderer';\nimport { postProcessHighchartDataLabels } from './highcharts-label-processor-service';\nconst ZOOM_TYPE = 'xy';\n// TODO(chab) try to make type definition work, because now the thing is blindlessly open to\n// overriding\nexport class BlinkHighchart extends Highcharts.Chart {\n    constructor(config) {\n        super(config);\n        this._blinkSerieGetter = config._blinkSerieGetter;\n        extendClass(BlinkHighchart, BaseChart);\n        this.cachedXAxisHtml = config.cachedXAxisHtml;\n        this.cachedYAxisHtml = config.cachedYAxisHtml;\n        this.dataLabelsEnabledByDefault = config.dataLabelsEnabledByDefault;\n        this._init();\n        // precedently, we were storing default min/max axis ranges, but it's useless\n        // there is no good way to maintain a good max state when we return from zoom\n        // because we might have add/remove a serie, so when we remove zoom, we need\n        // to accomodate back, so we let highcharts manage that instead of trying to\n        // mix behaviour\n    }\n    isDataLabelsEnabled() {\n        return !!this.series.find(serie => !!_.get(serie, 'options.dataLabels.enabled'));\n    }\n    isStackLabelsEnabled() {\n        return !!_.get(this, 'options.yAxis.0.stackLabels.enabled');\n    }\n    getSeries() {\n        return this.series;\n    }\n    getXAxisExtremes() {\n        return this.xAxis.map('getExtremes');\n    }\n    getYAxisExtremes() {\n        return this.yAxis.map('getExtremes');\n    }\n    getAxisesExtremes() {\n        //we want to preserve only min & max. Other props can change between\n        //renders (SCAL-4711)\n        function mappingFunction(axisExtremes) {\n            return {\n                min: axisExtremes.min,\n                max: axisExtremes.max\n            };\n        }\n        let xAxisExtremes = this.getXAxisExtremes().map(mappingFunction);\n        let yAxisExtremes = this.getYAxisExtremes().map(mappingFunction);\n        return {\n            xAxisExtremes: xAxisExtremes,\n            yAxisExtremes: yAxisExtremes\n        };\n    }\n    getPlotSizeX() {\n        return this.plotSizeX;\n    }\n    getPlotSizeY() {\n        return this.plotSizeY;\n    }\n    getGroupPixelWidth() {\n        return this.xAxis\n            .map((axis) => axis.getGroupPixelWidth ? axis.getGroupPixelWidth() : 0)\n            .min();\n    }\n    resetPointer() {\n        this.pointer.reset();\n        this.pointer.init(this, this.options);\n    }\n    switchToZoomMode() {\n        this.options.chart.panning = false;\n        this.options.chart.zoomType = ZOOM_TYPE;\n    }\n    switchToPanMode(resetPointer) {\n        this.options.chart.panning = true;\n        this.options.chart.zoomType = '';\n        if (!resetPointer) {\n            return;\n        }\n        this.resetPointer();\n    }\n    isInPanMode() {\n        if (!this.options) {\n            return false;\n        }\n        return this.options.chart.panning;\n    }\n    setDataLabelVisibility(dataLabelVisible, columnId) {\n        this.series\n            .filter(serie => serie.userOptions.valueColumnIdentifier === columnId)\n            .forEach(serie => serie.update({\n            dataLabels: {\n                enabled: dataLabelVisible\n            }\n        }, false));\n    }\n    setStackLabelVisibility(stackLabelVisible) {\n        if (!this.options) {\n            return;\n        }\n        this._shouldShowDataLabels = stackLabelVisible;\n        let options = this.options;\n        this.yAxis.forEach((axis, index) => {\n            options.yAxis[index].stackLabels.enabled = !!stackLabelVisible;\n            axis.update({\n                stackLabels: {\n                    enabled: !!stackLabelVisible\n                }\n            }, false);\n        });\n    }\n    supportsDownload() {\n        return !!this.getSVG;\n    }\n    supportsFullScreenMode() {\n        return false;\n    }\n    async toBlob(overriddenOptions, callback, scalingFactor) {\n        overriddenOptions.exporting = {};\n        overriddenOptions.exporting.sourceWidth = 1920;\n        overriddenOptions.exporting.sourceHeight = 1080;\n        let svg = this.getSVG(overriddenOptions), width = parseInt(svg.match(/width=\"([0-9]+)\"/)[1], 10), height = parseInt(svg.match(/height=\"([0-9]+)\"/)[1], 10), canvas = document.createElement('canvas');\n        scalingFactor = scalingFactor || 5;\n        let dWidth = scalingFactor, dHeight = scalingFactor;\n        svg = svg.replace('<svg ', '<svg transform=\"scale(' + dWidth + ' ' + dHeight + ')\" ');\n        let scaledWidth = dWidth * width, scaledHeigth = dHeight * height;\n        svg = svg.replace('width=\"' + width + '\"', 'width=\"' + scaledWidth + '\"');\n        svg = svg.replace('height=\"' + height + '\"', 'height=\"' + scaledHeigth + '\"');\n        svg = svg.replace('viewBox=\"0 0 ' + width + ' ' + height + '\"', 'viewBox=\"0 0 ' + scaledWidth + ' ' + scaledHeigth + '\"');\n        canvas.setAttribute('width', width + '');\n        canvas.setAttribute('height', height + '');\n        //IE DOMParser has issues with svg xml\n        //https://code.google.com/p/canvg/issues/detail?id=189\n        if (browserInfo.isIE) {\n            svg = svg.replace(/xmlns=\\\"http:\\/\\/www\\.w3\\.org\\/2000\\/svg\\\"/gi, '');\n        }\n        let canvg = await import('canvg');\n        canvg = canvg.default || canvg;\n        canvg(canvas, svg);\n        canvas.toBlob(function (blob) {\n            $(canvas).remove();\n            callback(blob);\n        });\n    }\n    //We map dataLabel state differently depending on chart type.\n    //Non-stack charts:\n    //highcharts dataLabels are set with this._shouldShowDataLabels bool,\n    //Stack charts:\n    secondaryRender(scope) {\n        // note that in the past we were doing things like series.update(...) which\n        // will call .redraw N times under the hood ( for n series ),\n        // we just need to call redraw once\n        let chartModel = scope.getChartModel();\n        if (chartModel.getShowStackedLabels()) {\n            this.setStackLabelVisibility(true);\n        }\n        chartModel.getVisualizedColumns().forEach((col) => {\n            let columnId = col.getGuid();\n            let isDataLabelEnabled = _.isUndefined(chartModel.getShowDataLabels(columnId))\n                ? !!this.dataLabelsEnabledByDefault\n                : chartModel.getShowDataLabels(columnId);\n            this.setDataLabelVisibility(isDataLabelEnabled, columnId);\n        });\n        this.redraw(); // redraw will be called anyway if do series redraw\n        // we do not need to perform that in angular\n        setTimeout(() => {\n            bindEvents(scope, this.renderTo);\n        }, 0);\n    }\n    // TODO(Jasmeet): Change this to be axisId based.\n    setYAxisRange(axisIdx, range, alignTicks) {\n        this.updateExtremes(this.yAxis[axisIdx], range);\n        // In the case where the scale is set we avoid align ticks, otherwise\n        // highcharts tries to scale y axis with that in mind.\n        this.options.chart.alignTicks = alignTicks;\n    }\n    toggleXAxis(enabled) {\n        this.xAxis.forEach((axis, idx) => this.toggleAxis(axis, enabled));\n    }\n    toggleYAxis(enabled) {\n        this.yAxis.forEach((axis, idx) => this.toggleAxis(axis, enabled));\n    }\n    toggleColorAxis(enabled) {\n        this.colorAxis[0].update({ visible: enabled }, false);\n    }\n    // TODO(chab) when we de-select/select we should zoom IFF there is an user-defined zoom\n    // and this concept should be the same for geo-map, so we should have an uniform API for\n    // that behaviour in the future\n    setSeriesVisibility(serie, visible) {\n        let highchartSerie = this.get(serie.name);\n        if (!highchartSerie) {\n            this.addSerieToHighChart(serie.name, visible);\n        }\n        else {\n            highchartSerie.setVisible(!!visible, false);\n        }\n    }\n    onLegendClick(event, chart) {\n        let serie = event.target;\n        serie.userOptions.visible = !serie.userOptions.visible;\n        if (!chart.userOptions.isYAxisShared) {\n            return;\n        }\n    }\n    onSingularSerieSelection(serieName) {\n        let serie = this.get(serieName);\n        let isOnlySelectedSeries = this.series\n            .all(s => s === serie ? !!s.visible : !s.visible);\n        if (!isOnlySelectedSeries && !serie) {\n            this.addSerieToHighChart(serieName, true);\n        }\n        this.series.forEach((s) => {\n            // singular selection selects just the one clicked and de-selects others,\n            // de-selection selects all\n            let visible = isOnlySelectedSeries ? true : (s.name === serieName);\n            this.setSeriesVisibility(s, visible);\n        });\n    }\n    setExtremes(xAxisExtremes, yAxisExtremes) {\n        let xAxes = this.xAxis, yAxes = this.yAxis;\n        if (xAxisExtremes && xAxisExtremes.length === xAxes.length) {\n            // If any x-axis extreme doesn't overlap with what is saved, then abort.\n            xAxes.forEach((xAxis, index) => this.updateExtremes(xAxis, xAxisExtremes[index]));\n        }\n        if (yAxisExtremes) {\n            if (yAxes.length === 1 && yAxisExtremes.length > 1) {\n                //switched from multiple y-axes to single y-axis,\n                // the common axis get the end points of the combined\n                // extremes of all old axes\n                let maxMax = yAxisExtremes.max('max').max, minMin = yAxisExtremes.min('min').min;\n                let currentYExtreme = yAxes[0].getExtremes();\n                if (currentYExtreme.max < minMin || currentYExtreme.min > maxMax) {\n                    return;\n                }\n                this.updateExtremes(yAxes[0], { min: minMin, max: maxMax });\n            }\n            else if (yAxes.length > 1 && yAxisExtremes.length === 1) {\n                //switched from singe y-axis to multiple y-axes,\n                // all axes get the extremes of the common axis\n                yAxes.forEach(yAxis => this.updateExtremes(yAxis, yAxisExtremes[0]));\n            }\n            else {\n                yAxes.forEach((yAxis, index) => this.updateExtremes(yAxis, yAxisExtremes[index]));\n            }\n        }\n    }\n    updateLegendDisplay(isVertical, legendEnabled) {\n        if (this.userOptions.chart.type === 'heatmap'\n            || this.userOptions.chart.type === 'treemap') {\n            // false stands for turing off colorAxis re-render as we will do the same\n            // while legend update\n            this.toggleColorAxis(legendEnabled);\n            // false stands for turning off chart re-render, but it will re-render the legend.\n            // highcharts derieve legend for heatmap and treemap from colorAxis only, so rerendering\n            // legend is same as re-rendering colorAxis.\n            this.legend.update({ enabled: legendEnabled }, false);\n            return;\n        }\n        if (!legendEnabled) {\n            this.legend.update({ enabled: false }, false);\n            return;\n        }\n        if (!isVertical) {\n            this.legend.update({\n                enabled: legendEnabled,\n                verticalAlign: 'bottom',\n                layout: 'horizontal',\n                align: 'center',\n                y: blinkConstants.legendTopSpacing.HORIZONTAL\n            }, false);\n        }\n        else {\n            this.legend.update({\n                enabled: legendEnabled,\n                verticalAlign: 'middle',\n                layout: 'vertical',\n                align: 'right',\n                y: blinkConstants.legendTopSpacing.VERTICAL\n            }, false);\n        }\n    }\n    // NOTE(chab) when we have a shared axis, we need to update manually the range if\n    // we add/remove a serie\n    correctYAxisRange() {\n        // if y axis shared, we need to correct the  y axis\n        if (this.userOptions.isYAxisShared && this.series.length > 0) {\n            let visibleSeries = this.series.filter(s => !!s.visible);\n            if (visibleSeries.length === 0) {\n                // we do not need to update axis there, and this would actually messes our\n                // display as it's some special case\n                return;\n            }\n            let extent = visibleSeries.reduce((currentExtent, serie) => {\n                if (serie.dataMax > currentExtent.max) {\n                    currentExtent.max = serie.dataMax;\n                }\n                if (serie.dataMin < 0 && currentExtent.min) {\n                    currentExtent.min = serie.dataMin;\n                }\n                return currentExtent;\n            }, { max: 0, min: Number.MAX_VALUE });\n            if (extent.min > 0) {\n                extent.min = 0;\n            }\n            this.yAxis[0].setExtremes(extent.min, extent.max, true, true);\n        }\n    }\n    enableXAxisGridLines(enabled) {\n        this.xAxis.forEach(axis => this.updateAxisGridLine(axis, enabled), false);\n    }\n    enableYAxisGridLines(enabled) {\n        this.yAxis.forEach(axis => this.updateAxisGridLine(axis, enabled), false);\n    }\n    redraw(animate = false) {\n        super.redraw(animate);\n        postProcessHighchartDataLabels(this);\n    }\n    // in case when we are not updating chart, but charts needs to be redrawn,\n    // for eg, we have changes in chart model that are to be reflected in chart via callbacks.\n    lightRedraw(animate = false) {\n        this.update({});\n        this.redraw(animate);\n    }\n    toggleAxises(shouldShowXAxisLabels, shouldShowYAxisLabels) {\n        this.toggleYAxis(shouldShowYAxisLabels);\n        // turning off the yAxis label on the heatmap crashes highchart\n        // use http://jsfiddle.net/8kcLd7qz/19/ to investigate\n        if (this.userOptions.chart.type !== 'heatmap'\n            && this.userOptions.chart.type !== 'treemap') {\n            this.toggleXAxis(shouldShowXAxisLabels);\n        }\n    }\n    toggleAxisesTitle(enabled) {\n        this.xAxis.forEach((axis, index) => {\n            if (enabled) {\n                axis.update({ title: { text: this.cachedXAxisHtml[index] } }, false);\n            }\n            else {\n                axis.update({ title: { text: ' ' } }, false);\n            }\n        });\n        this.yAxis.forEach((axis, index) => {\n            if (enabled) {\n                axis.update({ title: { text: this.cachedYAxisHtml[index] } }, false);\n            }\n            else {\n                axis.update({ title: { text: ' ' } }, false);\n            }\n        });\n    }\n    updateSerieColor(serieName, color) {\n        let serie = this.get(serieName);\n        if (serie) {\n            let colors = {\n                color: color\n            };\n            // A Waterfall chart can have two different colors, one for positive\n            // column bar and one for negative column bar.\n            if (this.userOptions.chart.type === 'waterfall') {\n                colors.color = color;\n                colors.negativeColor = chroma(color).alpha(0.3).css();\n            }\n            this.updateSerie(serieName, colors);\n        }\n    }\n    updateXaxisScrollConfig(series, chartType, width, height) {\n        this.setExtremes([getScrollEnabledMinMaxConfig(series, chartType, width, height)], null);\n    }\n    updateSerie(serieName, changes) {\n        let serie = this.get(serieName);\n        if (serie) {\n            //TODO(chab) try to avoid those check by marking fake series\n            // in the legend upfront\n            serie.update(changes);\n        }\n    }\n    toggleAxis(axis, enabled) {\n        axis.update({\n            labels: {\n                enabled\n            }\n        }, false);\n    }\n    updateExtremes(axis, extremes) {\n        if (!extremes) {\n            return;\n        }\n        axis.options.startOnTick = false;\n        axis.options.endOnTick = false;\n        axis.update({\n            startOnTick: false,\n            endOnTick: false\n        }, false);\n        // there are 3 call sites\n        // ( via UI zoom + yAxis range, or for zooming just after rendering)\n        // in every case, if we pass undefined, that means that we want the initial size\n        // in y axis, this does not match highchart behaviour, so we store those values in a map\n        // and reuse them there\n        axis.setExtremes(extremes.min, extremes.max, false);\n    }\n    _init() {\n        this.pointer.init(this, this.options);\n    }\n    addSerieToHighChart(serieName, isVisible) {\n        //TODO(chab) pull that out\n        let vizModelSerie = this._blinkSerieGetter(serieName);\n        if (!vizModelSerie) {\n            this.logger.warn('ThoughtSpot is not able to display the series ', serieName);\n            return;\n        }\n        vizModelSerie.id = vizModelSerie.name;\n        vizModelSerie.visible = isVisible;\n        this.addSeries(vizModelSerie, true);\n    }\n    getGridLineConfig(enabled) {\n        return enabled ? onGridline : offGridline;\n    }\n    updateAxisGridLine(axis, enabled) {\n        axis.update(this.getGridLineConfig(enabled), false);\n    }\n}\n//# sourceMappingURL=blink-highchart.js.map","/**\n * Copyright: ThoughtSpot Inc. 2015\n * Author: Shashank Singh (sunny@thoughtspot.com),\n * Jasmeet Singh Jaggi (jasmeet@thoughtspot.com)\n * Francois Chabbey (francois.chabbey@thoughtspot.com)\n *\n * Class wrapping highcharts config.\n */\nimport { blinkConstants } from '@thoughtspot/blink-constants/blink-constants';\nimport * as dateUtil from '@thoughtspot/date-format-util/date-util';\nimport { create } from '@thoughtspot/logger';\nimport { assign } from '@thoughtspot/string-util/string-util';\nimport _ from 'lodash';\nimport { flags } from '../../../../../base/flags';\nimport { strings } from '../../../../../base/strings';\nimport { computeAxisInfinityPlaceholderValue, mapArrayToBooleanHash } from '../../../../../base/utils/util-ts';\nimport { PARETO_ID } from '../../../../../common/plugins/highcharts/pareto-chart';\nimport { isCustomCalendar } from '../../../../callosum/service/session-service';\nimport { ChartThemeService, offGridline, onGridline, responsiveLayoutDisabledSpacingBottom } from '../chart-theme-service';\nimport * as chartTypeSpecificationService from '../chart-type-specification-service';\nimport { TooltipLabelType } from '../chart-type-specification-service';\nimport { convertToAlpha } from '../chart-util-service';\nimport { findSeriesColumnFromContext, formatInfinityValue, getColors, getDataLabelFromColumn, getDateTickPositions, getFullLabelForXAxis, getFullLabelForYAxis, getHyperlinkLabelHTML, getScrollEnabledMinMaxConfig, updateSeriesWithMarkerSettings } from './blink-highchart-config-util';\nimport { getAxisTemplate } from './highchart-axis-renderer';\nimport { Highcharts } from './highchart-init';\nlet _logger = create('blink-highchart-config');\nlet TOOLTIP_TEMPLATE = '<div class=\"chart-tooltip-block\" style=\"z-index:9999;\">' +\n    '<span class=\"{1} chart-tooltip-key\" style=\"{2}\">{3}</span> ' +\n    '<span class=\"{4} chart-tooltip-value\" style=\"{5}\">{6}</span></div>';\nlet incompleteZoneDashStyle = 'ShortDot';\nlet constants = {\n    GROUPING_POINT_COUNT_THRESHOLD_HIGH: 1500,\n    formatting: {\n        MIN_AXIS_LABEL_GAP: 40,\n        MAX_AXIS_LABEL_HEIGHT: 60,\n        X_AXIS_TITLE_MIN_OFFSET: 40,\n        MIN_X_AXIS_TITLE_OFFSET: 15,\n        MIN_Y_AXIS_TITLE_OFFSET: 5,\n        // Note(sunny): legend size related constants need to be in sync with the CSS\n        RIGHT_MARGIN_FOR_LEGEND: 0,\n        BOTTOM_MARGIN_FOR_LEGEND: 0,\n        TICK_SIZE: 10,\n        PLOT_LINE_WIDTH: 1,\n        PLOT_LINE_Z_INDEX: 4,\n        INVERT_AXIS_MARGIN: 70,\n        LEGEND_WIDTH: 150\n    }\n};\nconst SHARED_AXIS_ID = 'shared-axis';\nconst RADIAL_COLUMN_TITLE_CLASS = 'radialColumnTitle';\nconst RADIAL_VALUE_CLASS = 'radialValue';\nfunction getLabelFontSize() {\n    return Highcharts.theme.xAxis.labels.style.fontSize.trim().replace(/px$|em$/, '');\n}\nfunction getLabelFont() {\n    return `${Highcharts.theme.xAxis.labels.style.fontSize}` +\n        ` ${Highcharts.theme.xAxis.labels.style.fontFamily}`;\n}\nfunction getDateTickPositioner(chartModel) {\n    // when the function is called, this is setted to the axis\n    return function () {\n        let axisWidth = this.width;\n        return getDateTickPositions(chartModel, axisWidth);\n    };\n}\nfunction getClassByLabelType(labelType, dataObject) {\n    switch (labelType) {\n        case TooltipLabelType.X_LABEL: return {\n            labelClass: 'xAxisTitle',\n            valueClass: 'pointX'\n        };\n        case TooltipLabelType.Y_LABEL: return {\n            labelClass: 'yAxisTitle',\n            valueClass: 'pointY'\n        };\n        case TooltipLabelType.CATEGORY_LABEL: return {\n            labelClass: 'categoryTitle',\n            valueClass: 'categoryName'\n        };\n        case TooltipLabelType.RADIAL_LABEL: return {\n            labelClass: RADIAL_COLUMN_TITLE_CLASS,\n            valueClass: RADIAL_VALUE_CLASS\n        };\n        case TooltipLabelType.SERIES_LABEL: return {\n            labelClass: 'seriesTitle',\n            valueClass: 'seriesValue',\n            valueStyle: !!dataObject.valueColor ? 'color:' + dataObject.valueColor : ''\n        };\n    }\n    return {\n        labelClass: '',\n        valueClass: ''\n    };\n}\nfunction tooltipComponent(tooltipData) {\n    let label = (!!tooltipData.label) ? tooltipData.label + ':' : '', labelStyle = tooltipData.titleStyle || '', labelClass = tooltipData.labelClass, value = tooltipData.value, valueStyle = tooltipData.valueStyle || '', valueClass = tooltipData.valueClass;\n    return assign(TOOLTIP_TEMPLATE, labelClass, labelStyle, label, valueClass, valueStyle, value);\n}\nfunction getLabelWithHtml(label, { link }) {\n    if (label && link) {\n        return getHyperlinkLabelHTML(label, link);\n    }\n    if (!label) {\n        return link;\n    }\n    return label;\n}\n//TODO(chab) type and clean the formatting part\nexport function getDataLabel(chartModel, configOpts, context) {\n    // context seems to be the point ?\n    let labelColumn, value;\n    labelColumn = chartModel.getCategoryColumnNotOnAxis();\n    if (!!labelColumn) {\n        return context.point.categoryName;\n    }\n    let dataLabelFormatter = configOpts.dataLabelFormatter;\n    if (_.isFunction(dataLabelFormatter)) {\n        return dataLabelFormatter.call(context);\n    }\n    labelColumn = findSeriesColumnFromContext(chartModel, context);\n    value = context.y;\n    return getDataLabelFromColumn(chartModel, labelColumn, value);\n}\nfunction formatYAxisLabel(value, axisId, tickPositions, tickInterval, yAxisColumn, chartModel, minValue, maxValue, showInfinity, showMinusInfinity, infinityPlaceholderValue) {\n    let colId = yAxisColumn.getDataRowIndex();\n    let captionAndLink = chartModel.captionValuesForYAxisAt(colId, value);\n    let fullLabel = getFullLabelForYAxis(value, axisId, tickPositions, tickInterval, yAxisColumn, chartModel, minValue, maxValue, showInfinity, showMinusInfinity, infinityPlaceholderValue, captionAndLink);\n    return getLabelWithHtml(fullLabel, { link: !!captionAndLink && captionAndLink.link });\n}\nclass BlinkHighchartConfig {\n    /**\n     * A builder class abstracting the Highcharts specific detail\n     * for configuring various charting options.\n     * All setter methods must return 'this' (builder pattern).\n     */\n    constructor(chartModel, containerDimensions, shouldShowXAxisLabels, shouldShowYAxisLabels, disableTransformations) {\n        this._chartModel = chartModel;\n        this._containerDimensions = containerDimensions;\n        this._shouldShowXAxisLabels = shouldShowXAxisLabels;\n        this._shouldShowYAxisLabels = shouldShowYAxisLabels;\n        this._configOptions = chartTypeSpecificationService.configOptions(chartModel.getChartType(), chartModel);\n        this._highchartConfig = {\n            chart: {\n                type: getHighchartChartType(chartModel.getChartType())\n            },\n            legend: {},\n            navigator: {},\n            plotOptions: {},\n            rangeSelector: {},\n            scrollbar: {},\n            series: {},\n            title: false,\n            tooltip: {},\n            xAxis: {},\n            yAxis: {},\n            shouldShowXAxisLabels: shouldShowXAxisLabels,\n            shouldShowYAxisLabels: shouldShowYAxisLabels,\n            dataLabelsEnabledByDefault: !!this._configOptions.dataLabelsEnabledByDefault,\n            shouldRenderInStackedLabelFormat: this.shouldRenderInStackedLabelFormat()\n        };\n        this._disableTransformations = disableTransformations;\n    }\n    //Detailed labels infer a stacked label format, which indicates how\n    //shouldShowDataLabels is mapped in highcharts\n    shouldRenderInStackedLabelFormat() {\n        return !!this._configOptions.allowedConfigurations.showDetailedLabels;\n    }\n    shouldShowRegressionLine() {\n        return this._chartModel.getShowRegressionLine()\n            && this._chartModel.canShowRegressionLine()\n            && this._chartModel.getSeries().length === 1;\n    }\n    setContainer($chartContainer) {\n        // TODO(Jasmeet): Verify how this will work with highchart server\n        // and can this be avoided in client\n        this._highchartConfig.chart.renderTo = $chartContainer;\n        return this;\n    }\n    setColors(useContextOptionRandomizationIdx) {\n        let defaultQueryData = this._chartModel.getDefaultQueryData();\n        let series = this._chartModel.getSeries();\n        let defaultTheme = ChartThemeService.getDefaultTheme();\n        let allColors = defaultTheme.allColors;\n        if (this._configOptions.useAlphaColors) {\n            allColors = convertToAlpha(allColors);\n        }\n        let legendSize = (!!this._configOptions.isMultiColorSeries)\n            ? !!defaultQueryData && defaultQueryData.length\n            : series.length;\n        if (!!this._configOptions.isMultiColorSeries) {\n            let legendColumns = this._chartModel.getLegendColumns();\n            if (legendColumns.length !== 0) {\n                _logger.error('Multi color series not supported in ' +\n                    'chart with legend');\n                this._highchartConfig.colors = allColors;\n                return this;\n            }\n            let paletteMap = this._chartModel.getMultiColorSeriesColors();\n            let knownPalettesForSeries = paletteMap[series[0].blinkSeriesId];\n            let reusablePalette = !!knownPalettesForSeries\n                ? knownPalettesForSeries[this._chartModel.getXAxisColumnsHash()]\n                : null;\n            if (!!reusablePalette) {\n                //When colors are less than items to be displayed, we add colors in circular order\n                //again. This is taken care of by highcharts but in order to change color of one\n                // attribute(with same color), other one also changes. Hence, this is to be done\n                // manually\n                if (reusablePalette.length < defaultQueryData.length) {\n                    const paletteLengthToFill = defaultQueryData.length - reusablePalette.length;\n                    let idx = 0;\n                    while (idx < paletteLengthToFill) {\n                        reusablePalette.push(reusablePalette[idx % (reusablePalette.length - 1)]);\n                        idx++;\n                    }\n                }\n                this._highchartConfig.colors = reusablePalette;\n                const specConfigOptions = chartTypeSpecificationService\n                    .configOptions(this._chartModel.chartType, void 0);\n                if (specConfigOptions.allowedConfigurations.configureColorForXAttrs) {\n                    this._chartModel.getDataModel()._xValueToRawValues\n                        .forEach((rawValue, idx) => {\n                        let label = this._chartModel.getXAxisLabelAt(idx, void 0, void 0);\n                        if (!!this._chartModel.getSeriesColor(label)) {\n                            this._highchartConfig.colors[idx]\n                                = this._chartModel.getSeriesColor(label);\n                        }\n                    });\n                }\n                else {\n                    this._chartModel.getLegendLabels()\n                        .forEach((legendLabel, idx) => {\n                        let label = legendLabel.label;\n                        if (!!this._chartModel.getSeriesColor(label)) {\n                            this._highchartConfig.colors[idx]\n                                = this._chartModel.getSeriesColor(label);\n                        }\n                    });\n                }\n                return this;\n            }\n        }\n        let seriesColorMap = this._chartModel.getSeriesColorsMap() || {};\n        let usedColors = [];\n        this._chartModel.getSeries().forEach((serie) => {\n            usedColors.push(seriesColorMap[serie.blinkSeriesId]);\n        });\n        let randomizationIdx = useContextOptionRandomizationIdx\n            ? this._chartModel.getContextOptions().colorIndex\n            : null;\n        let colors = getColors(allColors, legendSize, usedColors, randomizationIdx, this._configOptions.useRainbowColors);\n        this._highchartConfig.colors = colors;\n        return this;\n    }\n    disableZoom() {\n        this._highchartConfig.chart.zoomType = '';\n        this._highchartConfig.chart.panning = true;\n        return this;\n    }\n    /**\n     * Depending on the chart type, this will automatically configure the correct zoom type.\n     * @return {ChartConfig}\n     */\n    setZoomType() {\n        this._highchartConfig.chart.zoomType = 'xy';\n        return this;\n    }\n    configureXAxis(gridLineEnabled) {\n        let chartModel = this._chartModel;\n        let isXAxisVertical = chartTypeSpecificationService.isXAxisVertical(chartModel.chartType);\n        let xAxis = this._highchartConfig.xAxis;\n        xAxis.allowDecimals = true;\n        const xAxisModel = chartModel.getXAxes()[0];\n        this.configureGridline(xAxis, gridLineEnabled);\n        if (gridLineEnabled) {\n            xAxis.gridlineColor = onGridline.gridLineColor;\n            xAxis.gridLineWidth = onGridline.gridLineWidth;\n        }\n        let omitYear;\n        if (chartModel.isXAxisOrdinalBased()) {\n            xAxis.min = 0;\n            if (this._configOptions.cardinalityIndexStartsFromZero) {\n                //e.g spider web type chart has cardinal index starts from 0\n                xAxis.max = chartModel.getXAxisCardinality();\n            }\n            else {\n                // highcharts can end up creating ticks at N, where N\n                // is the cardinality of xAxis (SCAL-4695)\n                xAxis.max = chartModel.getXAxisCardinality() - 1;\n            }\n            // NOTE: This is set here because the handling of highcharts\n            // is different to determine tickOffsets when looking at values/category.\n            xAxis.minTickInterval = 1;\n            xAxis.minRange = 1;\n            xAxis.type = 'category';\n            //in non-measure cases the x-axis values are indices in the data-array.\n            // on zooming enough the highcharts tries to generate intermediate\n            // values between the given data points which doesn't make sense in this case\n            xAxis.allowDecimals = false;\n        }\n        else if (chartModel.isTimeSeries()) {\n            xAxis.type = 'datetime';\n            if (isCustomCalendar()) {\n                xAxis.tickPositioner = getDateTickPositioner(chartModel);\n            }\n        }\n        let xAxisColumn = chartModel.getXAxisColumns()[0];\n        if (chartModel.isXAxisMeasure()) {\n            if (!xAxisColumn.isDoubleColumn()) {\n                xAxis.allowDecimals = false;\n            }\n        }\n        if (!xAxis.title) {\n            xAxis.title = {};\n        }\n        const axisId = flags.getValue(flags.BLINK_FLAGS.enableChartConfigV2.name) ?\n            chartModel.getXAxes()[0].id : null;\n        xAxis.title.useHTML = true;\n        xAxis.title.text = getAxisTemplate(axisId, chartModel, chartModel.getXAxisColumns(), isXAxisVertical, this._disableTransformations);\n        if (!xAxis.labels) {\n            xAxis.labels = {};\n        }\n        xAxis.title.alwaysShownText = '';\n        if (chartModel.isTimeSeries() && !chartModel.isXAxisOrdinalBased()) {\n            let max = chartModel.getMaxXValue(xAxisColumn);\n            let min = chartModel.getMinXValue(xAxisColumn);\n            let format = 'yyyy';\n            //\n            let minYear = dateUtil.formatDate(min, format);\n            let maxYear = dateUtil.formatDate(max, format);\n            omitYear = minYear === maxYear;\n            if (omitYear) {\n                xAxis.title.alwaysShownText = `<i>${strings.FOR} ${minYear}</i>`;\n                xAxis.title.text += xAxis.title.alwaysShownText;\n                xAxis.title.style = {\n                    textAlign: 'center',\n                };\n            }\n            if (xAxisColumn.isDescendingSort()) {\n                xAxis.reversed = true;\n            }\n        }\n        if (!this._shouldShowXAxisLabels) {\n            xAxis.lineColor = 'transparent';\n            xAxis.tickWidth = 0;\n        }\n        let showInfinity = false, showMinusInfinity = false, minXValue = Number.NEGATIVE_INFINITY, maxXValue = Number.POSITIVE_INFINITY, infinityPlaceholderValue = Number.POSITIVE_INFINITY;\n        if (chartModel.isXAxisMeasure()) {\n            if (xAxisColumn.isDescendingSort()) {\n                xAxis.reversed = true;\n            }\n            showInfinity = chartModel.columnHasInfinityValues(xAxisColumn);\n            showMinusInfinity = chartModel.columnHasMinusInfinityValues(xAxisColumn);\n            if (showInfinity || showMinusInfinity) {\n                minXValue = chartModel.getMinXValue(xAxisColumn);\n                maxXValue = chartModel.getMaxXValue(xAxisColumn);\n                infinityPlaceholderValue =\n                    computeAxisInfinityPlaceholderValue(minXValue, maxXValue);\n                xAxis.endOnTick = true;\n                if (showInfinity) {\n                    xAxis.max = infinityPlaceholderValue;\n                }\n                if (showMinusInfinity) {\n                    xAxis.min = -1 * infinityPlaceholderValue;\n                }\n            }\n        }\n        xAxis.labels.enabled = this._shouldShowXAxisLabels;\n        xAxis.id = axisId || xAxisColumn.getId();\n        xAxis.labels.useHTML = chartModel.hasCaptionValuesForXAxis();\n        xAxis.labels.formatter = function () {\n            let captionAndLink = chartModel.captionValuesForXAxisAt(this.value);\n            let fullLabel = getFullLabelForXAxis(this.value, axisId, this.axis.tickPositions, this.axis.tickInterval, chartModel, minXValue, maxXValue, showInfinity, showMinusInfinity, infinityPlaceholderValue, omitYear, captionAndLink);\n            return getLabelWithHtml(fullLabel, { link: !!captionAndLink && captionAndLink.link });\n        };\n        if (this._configOptions.getMinTickIntervalForXAxis) {\n            xAxis.minTickInterval =\n                this._configOptions.getMinTickIntervalForXAxis(chartModel.getXAxisCardinality());\n        }\n        this._highchartConfig.cachedXAxisHtml = [xAxis.title.text];\n        return this;\n    }\n    setAfterSetExtremesCallback(callback) {\n        this._highchartConfig.xAxis.events = {\n            afterSetExtremes: callback\n        };\n        this._highchartConfig.yAxis.forEach((axis) => {\n            axis.events = {\n                afterSetExtremes: callback\n            };\n        });\n        return this;\n    }\n    configureColorAxis() {\n        let chartModel = this._chartModel;\n        let valueColumn = this._configOptions.colorAxisColumn;\n        if (!valueColumn) {\n            this._highchartConfig.colorAxis = this._highchartConfig.colorAxis || {};\n            this._highchartConfig.colorAxis.showInLegend = false;\n            return this;\n        }\n        else {\n            if (this._highchartConfig.colorAxis) {\n                delete this._highchartConfig.colorAxis.showInLegend;\n            }\n        }\n        let maxColor = chroma(ChartThemeService.getDefaultTheme().primaryColors[1]).hex();\n        let minColor = chroma(maxColor).brighten(2).css();\n        //TODO(chab) try to be agnostic of the chart type\n        if (this._chartModel.getChartType()\n            === chartTypeSpecificationService.chartTypes.TREEMAP) {\n            maxColor = chroma(ChartThemeService.getDefaultTheme().primaryColors[1]).hex();\n            minColor = chroma(ChartThemeService.getDefaultTheme().primaryColors[0]).hex();\n        }\n        let showInfinity = chartModel.columnHasInfinityValues(valueColumn), showMinusInfinity = chartModel.columnHasMinusInfinityValues(valueColumn), minValue = chartModel.getMinYValue(valueColumn), maxValue = chartModel.getMaxYValue(valueColumn);\n        let infinityPlaceholderValue = chartModel.getInfinityPlaceholder(valueColumn);\n        let colorAxis = {\n            stops: [\n                [0, minColor],\n                [1, maxColor]\n            ],\n            labels: {\n                formatter: function () {\n                    let value = this.value;\n                    let infinityLabel = formatInfinityValue(value, this.axis.tickInterval, showInfinity, showMinusInfinity, minValue, maxValue, infinityPlaceholderValue, false, //TODO(chab) grab legend setting\n                    true); // isOnColorAxis\n                    return infinityLabel ? infinityLabel : chartModel.getLabelForNumericColumn(value, valueColumn, [], {\n                        noShorten: false\n                    });\n                }\n            }\n        };\n        if (showInfinity) {\n            colorAxis.max = infinityPlaceholderValue;\n        }\n        else if (showMinusInfinity) {\n            colorAxis.min = -1 * infinityPlaceholderValue;\n        }\n        this._highchartConfig.colorAxis = colorAxis;\n        return this;\n    }\n    /**\n     * @return {ChartConfig}\n     */\n    configureYAxis(gridlineEnabled) {\n        let chartModel = this._chartModel;\n        this._highchartConfig.yAxis = [];\n        this._highchartConfig.cachedYAxisHtml = [];\n        if (flags.getValue(flags.BLINK_FLAGS.enableChartConfigV2.name)) {\n            const yAxes = chartModel.getYAxes();\n            _.forEach(yAxes, (yAxis) => {\n                const columnsInAxis = yAxis.properties.linkedColumns.map((colId) => chartModel.getColumn(colId));\n                let yAxisConfig = this.prepareYAxisConfig(columnsInAxis, yAxis.id, gridlineEnabled, yAxis.properties.isOpposite);\n                this._highchartConfig.yAxis.push(yAxisConfig);\n            });\n        }\n        else {\n            let showYAxisLinkingOption = this\n                ._configOptions.allowedConfigurations.showYAxisLinkingOption;\n            let isYAxisShared = showYAxisLinkingOption ? chartModel.isYAxisShared()\n                : !showYAxisLinkingOption;\n            if (!isYAxisShared) {\n                chartModel.getYAxisColumns().forEach((column) => {\n                    let yAxisConf = this.prepareYAxisConfig([column], chartModel.getAxisForColumn(column.getId()).id, gridlineEnabled);\n                    this._highchartConfig.yAxis.push(yAxisConf);\n                });\n                this._highchartConfig.isYAxisShared = true;\n            }\n            else {\n                let yAxisConf = this.prepareYAxisConfig(chartModel.getYAxisColumns(), chartModel.getAxisForColumn(chartModel.getYAxisColumns()[0].getId()).id, gridlineEnabled);\n                this._highchartConfig.yAxis.push(yAxisConf);\n                this._highchartConfig.isYAxisShared = false;\n            }\n        }\n        return this;\n    }\n    /**\n     * @return {ChartConfig}\n     */\n    configureAxisScroll() {\n        if (!this._chartModel.isResponsiveLayoutEnabled() &&\n            this._configOptions.allowedConfigurations.responsiveLayout) {\n            _.assign(this._highchartConfig.xAxis, this.getScrollBarEnabledConfig());\n            this._highchartConfig.chart.spacingBottom =\n                responsiveLayoutDisabledSpacingBottom;\n        }\n        return this;\n    }\n    configurePlotLines() {\n        let chartModel = this._chartModel;\n        let chartConfig = this._highchartConfig;\n        // assign color based on metric for each data point\n        // TODO (sunny): avoid similar colors in default series colors\n        let yAxisColumns = chartModel.getYAxisColumns();\n        let showYAxisLinkingOption = this\n            ._configOptions.allowedConfigurations.showYAxisLinkingOption;\n        let multipleYAxes = showYAxisLinkingOption ?\n            yAxisColumns.length > 1 && !chartModel.isYAxisShared() : false;\n        // configure plot lines for each metric\n        let yAxisConfigs = chartConfig.yAxis;\n        yAxisColumns.forEach((yAxisColumn, columnIndex) => {\n            let yAxisConfig = multipleYAxes ? yAxisConfigs[columnIndex] : yAxisConfigs[0];\n            // In case of invisible series the config is not generated.\n            if (!yAxisConfig) {\n                return;\n            }\n            if (!yAxisConfig.plotLines) {\n                yAxisConfig.plotLines = [];\n                yAxisConfig.plotBands = [];\n            }\n            let metricDefinition = yAxisColumn.getMetricsDefinition();\n            if (!metricDefinition) {\n                return;\n            }\n            let metrics = metricDefinition.getMetrics();\n            // make a copy before sorting\n            metrics = metrics.slice(0);\n            // sort metrics by in decreasing order of max values. in case of metrics that\n            // meet at the ends (e.g. [0.1-0.2),[0.2, 0.3) we the plot line of the lower\n            // range to hide the plot line of the higher range\n            metrics.sort(function (metricA, metricB) {\n                return metricB.getRange().max - metricA.getRange().max;\n            });\n            yAxisConfig.plotLines = metrics\n                .filter(metric => !metric.getPlotAsBand())\n                .flatMap(metric => {\n                let range = metric.getRange();\n                return [range.getMax(), range.getMin()]\n                    .map(threshold => ({\n                    color: metric.getColor(),\n                    width: constants.formatting.PLOT_LINE_WIDTH,\n                    value: threshold,\n                    zIndex: constants.formatting.PLOT_LINE_Z_INDEX\n                }));\n            });\n            yAxisConfig.plotBands = metrics\n                .filter(metric => metric.getPlotAsBand())\n                .map(function (metric) {\n                let range = metric.getRange();\n                return {\n                    color: metric.getColor(),\n                    from: range.getMin(),\n                    to: range.getMax()\n                };\n            });\n        });\n        return this;\n    }\n    configureSeries(onSeriesClick, numEnabledSeriesOnLoad, onLegendClick, disableHighlightOnHover) {\n        let chartModel = this._chartModel;\n        this.setYAxisInfoInSeries();\n        let series = chartModel.getSeries();\n        if (!series) {\n            return this;\n        }\n        let seriesPlotOptions = this._highchartConfig.plotOptions.series = {\n            stickyTracking: false\n        };\n        let getDefaultIncompleteColor = function (series) {\n            return Highcharts.Color(series.color).setOpacity(0.4).get();\n        };\n        let getDefaultIncompleteThreshold = dateUtil.getTimeBucketStart.bind(this, Date.now());\n        //(SCAL-4504): By default highcharts calculates the pointRange as the max of pointRange\n        // of each series in the data where the pointRange of one series is the distance between\n        // the two closest data points in that series (in units of the value on the axis).\n        // This means that if one of the series has missing data points in the middle,\n        // it will cause the combined pointRange to be too high.\n        // In case of timeseries this will mean that tick interval will have lower granularity than\n        // is necessary\n        if (chartModel.isTimeSeries() && !chartModel.isXAxisOrdinalBased()) {\n            let dateTimeColumn = chartModel.getXAxisColumns()[0], timeBucket = dateTimeColumn.getTimeBucket(), minTickInterval = dateUtil.getIntervalMillisForTimeBucket(timeBucket);\n            if (minTickInterval) {\n                series.forEach((s) => {\n                    s.pointRange = minTickInterval;\n                    s.colsize = minTickInterval;\n                });\n            }\n            // Configuring incomplete zones here\n            // http://api.highcharts.com/highcharts#plotOptions.series.zones\n            // We added a custom getColor in the zones as a plugin.\n            this._configOptions.incompleteZone = this._configOptions.incompleteZone || {};\n            if (!this._configOptions.incompleteZone.disabled) {\n                let incompleteThreshold = (!!this._configOptions.incompleteZone.getIncompleteThreshold) ?\n                    this._configOptions.incompleteZone.getIncompleteThreshold(timeBucket) :\n                    getDefaultIncompleteThreshold(timeBucket);\n                seriesPlotOptions.zones = [{\n                        value: incompleteThreshold\n                    }, {\n                        dashStyle: incompleteZoneDashStyle,\n                        getColor: this._configOptions.incompleteZone.getIncompleteColor\n                            || getDefaultIncompleteColor\n                    }];\n                series.forEach((serie) => {\n                    serie.data.forEach((serieDataPoint) => {\n                        if (serieDataPoint.x > incompleteThreshold) {\n                            serieDataPoint.ignoreInRegression = true;\n                        }\n                    });\n                });\n            }\n        }\n        else if (chartModel.isXAxisOrdinalBased()) {\n            // (SCAL-7059) highcharts has a bug (http://jsfiddle.net/shashank_singh/jzwd0v0r/)\n            // that causes it to space x-axis labels according to the max delta of point value\n            // in any series. this causes unnecessarily missing ticks (and labels) when the series\n            // data is sparse (that some series have points for few x-axis values).\n            // in the case of x-axis with ordinal values we know that the range of x-axis values\n            // is continuous integer with no gaps hence we can force pointRange to be 1\n            series.forEach(s => s.pointRange = 1);\n        }\n        chartTypeSpecificationService.seriesOverride(chartModel.getChartType(), chartModel);\n        let visibleSeriesIds = chartModel.getVisibleSeriesIds();\n        // TODO(chab) pull that out of blink-highchart-config in the chartModel\n        // mark series has visible\n        if (visibleSeriesIds && visibleSeriesIds.length) {\n            visibleSeriesIds = visibleSeriesIds.map(id => id.toLowerCase());\n            let visibleSeriesIdMap = mapArrayToBooleanHash(visibleSeriesIds);\n            let chartSeries = this._highchartConfig.series = chartModel.getSeries().slice();\n            chartSeries.forEach((chartSerie) => {\n                chartSerie.visible =\n                    _.has(visibleSeriesIdMap, chartSerie.blinkSeriesId.toLowerCase());\n            });\n        }\n        if (!this._highchartConfig.series || !this._highchartConfig.series.length) {\n            this._highchartConfig.series = chartModel.getSeries().slice(0, numEnabledSeriesOnLoad);\n            // we need to pass the communicate the colors to the vizModel,\n            // so we can put them in the legend\n            chartModel.getSeries().slice(numEnabledSeriesOnLoad, chartModel.getSeries().length)\n                .forEach(function (s, idx) {\n                s.color =\n                    this._highchartConfig.colors[idx % this._highchartConfig.colors.length];\n                s.visible = false;\n            }, this);\n            let displayYValuesWithLegendSeries = chartTypeSpecificationService.configOptions(chartModel.getChartType(), null).displayYValuesWithLegendSeries;\n            if (displayYValuesWithLegendSeries) {\n                let chartModelSeries = chartModel.getSeries();\n                let totalSeries = chartModelSeries.length;\n                if (totalSeries >= numEnabledSeriesOnLoad) {\n                    let yAxisColumnsAsSeries = chartModel.getYAxisColumns().slice(1);\n                    let totalYAxisAsSeries = yAxisColumnsAsSeries.length;\n                    let legendSeries = chartModelSeries.slice(0, totalSeries - totalYAxisAsSeries);\n                    let yAxisSeries = chartModelSeries.slice(totalSeries - totalYAxisAsSeries);\n                    this._highchartConfig.series = legendSeries.slice(0, numEnabledSeriesOnLoad);\n                    Array.prototype.push.apply(this._highchartConfig.series, yAxisSeries);\n                }\n            }\n        }\n        let seriesColors = chartModel.getSeriesColorsMap();\n        let self = this;\n        this._highchartConfig.series.forEach(function (serie, idx) {\n            if (_.has(seriesColors, serie.blinkSeriesId)) {\n                serie.color = seriesColors[serie.blinkSeriesId];\n            }\n            else {\n                //NOTE(chab) It would be nice to be able to know there what color we would use\n                // for a particular serie instead of grabbing it from highchart\n                // serie.color =\n                // self._highchartConfig.colors[idx % self._highchartConfig.colors.length];\n            }\n            delete serie.regression;\n            if (self.shouldShowRegressionLine()) {\n                serie.regression = true;\n                serie.regressionSettings = {\n                    visible: (serie.visible === void 0) || serie.visible //try to remove that\n                };\n            }\n            serie.id = serie.name;\n        });\n        seriesPlotOptions.dataLabels = {\n            enabled: true,\n            padding: 2,\n            borderRadius: 2,\n            style: {\n                fontSize: '12px'\n            },\n            formatter: function () {\n                return getDataLabel(chartModel, self._configOptions, this);\n            }\n        };\n        let groupingEnabled = true;\n        let chartConfig = this._highchartConfig;\n        // assign color based on metric for each data point\n        // TODO (sunny): avoid similar colors in default series colors\n        let yAxisColumns = chartModel.getYAxisColumns();\n        let yAxisGuidToColumn = yAxisColumns.reduce(function (yAxisGuidToColumn, column) {\n            yAxisGuidToColumn[column.getGuid()] = column;\n            return yAxisGuidToColumn;\n        }, {});\n        chartConfig.series.forEach(function (serie, seriesIndex) {\n            let yAxisColumn = null;\n            // if there is only one y-axis column, series is because of the legend\n            // each series' corresponding y-axis column is the first (and only)\n            // y-axis column. if there are more than one y-axis columns, each\n            // series corresponds to one y-axis column, in the order in which\n            // the y-axis columns appear in the list of y-axis columns.\n            if (yAxisColumns.length === 1) {\n                yAxisColumn = yAxisColumns[0];\n            }\n            else {\n                // TODO(Jasmeet): In highchart config we should add a notion of value column/s\n                // to identify yAxis, instead from series.\n                yAxisColumn = yAxisGuidToColumn[serie.blinkSeriesId] || yAxisColumns[0];\n            }\n            let metricDefinition = yAxisColumn.getMetricsDefinition();\n            if (!metricDefinition) {\n                return;\n            }\n            serie.data.forEach((dataRow) => {\n                let color = metricDefinition.getColorForValue(dataRow.y);\n                if (color !== null) {\n                    dataRow.color = color;\n                    // Note (sunny): highcharts does not respect point colors on grouped\n                    // data and does not seem to provide a way to specify colors on grouped\n                    // data. We have to force no data grouping when metrics are present,\n                    groupingEnabled = false;\n                }\n                else {\n                    delete dataRow.color;\n                }\n            });\n        });\n        //SCAL-4216: When there is data grouping, hovering over a data point can be missing\n        // columns not included in the chart (category, radial). We can't disable\n        // data grouping because:\n        //1. For line/column charts, looks very ugly (with columns overlapping each other e.g.)\n        //2. If we ever end up with a very high chart data page size performance can\n        //   degrade significantly\n        //However for scatter and bubble there is a greater need to be able\n        // to see all info about a point even if there is data grouping (think outliers).\n        // Luckily scatter and bubble UI degrade relatively slower\n        // without data grouping so we set higher thresholds for them\n        if (!!this._configOptions.highThresholdGrouping) {\n            let maxPointsInAnySeries = chartModel.getSeries().map(function (series) {\n                return (series.data && series.data.length) || 0;\n            }).max();\n            if (maxPointsInAnySeries <= constants.GROUPING_POINT_COUNT_THRESHOLD_HIGH) {\n                groupingEnabled = false;\n            }\n        }\n        seriesPlotOptions.connectNulls = true;\n        // TODO(vibhor): Figure out what this option really does. It seems to\n        // limit the number of data points that\n        // can be plotted using Chart API (not StockChart).\n        seriesPlotOptions.turboThreshold = 1000000;\n        seriesPlotOptions.events = {\n            contextmenu: function (evt) {\n                let clickSelf = this;\n                onSeriesClick(evt, clickSelf.color, clickSelf.name);\n            },\n            // this comes from our addition in bootstrap\n            legendItemClick: function (event) {\n                let chart = this.chart;\n                // update chart\n                chart.onLegendClick(event, chart);\n                // execute parent callback\n            },\n            // NOTE(chab) onLegendClick is called BEFORE the legend is updated,\n            // show/hide are called AFTER the legend is updated\n            show: function (event) {\n                let chart = this.chart, serie = chart._blinkSerieGetter(event.target.name);\n                onLegendClick(serie, true);\n            },\n            hide: function (event) {\n                let chart = this.chart, serie = chart._blinkSerieGetter(event.target.name);\n                onLegendClick(serie, false);\n            }\n        };\n        let isWaterfallChart = chartModel.getChartType()\n            === chartTypeSpecificationService.chartTypes.WATERFALL;\n        if (isWaterfallChart) {\n            // We want each waterfall to use one color picked from our current color sequences.\n            // For negative column bar, the color is lighter version of used color to\n            // connote a negative drop.\n            chartConfig.series.forEach(function (serie, serieIdx) {\n                let color = serie.color ?\n                    serie.color :\n                    chartConfig.colors[serieIdx >= chartConfig.colors.length ?\n                        serieIdx - chartConfig.colors.length : serieIdx];\n                serie.zoneAxis = 'y';\n                serie.color = color;\n                serie.negativeColor = chroma(color).alpha(0.3).css();\n            });\n        }\n        // hack to ensure color stability for PARETO\n        if (this._chartModel.chartType === chartTypeSpecificationService.chartTypes.PARETO) {\n            this._configOptions.highcharts.paretoColor =\n                this._chartModel.getSeriesColorsMap()[PARETO_ID];\n        }\n        if (disableHighlightOnHover) {\n            _.merge(this._highchartConfig.plotOptions.series, {\n                states: {\n                    hover: {\n                        enabled: false\n                    }\n                },\n                cursor: 'default'\n            });\n        }\n        return this;\n    }\n    configureDataLabels() {\n        let self = this;\n        self._chartModel.getSeries().forEach(serie => {\n            serie.dataLabels = {\n                enabled: this._chartModel.getChartType() !== 'LINE'\n            };\n        });\n        return self;\n    }\n    configureSerieGetter(getter) {\n        this._highchartConfig._blinkSerieGetter = getter;\n        return this;\n    }\n    configureChartTitle() {\n        let sampledMetrics = this._chartModel.getMetricsForSampledData();\n        if (!!sampledMetrics.totalRowsDisplayed && !!sampledMetrics.totalRowCount) {\n            let titleText = assign(strings.data_point_exceeded_message, sampledMetrics.totalRowsDisplayed, sampledMetrics.totalRowCount);\n            this._highchartConfig.title = {\n                text: titleText,\n                align: 'left',\n                x: 10,\n                y: -2,\n                style: {\n                    color: '#777E8B',\n                    fontFamily: 'Optimo-Plain',\n                    fontSize: '12px'\n                }\n            };\n        }\n        return this;\n    }\n    /**\n     * Chart specific Override\n     * @returns {ChartConfig}\n     */\n    configureOverrides() {\n        _.merge(this._highchartConfig, this._configOptions.highcharts);\n    }\n    configureDefaults() {\n        return this;\n    }\n    configureLegend() {\n        let handler = _.noop;\n        let legendColorHandler = _.noop;\n        this._highchartConfig.legend = {\n            enabled: true,\n            /*verticalAlign: verticalAlign, // TODO(chab) re-enable once we use native legend\n             layout: layout,\n             align: align,\n             margin: 0,\n             itemWidth: constants.formatting.LEGEND_WIDTH,\n             y: y,*/\n            dblClick: function (item) {\n                let serieName = item.name;\n                handler(serieName);\n            },\n            symbolClick: function (item, anchor) {\n                legendColorHandler(item, anchor);\n            }\n        };\n        return this;\n    }\n    configureWindowing() {\n        let navigator = this._highchartConfig.navigator;\n        navigator.enabled = false;\n        let scrollbar = this._highchartConfig.scrollbar;\n        scrollbar.enabled = false;\n        this._highchartConfig.rangeSelector = {\n            enabled: false,\n            inputEnabled: false\n        };\n        return this;\n    }\n    // NOTE: This component configures a tooltip html template.\n    configureGenericTooltip() {\n        let tooltip = this._highchartConfig.tooltip, self = this;\n        tooltip.valueDecimals = 2;\n        tooltip.shared = false;\n        tooltip.useHTML = true;\n        tooltip.crosshairs = false;\n        tooltip.hideDelay = blinkConstants.CHART_TOOLTIP_DELAY;\n        tooltip.backgroundColor = null;\n        tooltip.borderWidth = 0;\n        tooltip.snap = 10;\n        tooltip.followPointer = true;\n        tooltip.outside = false;\n        tooltip.delayForDisplay = 300;\n        tooltip.enable = !flags.getValue(flags.BLINK_FLAGS.disableChartTooltips.name);\n        let chartModel = self._chartModel;\n        tooltip.formatter = function () {\n            if (!tooltip.enable) {\n                return '<div style=\"display:none\"></div>';\n            }\n            let tooltipData = chartTypeSpecificationService.genericTooltipData(chartModel, this);\n            let finalLabel = _.reduce(tooltipData, (finalLabelString, dataObject) => {\n                let styledDataObject = Object.assign(dataObject, getClassByLabelType(dataObject.labelType, dataObject));\n                finalLabelString += tooltipComponent(styledDataObject);\n                return finalLabelString;\n            }, '');\n            return '<div class=\"custom-tooltip\" style=\"border:1px solid '\n                + this.series.color + ';\">'\n                + finalLabel + '</div>';\n        };\n        return this;\n    }\n    configureLineOptions() {\n        this._highchartConfig.plotOptions.line = {};\n        // a line chart with only one point will be invisible unless we show point markers\n        // (SCAL-3806)\n        let series = this._chartModel.getSeries();\n        if (!series) {\n            return this;\n        }\n        updateSeriesWithMarkerSettings(series);\n        return this;\n    }\n    configureExporting() {\n        //disable the default button, keep the exporting API working\n        this._highchartConfig.exporting = {\n            enabled: false\n        };\n        return this;\n    }\n    configureAnimation() {\n        if (!this._highchartConfig.plotOptions) {\n            this._highchartConfig.plotOptions = {};\n        }\n        if (!this._highchartConfig.plotOptions.series) {\n            this._highchartConfig.plotOptions.series = {};\n        }\n        this._highchartConfig.plotOptions.series.animation = {\n            duration: 1500\n        };\n        return this;\n    }\n    /**\n     * Returns the chart configuration options object built so far.\n     * @return {Object}\n     */\n    build(showAxisTitle) {\n        if (!showAxisTitle) {\n            _.castArray(this._highchartConfig.xAxis)\n                .forEach(axis => axis.title.text = ' ' + axis.title.alwaysShownText);\n            _.castArray(this._highchartConfig.yAxis).forEach(axis => axis.title.text = ' ');\n        }\n        this._highchartConfig.chart.reflow = false;\n        return this._highchartConfig;\n    }\n    setYAxisInfoInSeries() {\n        const chartModel = this._chartModel;\n        const yAxes = chartModel.getYAxes();\n        chartModel.getSeries().forEach((serie) => {\n            const columnId = serie.valueColumnIdentifier;\n            const axisForColumn = chartModel.getAxisForColumn(columnId);\n            if (axisForColumn) {\n                const axisId = axisForColumn.id;\n                const axisIndex = _.findIndex(yAxes, (axis) => axis.id === axisId);\n                serie.yAxis = axisIndex;\n            }\n        });\n    }\n    prepareYAxisConfig(axisColumns, axisId, gridlineEnabled, isOpposite) {\n        let chartModel = this._chartModel;\n        let isYAxisVertical = !chartTypeSpecificationService.isXAxisVertical(chartModel.chartType);\n        let shouldShowYAxisLabels = this._shouldShowYAxisLabels;\n        // TODO(chab) see if we can hide the non-visible series without redrawing\n        // the whole thing\n        let maxY = _.max(axisColumns.map(col => chartModel.getMaxYValue(col))), minY = _.min(axisColumns.map(col => chartModel.getMinYValue(col)));\n        let showInfinity = axisColumns.some((col) => {\n            return chartModel.columnHasInfinityValues(col);\n        }), showMinusInfinity = axisColumns.some((col) => {\n            return chartModel.columnHasMinusInfinityValues(col);\n        }), infinityPlaceholderValue = computeAxisInfinityPlaceholderValue(minY, maxY);\n        let yAxisConfig = {\n            id: axisId,\n            title: {\n                text: getAxisTemplate(axisId, chartModel, axisColumns, isYAxisVertical, this._disableTransformations),\n                useHTML: true,\n                style: {\n                    textOverflow: 'ellipsis'\n                }\n            },\n            labels: {\n                enabled: shouldShowYAxisLabels,\n                formatter: function () {\n                    if (axisColumns.length > 1 || axisColumns[0].isEffectivelyNumeric()) {\n                        return formatYAxisLabel(this.value, axisId, this.axis.tickPositions, this.axis.tickInterval, axisColumns[0], chartModel, minY, maxY, showInfinity, showMinusInfinity, infinityPlaceholderValue);\n                    }\n                    return chartModel.getYAxisLabelForAttribute(axisColumns[0], this.value);\n                }\n            },\n            stackLabels: {\n                enabled: false,\n                allowOverlap: true,\n                useHTML: true,\n                style: {\n                    textOverflow: 'ellipsis'\n                },\n                formatter: function () {\n                    let xAxis = this.axis.chart.xAxis[0];\n                    let currentX = this.x;\n                    if (xAxis.min > currentX || xAxis.max < currentX) {\n                        return '';\n                    }\n                    let formattedYAxisLabel = formatYAxisLabel(this.total, axisId, this.axis.tickPositions, this.axis.tickInterval, axisColumns[0], chartModel, minY, maxY, showInfinity, showMinusInfinity, infinityPlaceholderValue);\n                    if (axisColumns.length > 1) {\n                        return '<div style=\"padding:2px\">' + formattedYAxisLabel + '</div>';\n                    }\n                    if (axisColumns[0].isEffectivelyNumeric()\n                        && !chartModel.isYAxisOrdinalBased()) {\n                        return formattedYAxisLabel;\n                    }\n                    return chartModel.getYAxisLabelForAttribute(axisColumns[0], this.value);\n                }\n            },\n            opposite: !_.isUndefined(isOpposite) ? isOpposite\n                : this._highchartConfig.yAxis.length,\n            allowDecimals: axisColumns.some((col) => {\n                return col.isDoubleColumn();\n            }),\n            name: chartModel.getAxisName(axisId) || chartModel.getAxisDefaultName(axisId)\n        };\n        if (showInfinity) {\n            yAxisConfig.max = infinityPlaceholderValue;\n        }\n        if (showMinusInfinity) {\n            yAxisConfig.min = -1 * infinityPlaceholderValue;\n        }\n        this.configureGridline(yAxisConfig, gridlineEnabled);\n        if (chartModel.hasCaptionValuesForYAxis(axisColumns[0].getDataRowIndex())) {\n            yAxisConfig.labels.useHTML = true;\n        }\n        this._highchartConfig.cachedYAxisHtml.push(yAxisConfig.title.text);\n        if (axisColumns.length === 1) {\n            this.setSingleColumnedYAxisProperties(yAxisConfig, axisColumns[0], chartModel, showMinusInfinity, minY);\n        }\n        return yAxisConfig;\n    }\n    setSingleColumnedYAxisProperties(axisConfig, column, chartModel, showMinusInfinity, minYValue) {\n        //Set tick interval based on column type\n        if ((column.isDateColumn()\n            || column.isTimeColumn())\n            && !chartModel.isYAxisOrdinalBased()) {\n            let timeBucket = column.getTimeBucket();\n            axisConfig.tickInterval = dateUtil.getIntervalMillisForTimeBucket(timeBucket);\n        }\n        else if (column.isEffectivelyNonNumeric()) {\n            axisConfig.tickInterval = 1;\n        }\n        if (!showMinusInfinity && minYValue > 0) {\n            if (column.isDateFamilyColumn()) {\n                // let highcharts manage y axis if it's a date column\n                axisConfig.min = undefined;\n            }\n            else {\n                axisConfig.min = 0;\n            }\n        }\n        axisConfig.stackLabels.style = {\n            fontFamily: 'Optimo-Plain',\n            fontSize: '12px',\n            fontWeight: 'normal',\n        };\n    }\n    configureGridline(axis, hasGridLine) {\n        let gridlineConfig = hasGridLine ? onGridline : offGridline;\n        axis.gridLineWidth = gridlineConfig.gridLineWidth;\n        axis.gridLineColor = gridlineConfig.gridLineColor;\n        axis.gridLineDashStyle = gridlineConfig.gridLineDashStyle;\n    }\n    getScrollBarEnabledConfig() {\n        let chartModel = this._chartModel;\n        let scrollbarConfig = {\n            scrollbar: {\n                enabled: true\n            }\n        };\n        return _.assign(scrollbarConfig, getScrollEnabledMinMaxConfig(chartModel.getSeries(), chartModel.getChartType(), this._containerDimensions.width, this._containerDimensions.height));\n    }\n}\nfunction getHighchartChartType(chartType) {\n    let highchartsType = chartTypeSpecificationService.getHighchartsType(chartType);\n    return highchartsType.toLowerCase();\n}\nexport { BlinkHighchartConfig };\n//# sourceMappingURL=blink-highchart-config.js.map","/**\n * Copyright Thoughtspot Inc. 2016\n * Author: Mahesh Sharma (mahesh@thoughtspot.com)\n * Francois Chabbey (francois.chabbey@thoughtspot.com)\n *\n * @fileOverview Those are utilities relative to highchart\n *\n *\n */\nimport * as Logger from '@thoughtspot/logger';\nimport _ from 'lodash';\nimport { flags } from '../../../../../base/flags';\nimport { ChartThemeService } from '../chart-theme-service';\nimport * as chartTypeSpecificationService from '../chart-type-specification-service';\nimport { onSeriesClick } from '../chart-ui-utils';\nimport { isChartBigEnoughToShowXAxisTicksLabels, isChartBigEnoughToShowYAxisTicksLabels } from '../chart-util-service';\nimport { BlinkHighchart } from './blink-highchart';\nimport { BlinkHighchartConfig } from './blink-highchart-config';\nlet logger = Logger.create('highchart-rendering');\nexport function chartUIRenderHighchart(chartVizComponent, $chartContent, optSupportAnimation) {\n    ChartThemeService.useDefaultTheme();\n    let bbox = $chartContent.getBoundingClientRect();\n    let containerDimensions = {\n        height: bbox.height,\n        width: bbox.width\n    };\n    let chartModel = chartVizComponent.chartModel;\n    //TODO(chab) there are a bit of confusion between axis labels and ticks, we need to rename\n    let shouldAlwaysShowAxisLabels = chartModel.params.answerModel.shouldAlwaysShowAxisLabels();\n    let shouldShowXAxisTickLabels = isChartBigEnoughToShowXAxisTicksLabels(containerDimensions);\n    let shouldShowYAxisTickLabels = isChartBigEnoughToShowYAxisTicksLabels(containerDimensions, chartModel);\n    let canShowAxisTitle = true;\n    let chartConfigOptions = chartTypeSpecificationService.configOptions(chartModel.getChartType(), chartModel);\n    let shouldBringSelectedSeriesToFront = true;\n    let useContextOptionRandomizationIdx = chartModel.isPinboardViz();\n    let chartConfig = new BlinkHighchartConfig(chartModel, containerDimensions, shouldShowXAxisTickLabels, shouldShowYAxisTickLabels, false);\n    let xGridlineEnabled, yGridlineEnabled;\n    ({ xGridlineEnabled, yGridlineEnabled } = chartModel.getGridLinesConfig());\n    chartConfig\n        .configureDefaults()\n        .setColors(useContextOptionRandomizationIdx)\n        .setContainer($chartContent)\n        .disableZoom()\n        .configureXAxis(xGridlineEnabled)\n        .configureYAxis(yGridlineEnabled)\n        .configureColorAxis()\n        .configureSeries(getHighchartOnSeriesClickHandler(shouldBringSelectedSeriesToFront, chartVizComponent, $chartContent), flags.getValue(flags.BLINK_FLAGS.maxChartLegendCardinality.name), _.noop, false)\n        .configureDataLabels()\n        .configurePlotLines()\n        .configureChartTitle()\n        .configureWindowing()\n        .configureLineOptions()\n        .configureGenericTooltip()\n        .configureExporting()\n        .configureLegend()\n        .configureSerieGetter((serieName) => chartModel.getSerie(serieName))\n        .configureAxisScroll();\n    if (!!optSupportAnimation) {\n        chartConfig.configureAnimation();\n    }\n    chartConfig.configureOverrides();\n    logger.log('chart config', chartConfig);\n    // Get configuration based on screen\n    const chartAxisDetails = {\n        x: chartConfig._highchartConfig.xAxis,\n        y: chartConfig._highchartConfig.yAxis\n    };\n    try {\n        chartVizComponent.chart = new BlinkHighchart(chartConfig.build(canShowAxisTitle));\n        //configureColumnControls(chartVizComponent, chartConfig._highchartConfig.yAxis);\n        // TODO(chab) for zoom and customized y-axis-range,\n        // it will not work if we set directly min/max in config (try to explore more\n        // so we can directly configure it)\n        // let needRedraw = chartVizComponent.updateChartZoom(chartVizComponent.chart) ||\n        //     chartVizComponent.updateChartYAxisRange(chartVizComponent.chart);\n        // if (needRedraw) {\n        //     chartVizComponent.chart.lightRedraw();\n        // }\n        // TODO(chab) explore if we can have a view state for the series, instead of\n        // putting state directly in the chartModel\n        // updateRenderedHighChartColorsInModel(\n        //     chartModel,\n        //     chartConfigOptions,\n        //     chartVizComponent.chart);\n    }\n    catch (err) {\n        console.log(err);\n    }\n    //chartVizComponent.emitNewChart(chartVizComponent.chart);\n}\nfunction getHighchartOnSeriesClickHandler(shouldBringSelectedSeriesToFront, scope, $container) {\n    let func = ($event) => onSeriesClick(scope, $container, $event);\n    return (evt, color, name) => {\n        // If this is a click on point of a serie in a multi-series chart,\n        // bring that serie to front. this can be immediatly executed as\n        // it does not plays any role in angular\n        if (shouldBringSelectedSeriesToFront) {\n            bringSelectedSeriesToFront(evt.point);\n        }\n        func(evt);\n    };\n}\nfunction bringSelectedSeriesToFront(point) {\n    if (point && point.series && point.series.group) {\n        point.series.group.toFront();\n    }\n}\n//# sourceMappingURL=highchart-chart-util.js.map","import { css } from 'lit-element';\nimport { getCSSValue } from '../util';\n// language=CSS\nexport const getStyles = () => css `\n:host {\n    display: flex;\n    align-items: stretch;\n}\n\n.chart-container {\n    width: 100%;\n    flex: 1 1 0;\n    align-items: center;\n    justify-content: center;\n    display: flex;\n}\n\n.bk-chart {\n    position: relative;\n    width: 100%;\n    height: 100%;\n}\n\n.highcharts-tooltip {\n    font-size: 12px;\n    font-size: 0.8571428571rem;\n    line-height: 1.3333333333;\n    font-weight: 600;\n    pointer-events: none;\n    z-index: 9999;\n}\n\n.highcharts-tooltip .chart-tooltip-block {\n    padding-top: 8px;\n    word-wrap: break-word;\n}\n\n.highcharts-tooltip .custom-tooltip {\n    padding: 8px 12px 16px 12px;\n    background-color: ${getCSSValue('tooltipBackgroundColor', '#323946')};\n    opacity: 0.9;\n    border-radius: 4px;\n}\n\n.highcharts-tooltip > span {\n    box-shadow: 0 2px 8px -4px rgba(0, 0, 0, 0.6);\n}\n\n.highcharts-tooltip span {\n    min-width: 10.000em;\n    max-width: 26.667em;\n    overflow: auto;\n    white-space: normal !important;\n}\n\n.highcharts-tooltip span > .chart-tooltip-block:last-of-type {\n    margin-bottom: 0px;\n}\n\n.highcharts-tooltip .chart-tooltip-key {\n    font-size: 0.917em;\n    color: #ffffff;\n    display: block;\n}\n\n.highcharts-tooltip .chart-tooltip-value {\n    font-weight: 700;\n    font-size: 1em;\n    color: #ffffff;\n    display: block;\n}\n`;\n//# sourceMappingURL=chart-styles.js.map","import * as tslib_1 from \"tslib\";\n/**\n * Import LitElement base class, html helper function,\n * and TypeScript decorators\n **/\nimport { customElement, html, LitElement, property } from 'lit-element';\nimport { changeLocale, initializeDateAndNumberUtils } from '../../../base/localization-service';\nimport { CustomStylingService } from '../../../modules/custom-styling/custom-styling-service';\nimport { AnswerModel } from '../../../modules/document-model/answer-model/answer-model';\nimport { chartUIRenderHighchart } from '../../../modules/viz-layout/viz/chart/highcharts/highchart-chart-util';\nimport { getStyles } from './chart-styles';\n/**\n * Use the customElement decorator to define your class as\n * a custom element. Registers <my-element> as an HTML tag.\n */\nlet TSChart = class TSChart extends LitElement {\n    constructor(...args) {\n        super();\n        /**\n         * Create an observed property. Triggers update on change.\n         */\n        this.chartType = '';\n        CustomStylingService.initialize(true);\n        window.thoughtspotSDK.onLoading(() => {\n            this.$chartContainer.hidden = true;\n            this.$loader.hidden = false;\n        });\n    }\n    static get styles() {\n        return getStyles();\n    }\n    attributeChangedCallback(name, oldval, newval) {\n        console.log('attribute change: ', name, newval);\n        super.attributeChangedCallback(name, oldval, newval);\n        if (this.chartModel && name === 'chart-type') {\n            this.renderChart();\n        }\n    }\n    async firstUpdated(props) {\n        this.$chartContainer = this.shadowRoot.getElementById('chart');\n        this.$loader = this.shadowRoot.getElementById('loader');\n        window.thoughtspotSDK.addCallbacks((answerJson) => {\n            this.$chartContainer.hidden = false;\n            this.$loader.hidden = true;\n            let answerModel = new AnswerModel(answerJson);\n            this.chartModel = answerModel.getChartVisualization();\n            this.renderChart();\n        });\n        await changeLocale('en-US');\n        await initializeDateAndNumberUtils();\n    }\n    renderChart() {\n        if (this.chartType && this.chartType !== this.chartModel.getChartType()) {\n            this.chartModel.setChartType(this.chartType);\n        }\n        let config = {\n            chartModel: this.chartModel\n        };\n        chartUIRenderHighchart(config, this.$chartContainer, true);\n    }\n    /**\n     * Implement `render` to define a template for your element.\n     */\n    render() {\n        /**\n         * Use JavaScript expressions to include property values in\n         * the element template.\n         */\n        // language=HTML\n        return html `<div class=\"chart-container\">\n            <div class=\"bk-chart\" id=\"chart\"></div>\n            <img id=\"loader\" src=\"https://cdn.jsdelivr.net/gh/ashubham/files/loader.gif\" hidden>\n            <context-menu></context-menu>\n        </div>`;\n    }\n};\ntslib_1.__decorate([\n    property({ attribute: 'chart-type' })\n], TSChart.prototype, \"chartType\", void 0);\nTSChart = tslib_1.__decorate([\n    customElement('ts-chart')\n], TSChart);\nexport { TSChart };\n//# sourceMappingURL=chart.js.map"],"names":["Logger.create","generateUUID","jsonConstants","formatTimeOfDay","dateFormatPresets","tslib_1.__decorate","util","create","blinkConstants","chartUtilService.setChartAxisInClientState","chartUtilService.ChartAxis","chartUtilService.getChartAxisFromClientState","chartUtilService.getColumnIdToDisambiguatedName","columnEffectiveIdGetter","chartTypeSpecificationService.validateAxisConfig","chartTypeSpecificationService.chartTypes","logger","chartDataProcessor.getDataModel","chartDataProcessor.computeMetaDataInformation","formatDateByFormatConfig","Logger.LogLevel","formatDate","getValueFormattedByConfig","protoRoot.sage","protoRoot.bach","Logger","_logger","getFormattedDateFromEpochInSeconds","filterUtil.isCompoundFilter","UserAction","ProfileMessages","pinboardAnswerSheetUtil.getVisualizationAnswerModels","pinboardAnswerSheetUtil\n                            .resolveReferencedGenericVisualization","pinboardAnswerSheetUtil.getPinboardLayout","sageTypes","Logger.ProfileMessages","chartTypeSpecificationService\n            .getChartProvider","chartTypeSpecificationService.chartProviders","chartTypeSpecificationService.getChartProvider","extendClass","assign","chartTypeSpecificationService.configOptions","chartTypeSpecificationService\n                    .configOptions","isXAxisVertical","chartTypeSpecificationService.isXAxisVertical","dateUtil.formatDate","dateUtil.getTimeBucketStart","dateUtil.getIntervalMillisForTimeBucket","chartTypeSpecificationService.seriesOverride","chartTypeSpecificationService.genericTooltipData","chartTypeSpecificationService.getHighchartsType"],"mappings":"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"}